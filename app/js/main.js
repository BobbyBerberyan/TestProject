define("lodash-mixins",[],function(){function e(e){var i=/\s*\[[\w\-]+\]/gi,a=/\]\s*\,\s*\[/g,r={msrp:1,epa_2014:2,epa_2015:2,epa_2016:2,features_options_interactive:3,msrp_total:8};return{stripDisclaimer:function(e){return e.replace(/\[.*?\]/g,"")},makeStrong:function(e){return"<strong>"+e+"</strong>"},mod:function(e,t){return e-t*Math.floor(e/t)},crush:function(t){return e.flatten(e.map(t,e.values))},randomRange:function(e,t){return Math.round(Math.random()*(t-e)+e)},formatNumber:function(e){return String(e).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},toDollarAmount:function(e){return parseInt(String(e).replace(/\$|\,|\.00/gi,""),10)||0},formatPrice:function(e,t){var i=this.toDollarAmount(e);return 0!==i||t?this.toDollar(i):""},toNumber:function(e){var t=String(e).replace(/^\D+|\,/g,""),i=parseInt(t,10);return!isNaN(i)&&i||0},toDollar:function(e){return"$"+this.formatNumber(e)},parseDisclaimer:function(e){return this.linkDisclaimer(e)},linkDisclaimer:function(t){if(!session||"string"!=typeof t)return t;var n=t.search(i)>-1;return n&&(t=t.replace(a,"]<sup>,</sup> ["),e.each(t.match(i),function(e){var i=$.trim(e);i=i.substring(i.indexOf("[")+1,i.length-1).toLowerCase(),index=r[i]||SIT.appDisclaimers&&SIT.appDisclaimers[i]||parseInt(window.SIT.$disclaimers.find('[data-disclaimer="'+i+'"]').attr("id"),10)||0,"number"==typeof index&&index>=0&&(t=t.replace(e,'<sup data-code="'+i+'" data-disclaimer="'+i+'">'+index+"</sup>"))})),t},validateZipCode:function(e){return/^[0-9]{5}$/.test(e)},cloneDeep:function(e,i){if("object"!=typeof e)return e;if(t.isString(e))return e.splice();if(t.isDate(e))return new Date(e.getTime());if(t.isFunction(e.clone))return e.clone();var a=t.isArray(e)?e.slice():t.extend({},e);if(!t.isUndefined(i)&&i>0)for(var r in a)a[r]=t.deepClone(a[r],i-1);return a}}}var t=window.TCOM._;t.mixin(e(t))}),define("app/sit/i18n",[],function(){return{en:{title:"New Toyota Inventory Search",subTitle:"Finding a Toyota in stock near you has never been easier.",noResults:"We were unable to locate your exact vehicle match. Here are some other recommendations.",totalMSRPDisclaimer:"Total MSRP (includes optional equipment plus delivery [DPH]) Delivery [DPH]",filters:{cab:"Cabs",bed:"Beds",drive:"Drive",engine:"Engines",transmission:"Transmissions",exteriorcolor:"Exterior",interiorcolor:"Interior",packages:"Packages &amp; Options",accessory:"Accessories",accessories:"Accessories",price:"Price"},modelyear:"ModelYear",series:"Series",model:"Model",totalmsrp:"Total MSRP",engine:"Engine",transmission:"Transmission",color:"Color",exterior:"Exterior",interior:"Interior",availableoptions:"Available Options",detailFeatures:{exteriorFeatures:"Exterior",interiorFeatures:"Interior",safetyFeatures:"Safety/Convenience"},contactdealer:"Contact a Dealer",calculatepayment:"Calculate Payment",applyforfinancing:"Apply for Financing",printdetails:"Print Details",emaildetails:"Email Details",errors:{apologies:"Our Apologies",technicalDifficulties:"We are having some technical difficulties.",meantime:"Please try again later. In the meantime, you can:",findDealer:"Find a dealer near you.",dealerLocator:"Dealer Locator",findDeals:"Find great deals in your area.",localSpecials:"Local Specials",returnToHome:"Return to the homepage.",home:"Home",oneMore:"One More Thing...",allWeNeed:"Okay, now all we need is your ZIP Code.",itWillHelp:"It will help us find the Toyota you're looking",itWillHelpBr:"for in your area."},nationalMSRP:"1. Manufacturer's Suggested Retail Price, excludes the Delivery, Processing and Handling Fee of $825 for Cars, $885 for Small/Light Trucks (Sienna, RAV4, Highlander Gas, Highlander HV, 4Runner, Tacoma and Venza), $1100 for Large Trucks (Tundra), and $925 for Large SUVs (Sequoia and Land Cruiser). (Historically, vehicle manufacturers and distributors have charged a separate fee for processing, handling and delivering vehicles to dealerships. Toyota's charge for these services is called the \"Delivery, Processing and Handling Fee\" and is based on the value of the processing, handling and delivery services Toyota provides as well as Toyota's overall pricing structure. Toyota may make a profit on the Delivery, Processing and Handling Fee.) Excludes taxes, license, title and available or regionally required equipment. The Delivery, Processing and Handling Fee in AL, AR, FL, GA, LA, MS, NC, OK, SC and TX will be higher. Actual dealer price will vary.",gstMSRP:"1. Manufacturer's Suggested Retail Price, excludes the Delivery, Processing and Handling Fee of $890 for Cars, $950 for Small/Medium Trucks (Sienna, RAV4, Highlander Gas, Highlander HV, 4Runner, Tacoma and Venza), $1,195 for Large Trucks (Tundra), and $1,095 for Large SUVs (Land Cruiser and Sequoia). (Historically, vehicle manufacturers and distributors have charged a separate fee for processing, handling and delivering vehicles to dealerships. Toyota's charge for these services is called the \"Delivery, Processing and Handling Fee\" and is based on the value of the processing, handling and delivery services Toyota provides as well as Toyota's overall pricing structure. Toyota may make a profit on the Delivery, Processing and Handling Fee.) Excludes taxes, license, title and available or regionally required equipment. The MSRP price is only valid in TX, OK, AR, MS, and OK. Actual dealer price will vary."},es:{title:"Búsqueda en el inventario de nuevos Toyota",subTitle:"Encontrar un Toyota disponible en tu área nunca ha sido más fácil.",noResults:"No pudimos ubicar el vehículo exacto de tu búsqueda. Aquí tienes algunas otras recomendaciones.",totalMSRPDisclaimer:"Total MSRP (includes optional equipment plus delivery [DPH]) Delivery [DPH]",filters:{cab:"Cabs",bed:"Beds",drive:"Drives",engine:"Engines",transmission:"Transmissions",exteriorcolor:"Exterior",interiorcolor:"Interior",packages:"Packages &amp; Options",accessory:"Accessories",accessories:"Accessories",price:"Price"},modelyear:"ModelYear",series:"Series",model:"Model",totalmsrp:"Total MSRP",engine:"Engine",transmission:"Transmission",color:"Color",exterior:"Exterior",interior:"Interior",availableoptions:"Available Options",detailFeatures:{exteriorFeatures:"Exterior",interiorFeatures:"Interior",safetyFeatures:"Safety/Convenience"},contactdealer:"Contact a Dealer",calculatepayment:"Calculate Payment",applyforfinancing:"Apply for Financing",printdetails:"Print Details",emaildetails:"Email Details",errors:{apologies:"Our Apologies",technicalDifficulties:"We are having some technical difficulties.",meantime:"Please try again later. In the meantime, you can:",findDealer:"Find a dealer near you.",dealerLocator:"Dealer Locator",findDeals:"Find great deals in your area.",localSpecials:"Local Specials",returnToHome:"Return to the homepage.",home:"Home",oneMore:"Algo más...",allWeNeed:"Solo necesitamos tu código postal.",itWillHelp:"Nos ayudará a encontrar el Toyota que buscas",itWillHelpBr:"en tu área."},nationalMSRP:"1. Manufacturer's Suggested Retail Price, excludes the Delivery, Processing and Handling Fee of $825 for Cars, $885 for Small/Light Trucks (Sienna, RAV4, Highlander Gas, Highlander HV, 4Runner, Tacoma and Venza), $1100 for Large Trucks (Tundra), and $925 for Large SUVs (Sequoia and Land Cruiser). (Historically, vehicle manufacturers and distributors have charged a separate fee for processing, handling and delivering vehicles to dealerships. Toyota's charge for these services is called the \"Delivery, Processing and Handling Fee\" and is based on the value of the processing, handling and delivery services Toyota provides as well as Toyota's overall pricing structure. Toyota may make a profit on the Delivery, Processing and Handling Fee.) Excludes taxes, license, title and available or regionally required equipment. The Delivery, Processing and Handling Fee in AL, AR, FL, GA, LA, MS, NC, OK, SC and TX will be higher. Actual dealer price will vary.",gstMSRP:"1. Manufacturer's Suggested Retail Price, excludes the Delivery, Processing and Handling Fee of $890 for Cars, $950 for Small/Medium Trucks (Sienna, RAV4, Highlander Gas, Highlander HV, 4Runner, Tacoma and Venza), $1,195 for Large Trucks (Tundra), and $1,095 for Large SUVs (Land Cruiser and Sequoia). (Historically, vehicle manufacturers and distributors have charged a separate fee for processing, handling and delivering vehicles to dealerships. Toyota's charge for these services is called the \"Delivery, Processing and Handling Fee\" and is based on the value of the processing, handling and delivery services Toyota provides as well as Toyota's overall pricing structure. Toyota may make a profit on the Delivery, Processing and Handling Fee.) Excludes taxes, license, title and available or regionally required equipment. The MSRP price is only valid in TX, OK, AR, MS, and OK. Actual dealer price will vary."}}}),define("app/sit/config",[],function(){return{categories:[{id:"cars-minivan",name:"Cars & Minivan"},{id:"trucks",name:"Trucks"},{id:"crossovers-suvs",name:"Crossovers & SUVs"},{id:"hybrids-evs",name:"Hybrids & EVs"}],resultsPerPage:25,c3iSeriesMapping:{priusv:"prius",priusc:"prius",avalonhybrid:"avalon",camryhybrid:"camry",highlanderhybrid:"highlander",rav4ev:"rav4",fjcruiser:"fj"},regionRedirectURLs:{HI:"http://www.toyota-hawaii.com/Distributor/Toyota/Dealerships/Default.aspx",PR:"http://www.toyotapr.com/concesionarios",GST:"http://www.gulfstates.buyatoyota.com/",SET:"http://southeast.buyatoyota.com",SET_ESP:"http://www.comprauntoyota.com"},general_service_error:"Sorry, something went wrong. Please try again later.",results_empty_error:"No vehicles match your criteria. Try adjusting your filters and searching again.",series_fail_error:"Unable to retrieve inventory from server, please refresh the page to try again.",geo_location_errors:["An unknown error has occurred retrieving your current location. Please manually input your zip code in the form field provided.","You have denied touch.toyota.com access to your current location. Please manually input your zip code in the form field provided.","Your position is currently unavailable. Please manually input your zip code in the form field provided.","Your position is currently unavailable. [timeout] Please manually input your zip code in the form field provided."],general_geo_error:"Geolocation is not available at this time. Please try again later.",browser_geo_error:"Geolocation is not supported by this browser.",out_of_stock_errror:"Sorry, this trim is currently out of stock.",get_cache_info:"/configws/cacheInfo?brand=toyota&format=json&lang=en",get_disclaimers_path:"/configws/static/modelTrims?brand=toyota&format=json&lang=en&region=10011&zzc={{cacheStamp}}&modelCode={{trimId}}&return=all",get_series_path:"/ToyotaSite/rest/lscs/getDocument?templatePath=templatedata/TComVehiclesData/Series/data/CombinedSeries.xml",get_zip_code_path:"/toyotaSite/dealerLocator/locateDealers.do?",verify_zip_code_path:"/ToyotaSite/rest/dealerLocator/getRegionCode?brandId=1&zipCode=",get_inventory_base_path:"/ToyotaSite/rest/inventory/getInventory?facet=true&",get_inventory_detail_base_path:"/ToyotaSite/rest/inventory/getInventoryDetail",results_per_page:5}}),define("sit",["lodash-mixins","app/sit/i18n","app/sit/config"],function(e,t,i){var a=window.TCOM,r=a.Util,n=a.Analytics,s=a.Geolocation,o=r.i18n,l=a.$,c={$:a.$,_:a._,Backbone:window.Backbone,i18n:o,lang:o.lang,Util:r,Events:window.Backbone.Events,Geolocation:s,Analytics:n,$document:l(document),$window:l(window),$html:l("html"),$body:l("body"),cookie:a.cookie,$app:l("#sit-wrapper"),$disclaimers:l("#tcom-disclaimers .tcom-disclaimers-list"),mq:r.mq,getCurrentQuery:function(){return this.mq("phone")&&"phone"||this.mq("smallTablet")&&"smallTablet"||this.mq("tablet")&&"tablet"||this.mq("desktop")&&"desktop"||!1},blanksrc:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",Config:i};return c.$dom={document:c.$document,window:c.$window,html:c.$html,body:c.$body,app:c.$app},c.strings=t[c.lang],c.firstLoad=!0,c.touchsite="tmob"===a.Util.site,c.CurrentQuery=c.getCurrentQuery(),c.ltie9=c.$dom.html.hasClass("lt-ie9")?!0:!1,c.ltie9&&(c.mq=function(e){return"desktop"===e?!0:!1}),Modernizr.iconFonts=!0,c}),define("app/api/controller",["sit"],function(e){var t=e.$,i=(e._,e.RIT,e.Backbone,e.Events,function(e){var i,a,r=shaParam||t.cookie("efcsha");return debuggerOn&&console.log("controller options:",e),i=new efcinvapi.InventorySearchController,""!==r&&null!==r&&(t.cookie("efcsha",r),i.setSha(r)),i.setServerURL(e.server),i.setBrand(e.brand),i.setRegion(e.region),i.setLanguage(e.language),i.setYearCode(e.year),i.setSeriesCode(e.series),e.dealers&&e.dealers.length&&i.setDealerCodes(e.dealers),a=i.createSession(),{instance:i,promise:a}});return i}),define("app/api/api-wrapper",["sit","app/api/controller"],function(e,t){var i,a=e.$,r=e._,n=(e.RIT,e.Backbone),s=e.Events,o=null,l={},c={},d={},u={},p={},_="grade",h=[],f={},g="",m={},v={},y=null,b=2e4,w=0,C=null,k=null,S=null,I=0,T=1,P=0,x="asc",A=null,D=null,M=null,E=[],R=e.Config,z=null,j=null,O=null,$=null,L=null,N=null,V=null,F=null,B=null,Y=null,q=null,H=n.Model.extend({initialize:function(){var e=this,t=e.isTouchSite();debuggerOn&&console.log("api-wrapper:constructor"),i=e,I=t?R.results_per_page:R.resultsPerPage,s.on("SIT:pick:picked",i.onPickPicked),s.on("SIT:pick:removed",i.onPickRemoved)},initAPI:function(e){var t=this,i=0;t.options=e,s.on("SIT:region:ready",function(e){y&&clearTimeout(y),e&&e.regionCode&&50!==e.regionCode&&(y=setTimeout(function(){isAPIReady===!1&&s.trigger("SIT:api:fail")},b))}),isAPIError===!0&&s.trigger("SIT:api:fail"),isAPIReady===!0?t.onAPIReady():i=setInterval(function(){isAPIReady===!0&&(clearInterval(i),t.onAPIReady()),isAPIError===!0&&(clearInterval(i),s.trigger("SIT:api:fail"))},100)},onAPIReady:function(){s.trigger("SIT:api:ready")},getSessionLanguage:function(){return"EN"},initializeSession:r.debounce(function(e){i._initializeSession(e)},100),_initializeSession:function(e){var t=i;sitInstance=new efcsolrapi.SolrInventorySearchController,j=e,sitInstance.setServerURL(t.getSessionURL()),sitInstance.setBrand("TOY"),sitInstance.setRegion(e.region),sitInstance.setLanguage(t.getSessionLanguage()),sitInstance.setCompressQuery(!0),sitInstance.setYearCode(e.year),sitInstance.setSeriesCode(e.series),e.dealers.length>0&&sitInstance.setDealerCodes(e.dealers),sitInstance.createSession().done(t.onConfigSessionComplete).fail(t.onConfigSessionFailure)},initializeThreedSession:function(){var e=this,t=new efcthreedapi.ThreedController;q=new a.Deferred,t.setServerURL(e.getSessionURL()),t.setBrand("TOY"),t.setRegion(j.region),t.setLanguage(e.getSessionLanguage()),t.setYearCode(j.year),t.setSeriesCode(j.series),t.createSession().done(e.onThreedSessionComplete).fail(e.onThreedSessionFailure)},getSessionURL:function(){return window.location.protocol+"//"+window.location.hostname+":"+window.location.port+"/search-inventory-ws/config"},onConfigSessionComplete:function(e){console.debug("onConfigSessionComplete:",e);var t=i;debuggerOn&&(console.timeEnd("SESSION TIME"),a("#debuggerBox").html(a("#debuggerBox").html()+"<br> API Content Init: "+((new Date).valueOf()-w))),window.session=e,o=e,o.apiWrapper=i,i.options.apiWrapper=i,a.when(t.runPostInitAssociations()).then(function(){console.debug("session and init complete."),v=o.getContent(),s.trigger("SIT:api:session:ready")},i.onPromiseFail)},onConfigSessionFailure:function(){console.error("onConfigSessionFailure:",arguments);s.trigger("SIT:error:oos")},onThreedSessionComplete:function(e){console.debug("onThreedSessionComplete:",e);window.threedsession=e,debuggerOn&&(a("#debuggerBox").show(),threedInitEnd=(new Date).valueOf()-threedInit,console.log("Threed Session Ready: "+threedInitEnd),a("#debuggerBox").html(a("#debuggerBox").html()+"<br> Threed Session Ready: "+threedInitEnd)),s.trigger("SIT:threed:session:ready"),q.resolve()},onThreedSessionFailure:function(){console.error("onThreedSessionFailure:",arguments)},runPostInitAssociations:function(){var e=this,t=new a.Deferred;return e.removeRangeConstraint(),a.when(o.getTrueFeaturesByType("series"),o.getTrueFeaturesByType("year")).then(function(n,s){console.log("arguments:",arguments),console.debug("series:",n," year:",s),p=r.first(n)||{},u=r.first(s),p.code=j.series,e.isAVirtualSeries(p.code)&&(p.title=e.getVirtualSeriesTitleByCode(p.code)),l={},_="tacoma"===p.code?"cab":"corolla"===p.code||"sienna"===p.code?"grade-subgrade":"grade",a.when(e.getGradeData()).then(function(){console.debug("grades ready:",h),t.resolve()},i.onPromiseFail)},i.onPromiseFail),t},getGradeData:function(){var e=this,t=new a.Deferred;return"grade-subgrade"===_?o.getFeaturesByTypeByModelObject(["model"]).then(function(i){h=r.chain(i.model).uniq(function(e){return e.grade.code+"-"+e.subgrade.code}).map(function(t){var a=t.grade,r=t.subgrade,n=e.getSubgradeCount(i.model,t.grade,t.subgrade);return{code:a.code+""+r.code,prefix:"GRDSUB_"+a.code+r.code,altprefix:"GRD_"+a.code+"-SGR_"+r.code,title:(a.title+" "+r.title).replace(/^\s+|\s+$/g,""),id:a.id+"-"+r.id,type:"grade-subgrade",typeName:"Subgrade",grade:a,subgrade:r,count:n}}).value(),t.resolve()},i.onPromiseFail):o.getFeaturesByTypeByModelObject([_]).then(function(i){h=r.chain(i[_]).map(function(t){return{code:t.code,prefix:e.getCodePrefix(t.code,t.type),altprefix:e.getCodePrefix(t.code,t.type),title:t.title,id:t.id,type:t.type,typeName:"Subgrade",count:t.count}}).value(),t.resolve()},i.onPromiseFail),t},getSubgradeCount:function(e,t,i){return r.chain(e).filter(function(e){return e.grade.code===t.code&&e.subgrade.code===i.code}).map(function(e){return e.count}).reduce(function(e,t){return e+t},0).value()},getImagePaths:function(t,i,a,r,n){try{var s=window.threedsession;if(void 0!==s&&s.getImagePaths){var o=s.getImagePaths(t,i,a,r,n);return o}return debuggerOn&&console.log("getImagePaths not defined!",s),[e.blanksrc]}catch(l){return debuggerOn&&console.log("_session.getImagePaths: Path Not Found!",l),[e.blanksrc]}},getGrades:function(){var e=this.getDefaultGrade();return r.each(h,function(t){t.isPicked=e.id===t.id,t.series=p.title}),h},getArrayOrValue:function(e){return e.length>0?r.first(e):e},getModelTitle:function(e){var t=this;return/rav4ev|fjcruiser|landcruiser|prius|priusc|priusv/gi.test(e.series.code)?e.attributes.description.value:t.getArrayOrValue(e.series).title+" "+(e.grade&&t.getArrayOrValue(e.grade).title||"")+" "+(e.subgrade&&t.getArrayOrValue(e.subgrade).title||"")+("tacoma"===e.series.code&&t.getArrayOrValue(e.cab).title||"")},parseMatch:function(t,i){var a=this,n=r.findWhere(e.UnfilteredSeriesList,{modelCode:p.code,modelYear:parseInt(u.code,10)}),s=_.split("-")[0];if(n&&(u.title=n.displayYear),!t||!t.features||!t.features.length)return!1;var c=r.find(t.features,function(e){return e.indexOf("MDL_")>=0?!0:!1});if(!c)return!1;var d=a.getModelByCode(c.replace("MDL_",""));if(d){i&&(d.cab&&t.features.push(o.getCodePrefix(d.cab[0]||d.cab)),d.bed&&t.features.push(o.getCodePrefix(d.bed[0]||d.bed)),d.engine&&t.features.push(o.getCodePrefix(d.engine[0]||d.engine)),d.drive&&t.features.push(o.getCodePrefix(d.drive[0]||d.drive)),d.transmission&&t.features.push(o.getCodePrefix(d.transmission[0]||d.transmission)));var h=d.accessories.concat(d.exteriorcolor).concat(d.interiorcolor).concat([d.bed,d.engine,d.cab,d.drive,d.transmission]),g={base_msrp:d.attributes.msrp.value,trim_id:d.code,delivery:d.attributes.destinationfee.value,title:a.getModelTitle(d),seriesCode:d.series.code,seriesName:d.series.code,grade:d[s][0]?d[s][0].title:d[s].title+(d.subgrade?" "+d.subgrade.title:""),displayYear:u.title,displayName:d.attributes.description.value,year:u.code,image:d.images.anchorimage&&d.images.anchorimage.url||"",engine:d.engine.title,transmission:d.transmission.title,msrp:t.msrp,displayMsrp:r.formatPrice(t.msrp),totalMsrp:r.formatPrice(t.msrp),details:"",model:{},accessories:[],packages:[],accessoriesList:[],msrps:{packageMsrps:r.chain(d.packages).pluck("price").map(function(e){return r.toNumber(e)}).reduce(function(e,t){return e+t},0).toDollarAmount().value(),accessoryMsrps:r.map(d.packages,function(e){return{name:e.title,accessoryCode:e.code,msrp:e.attributes.msrp&&r.toDollarAmount(e.attributes.msrp.value)}})}},m={model:d.code,exteriorcolor:"",interiorcolor:"",packages:[]};return r.each(t.features,function(t){var i;i=l[t]?l[t]:a.getFeatureByCodePrefix(t),i&&(modelFeature=r.find(h,function(e){return e.code===i.code}),modelFeature&&(i=modelFeature),"accessory"===i.type?(g.packages.push(i),g.accessoriesList.push({accessoryCode:i.code,amount:(i.attributes.msrp.value||"0.0").replace("$",""),description:i.title,source:"port"}),m.packages.push(i.code),window.convertCamryHalfYear&&"14.5MY"===i.title&&(g.displayYear="2014.5")):"exteriorcolor"===i.type?(g.exteriorcolor=i.title,g.exteriorcolorcode=i.code,g.hex="#"+(i.attributes.hexvalue.value||"00FF00"),m.exteriorcolor=i.code,i.images&&i.images.carjellyimage&&i.images.carjellyimage.url?g.jelly=0===i.images.carjellyimage.url.indexOf("/config")?"/search-inventory-ws"+i.images.carjellyimage.url:i.images.carjellyimage.url:d.images&&d.images.anchorimage&&d.images.anchorimage.url?g.jelly=0===d.images.anchorimage.url.indexOf("/config")?"/search-inventory-ws"+d.images.anchorimage.url:d.images.anchorimage.url:g.jelly=e.blanksrc):"interiorcolor"===i.type?(g.interiorcolor=i.title,g.interiorcolorcode=i.code,g.swatch=i.images&&i.images.onswatchimage&&i.images.onswatchimage.url?i.images.onswatchimage.url:e.blanksrc,m.interiorcolor=i.code):"model"===i.type?(g.model.code=d.code,g.model.prefix=t,g.model.id=d.id):"year"===i.type&&i.title.toString()!==i.code.toString()?g[i.type]=i.code:g[i.type]=i.title||"")}),g.details="/details/"+u.code+"/"+p.code+"/"+f.code+"/"+m.model+"/"+m.exteriorcolor+"/"+m.interiorcolor+"/"+m.packages.join("-"),g.contentId=u.code+m.model+m.exteriorcolor+m.interiorcolor+m.packages.join(""),g.zipCode=z,g}},getResults:function(){var e=this,t="tundra"===p.code?!0:!1;return M=[],D?(r.isArray(D)&&D.length&&r.each(D,function(i,a){var r=e.parseMatch(i,t);r&&M.push(r)}),{success:!0,results:M}):void 0},resetFilters:function(){var e=this,t=new a.Deferred,r="tundra"===p.code,n=["accessory","exteriorcolor","interiorcolor"],s=["cab","bed","engine","drive","transmission"],o=r?s.concat(n):["model"].concat(n);return a.when(e.getFeatureFilters(o)).then(function(i){m=i,e.updateCurrentPrefixes(),t.resolve()},i.onPromiseFail),t},getFilters:function(){var t=this,n=[],s=new a.Deferred,o=t.getDefaultGrade();return $=new a.Deferred,A=t.getUserPickIds(),t.removeNonGradePicks(),a.when(t.resetFilters()).then(function(){t.setBackUserPicks(),r.each(m,function(t,i){var a="model"===i?"<span>"+u.title+"</span> "+o.title:e.strings.filters[i];n.push({title:a,type:i,filters:t})}),s.resolve(n),$.resolve(n)},i.onPromiseFail),s},updateCurrentPrefixes:function(){O=r.chain(m).map(function(e){return r.pluck(e,"prefix")}).flatten().value()},getFeatureFilters:function(e){var t=this,n=new a.Deferred;return o.getFeaturesByTypeByModelObject(e).then(function(e){var i=e.accessories_sorted,a=r.chain(e).map(function(e,a){var n=null;switch(a){case"accessories":return n=r.map(i.FIO,function(e){return t.getCustomFeature(e)}),["packages",n];case"accessories_sorted":return n=r.map([].concat(i.PIO,i.DIO,i.LIO),function(e){return t.getCustomFeature(e)}),["accessories",n];default:return n=r.map(e,function(e){return t.getCustomFeature(e)}),[a,n]}}).compact().object().value();n.resolve(a)},i.onPromiseFail),n},getAccessoriesFiltersData:function(e){},getCustomFeature:function(t){var i=this,a={};return a.id=t.id,a.code=t.code,a.count=t.count,a.type=t.type,a.title=t.title,a.prefix=i.getCodePrefix(t.code,t.type),a.isPicked=i.isPicked(t.id),a.isDisabled=!(t.count>0),"exteriorcolor"===t.type&&(a.hex="#"+(t.attributes.hexvalue&&t.attributes.hexvalue.value||"f0f")),"interiorcolor"===t.type&&(a.swatch=t.images&&t.images.onswatchimage&&t.images.onswatchimage.url?t.images.onswatchimage.url:e.blanksrc),a},getDetails:function(t){var n=this,d=["grade","model","bed","cab","engine","drive","transmission","exteriorcolor","interiorcolor","accessory"],u=new a.Deferred,h=t.model,f=n.getModelByCode(h);if(!f.id)return s.trigger("SIT:error:oos"),{success:!1};var g={};g.year=[n.getCodePrefix(t.year,"year")],g.series=[n.getCodePrefix(t.series,"series")],r.each(d,function(e){var i=t[e];if("accessory"===e)g[e]=[],r.each(i,function(t){g[e].push(n.getCodePrefix(t,"accessory"))});else if("grade"===e&&"grade-subgrade"===_){var a=l["GRDSUB_"+i];a&&(g.grade=["GRD_"+a.grade.code],g.subgrade=["SGR_"+a.subgrade.code])}else"grade"===e&&"tacoma"===p.code?g.cab=["CAB_"+i]:i&&(g[e]=[n.getCodePrefix(i,e)])});var m="tundra"===p.code?!0:!1;return o.getVehicleMatchPagination("EXACT",10,!0,g).then(function(i){var o=i.getResults();if(o&&o.length){var l=n.getExactPickMatch(t,o),d=l&&[l];if(!d)return void s.trigger("SIT:error:oos");var p=r.map(d,function(e){var t=r.filter(e.getPicks(),function(e){return-1===e.indexOf("msrp_")?!0:!1});return r.each(t,function(e){c[e]=!0}),{features:t,msrp:e.getMsrp()}}),_=v,h=n.parseMatch(p[0],m),g=f.year.code,v=f.year.title,y=f.series.code,b=f.series.title,w=f.grade[0]?f.grade[0].code:f.grade.code,C=f.attributes.description.value,k=p[0].msrp,S=n.getModelFeature(f,t.exteriorcolor,"exteriorcolor"),I=n.getModelFeature(f,t.interiorcolor,"interiorcolor"),T=[];r.each(t.accessory,function(e){var t=n.getModelFeature(f,e,"accessories");t&&t.title&&T.push({title:t.title,description:t.attributes.description.value})});var P=n.getStandardFeaturesFromPicks(t);h.displayYear&&(_=h.displayYear);var x={resultsUrl:"#!/results/"+g+"/"+y+"/"+w,year:_,seriesName:b,seriesCode:y,modelName:f.title,modelCode:f.code,trimName:C,msrp:k,displayMsrp:r.formatPrice(k),engine:r.isArray(f.engine)?f.engine[0].title:f.engine.title,transmission:r.isArray(f.transmission)?f.transmission[0].title:f.transmission.title,exteriorcolor:S.title,hex:S.attributes.hexvalue.value,interiorcolor:I.title,swatch:I.images&&I.images.onswatchimage&&I.images.onswatchimage.url?I.images.onswatchimage.url:e.blanksrc,packages:T,standardFeatures:P,zipcode:a.cookie("zipcode"),resultModel:h};return u.resolve(x),{success:!0,results:x}}return s.trigger("SIT:error:oos"),{success:!1}},i.onPromiseFail),u},getStandardFeaturesFromPicks:function(e){var t=o.getStandardFeaturesByCode(o.seriesCode,"series"),i=[];if(t&&t.standardFeatures){var a=r.findWhere(t.standardFeatures,{modelCode:e.model}).standardFeaturesArray;a=r.map(a,function(e){return e.group=e.group.replace(/^\s+|\s+$/g,""),e}),a=r.filter(a,function(e){return"S"===e.value&&("Exterior"===e.group||"Interior"===e.group||"Safety/Convenience"===e.group)}),i=r.groupBy(a,"group")}return i},setDetailPicks:function(e){var t=["grade","model","bed","cab","engine","drive","transmission","exteriorcolor","interiorcolor","accessory"];r.each(t,function(t){var i=e[t];"accessory"===t&&r.isArray(i)?r.each(i,function(e){o.setPick(e,t)}):i&&o.setPick(i,t)})},getDataForContactDealer:function(e){var t=this,i=(t.getImagePaths("exterior",1,!1,"380_214_PNG"),{isConfig:!0,accessoriesList:r.map(e.packages,function(e){return{code:e.code,msrp:r.toNumber(e.attributes.msrp.value),source:"factory",name:e.title,longDescription:e.attributes.description.value}}),driveName:e.drive&&e.drive.title||"",engine:e.engine,bedName:e.bed&&e.bed.title||"",cabName:e.cab&&e.cab.title||"",grade:e.grade+(e.subgrade?" "+e.subgrade.title:""),image:e.jelly,seriesName:e.seriesCode,deliveryFee:e.delivery,engineName:e.engine,exteriorColor:e.exteriorcolor,exteriorColorCode:e.exteriorcolorcode,exteriorColorName:e.exteriorcolor,displayName:e.title,totalMsrp:e.displayMsrp.replace("$",""),msrpTotal:e.displayMsrp.replace("$",""),interiorColor:e.interiorcolor,exterior_color_name:e.exteriorcolor,exterior_color_code:e.exteriorcolorcode,interior_color_name:e.interiorcolor,interior_color_code:e.interiorcolorcode,modelCode:e.trim_id,modelYear:e.displayYear,year:e.year,trimId:e.trim_id,modelId:"n/a",modelSeries:"n/a",msrp:e.base_msrp,name:e.title,seriesCode:e.seriesCode,tdaCode:"N/A",transmission:e.transmission,transmissionName:e.transmission,modelDisplayYear:e.displayYear,packages:e.packages,msrps:{base:e.base_msrp,packageMsrps:r.chain(d.packages).pluck("price").map(function(e){return r.toNumber(e)}).reduce(function(e,t){return e+t},0).toDollarAmount().value(),accessoryMsrps:r.map(e.packages,function(e){return{name:e.title,accessoryCode:e.code,msrp:e.attributes.msrp&&r.toDollarAmount(e.attributes.msrp.value)}})}});return i},setPick:function(e,t,i){var a=this,n=null,l=null,c=null,d=null;return t?(n=o.getFeatureByCode(e,t),n&&(a.isAGrade(n)&&a.removeAllPicks(),a.setAPick(n),a.onAfterPick(n))):(l=e.split("-"),l.length>1?(a.removeAllPicks(),d=o.getTrueFeaturesByType("subgrade")[0],d&&o.removePick(d.code,"subgrade"),r.each(l,function(e){n=o.getFeatureByID(e),n&&(a.setAPick(n),a.onAfterPick(n))})):(n=o.getFeatureByID(e),n&&(a.isAGrade(n)&&a.removeAllPicks(),a.setAPick(n),a.onAfterPick(n)))),i||s.trigger("SIT:pick:picked",c||n),!0},isAColor:function(e){return/color/.test(e.type)},setAPick:function(e){o.setPick(e.code,e.type)},onAfterPick:function(e){var t=this;t.isAGrade(e)&&(f=e)},removePick:function(e,t){if(debuggerOn&&console.log("removePick:",e,t),e&&!t){var i=o.getFeatureByID(e);if(!i.id)return!1;e=i.code,t=i.type}return console.log("Removing Pick:",i.code,i.type),o.removePick(i.code,i.type),s.trigger("SIT:pick:removed"),!0},resetUserPicks:function(){var e=i.getUserPickIds();r.each(e,function(e){var t=o.getFeatureByID(e);t.type!==_&&"grade"!==t.type&&"subgrade"!==t.type&&o.removePickID(e)})},getColorPicks:function(){var e=r.isArray(d.exteriorcolor)?r.pluck(d.exteriorcolor,"prefix"):[],t=r.isArray(d.interiorcolor)?r.pluck(d.interiorcolor,"prefix"):[];return e.concat(t)},getDisclaimers:function(){return o.getDisclaimers()},getDisclaimerCodes:function(){return o.getDisclaimerCodes()},isOptionById:function(e){return"option"===e.substr(0,6)},isPackage:function(e){return e.isPackage===!0&&e.isALaCarte===!1},isOption:function(e){return e.isPackage===!1&&e.isALaCarte===!1},isAccessory:function(e){return e.isPackage===!1&&e.isALaCarte===!0},session:function(){return o},getFeatureByCodePrefix:function(e){if(l[e])return l[e];if(e){var t=o.getFeatureByCodePrefix(e);return t&&t.title?(l[e]=t,t):t?t:null}return null},getCodePrefix:function(e,t){return o.getCodePrefix({code:e,type:t})},setCurrentPicks:function(e){d=e},getCurrentYear:function(){return u},getCurrentSeries:function(){return p},getCurrentGrade:function(){return f},getCurrentGradePrefix:function(){return g},getModelByCode:function(e){return r.find(v.model,function(t){return t.code===e})},getModelFeature:function(e,t,i){if(i="accessory"===i?"accessories":i,e&&t&&i&&e[i]){var a=r.find(e[i],function(e){return e.code===t});return a?a:o.getFeatureByCode(t,i)}return o.getFeatureByCode(t,i)},getGradeByCode:function(e){var t=null;return r.isArray(h)&&h.length&&(t=r.find(h,function(t){return t.code===e})),t},getDefaultGrade:function(){var e,t,i=this;return"grade-subgrade"===_?(e=r.first(session.getTrueFeaturesByType("grade")),t=r.first(session.getTrueFeaturesByType("subgrade")),e&&t?i.findGradeById(e.id+"-"+t.id):r.first(h)):(e=r.first(session.getTrueFeaturesByType(_)),e?i.findGradeById(e.id):r.first(h))},findGradeById:function(e){return r.find(h,function(t){return t.id===e})},getGradeType:function(){return _},isGST:function(){return 60===C?!0:!1},setRegionCode:function(e){C=e},getTDACode:function(){return d},onPickPicked:function(e,t){debuggerOn&&console.log("onPickPicked");var r=i,n="asc"===x;L=new a.Deferred,r.isAGrade(e)&&r.removeRangeConstraint(),debuggerOn&&console.time("First Page of Results"),o.getVehicleMatchPagination("EXACT",T*I,n).then(function(i){k=i,S=k.getResults(),debuggerOn&&console.timeEnd("First Page of Results"),debuggerOn&&console.time("Results Total Count"),P=k.getMatchCount(),debuggerOn&&console.timeEnd("Results Total Count"),t||(T=1),debuggerOn&&console.time("Results Parse"),r.parseMatches("first-page"),debuggerOn&&console.timeEnd("Results Parse"),
e&&r.isAGrade(e)&&s.trigger("SIT:grade:picked",e)},i.onPromiseFail)},onPickRemoved:function(){debuggerOn&&console.log("onPickRemoved");var e=i,t="asc"===x;L=new a.Deferred,debuggerOn&&console.time("First Page of Results"),o.getVehicleMatchPagination("EXACT",T*I,t).then(function(t){k=t,S=k.getResults(),debuggerOn&&console.timeEnd("First Page of Results"),debuggerOn&&console.time("Results Total Count"),P=o.getFacetCount(session.getUserPicks(!0)),debuggerOn&&console.timeEnd("Results Total Count"),T=1,debuggerOn&&console.time("Results Parse"),e.parseMatches("first-page"),debuggerOn&&console.timeEnd("Results Parse")},i.onPromiseFail)},parseMatches:function(e,t){var a=i,n=P>T*I,o=null;D=r.map(S,function(e){var t=r.filter(e.getPicks(),function(e){return-1===e.indexOf("msrp_")?!0:!1});return r.each(t,function(e){c[e]=!0}),{features:t,msrp:e.getMsrp()}}),o=a.getResults().results,(0===o.length||0===P||o.length<I)&&(n=!1),t||s.trigger("SIT:results",{results:o,matchCount:P,pageType:e,showMoreButton:n}),E="first-page"===e?o:E.concat(o),L.resolve(o)},isPickable:function(e){return!0},isPicked:function(e){var t=this,i=(o.getFeatureByID(e),t.isAUserPick(e));return i},isAUserPick:function(e){return r.contains(A,e)},getNextPageOfResults:function(){var e=this;debuggerOn&&console.log("getNextPageOfResults"),T++,debuggerOn&&console.time("Next Page of Results"),k.getNextPage().then(function(t){S=t.getResults(),debuggerOn&&console.timeEnd("Next Page of Results"),debuggerOn&&console.time("Next Page Results Parse"),e.parseMatches("next-page"),debuggerOn&&console.timeEnd("Next Page Results Parse")},i.onPromiseFail)},removeNonGradePicks:function(){debuggerOn&&console.log("removeNonGradePicks:");var e=this,t=null,i=e.getUserPickIds();r.each(i,function(i){t=o.getFeatureByID(i),e.isAGrade(t)||o.removePick(t.code,t.type)}),T=1,x="asc"},removeAllPicks:function(){var e=this,t=null,i=e.getUserPickIds();r.each(i,function(e){t=o.getFeatureByID(e),o.removePick(t.code,t.type)}),T=1,x="asc"},isAGrade:function(e){return e?"grade"===e.type||"subgrade"===e.type||e.subgrade||"tacoma"===p.code&&"cab"===e.type:!1},getCurrentUserPicks:function(){var e=this;return r.chain(e.getUserPickIds()).map(function(e){return o.getFeatureByID(e)}).groupBy(function(e){return e.type}).value()},getQueryParamOrder:function(){var e=["exteriorcolor","interiorcolor","accessory","sort","page","msrp"];return"tundra"===p.code?e.unshift("cab","bed","engine","drive","transmission"):e.unshift("model"),e.unshift("year","series","grade"),e},getCurrentQueryParams:function(){var e=this,t=e.getCurrentUserPicks(),i=p.code,a=u.code,n=e.getQueryParamOrder();return r.chain(n).map(function(n){return"year"===n?a:"series"===n?i:"grade"===n&&"grade-subgrade"===_?e.getDefaultGrade().code:/model|cab|bed|engine|drive|transmission|exteriorcolor|interiorcolor|accessory/.test(n)&&t[n]?r.chain(t[n]).pluck("code").join("-").value():"sort"===n?x:"page"===n?T:"msrp"===n&&F?F.min+"-"+F.max:t[n]&&r.first(t[n]).code||""}).join("/").value()},getFeatureByID:function(e){var t=e.split("-");return t.length>1?r.find(h,function(e){return e.id}):o.getFeatureByID(t[0])},setSortOrder:function(e){x=e},getSortOrder:function(){return x},setPageNumber:function(e){T=parseInt(e,10)},getPageNumber:function(){return T},triggerResults:function(e){var t=this;s.trigger("inventory:loading"),t.onPickPicked(null,e)},setDefaultGrade:function(){var e=i,t="asc"===x;L=new a.Deferred,e.setPick(e.getDefaultGrade().id,null,!0),debuggerOn&&console.time("First Page of Results"),o.getVehicleMatchPagination("EXACT",T*I,t).then(function(t){k=t,S=k.getResults(),debuggerOn&&console.timeEnd("First Page of Results"),debuggerOn&&console.time("Results Total Count"),P=o.getFacetCount(session.getUserPicks(!0)),debuggerOn&&console.timeEnd("Results Total Count"),debuggerOn&&console.time("Results Parse Silent"),e.parseMatches(null,!0),debuggerOn&&console.timeEnd("Results Parse Silent")},i.onPromiseFail)},getResultsByPage:function(e){},getCurrentParsedResults:function(){return M},getCurrentResults:function(){return D},getTotalParsedResults:function(){return E},getExactPickMatch:function(e,t){return r.find(t,function(t){var i=r.chain(t.getPicks()).filter(function(e){return"ACY_"===e.substr(0,4)}).map(function(e){return e.replace(/ACY_/gi,"")}).value();return 0===r.difference(i,e.accessory).length})},getCurrentModelObj:function(){var e=o.getTrueFeaturesByType("model")[0].id,t=r.find(v.model,function(t){return e===t.id});return t},isTouchSite:function(){return/touch.toyota.com|\-touch.html/gi.test(window.location)},isEspanol:function(){return/\/espanol/gi.test(window.location)},setBackUserPicks:function(){var e=this;r.each(A,function(t){e.isAGrade(o.getFeatureByID(t))||e.setPick(t,null,!0)})},setCurrentZipCode:function(e){z=e},getCurrentZipCode:function(){return z},getUserPickIds:function(){return r.compact(o.getUserPicks())},getFacetCounts:function(){var e=new a.Deferred;return N=new a.Deferred,o.getFacetCount(O).then(function(t){e.resolve(t),N.resolve()},i.onPromiseFail),e},getFiltersDeferred:function(){return $},getResultsDeferred:function(){return L},getFacetCountsDeferred:function(){return N},getRangeDeferred:function(){return V},getMSRPRange:function(){var e=new a.Deferred;return V=new a.Deferred,debuggerOn&&console.time("getMSRPRange"),o.getMSRPRange().then(function(t){e.resolve(t),V.resolve(t),debuggerOn&&console.timeEnd("getMSRPRange")},i.onPromiseFail),e},setRangeConstraint:function(e,t,r){var n=this,s=new a.Deferred;return Y=new a.Deferred,N=new a.Deferred,F={min:e,max:t},a.when(n.getMSRPRange()).then(function(a){a.min&&a.max||i.removeRangeConstraint(),B={min:a.min,max:a.max},o.setRangeConstraint("msrp",e,t),s.resolve(),V.resolve(),Y.resolve()},i.onPromiseFail),s},removeRangeConstraint:function(){F=null,o.removeRangeConstraint("msrp")},getCurrentMSRPRange:function(){return F},getPreviousMSRPRange:function(){return B},getSetRangeDeferred:function(){return Y},getFixedPicksThreed:function(){var e=new a.Deferred;return o.getFixedPicksThreed().then(function(t){e.resolve(t)},i.onPromiseFail),e},isAVirtualSeries:function(e){return/camryhybrid|avalonhybrid|highlanderhybrid/.test(e)},getVirtualSeriesTitleByCode:function(t){return r.findWhere(e.UnfilteredSeriesList,{modelCode:t,modelYear:parseInt(u.code,10)}).modelName},getCurrentPrefixes:function(){return O},onPromiseFail:function(){s.trigger("SIT:service:fail")},getThreedDeferred:function(){return q}});return H}),define("app/collections/series",["sit"],function(e){var t=(e.RIT,e._),i=(e.$,e.Config,e.Backbone),a=(e.Events,e.Util),r=i.Collection.extend({vehicleSort:["Yaris","Corolla","Camry","Avalon","Sienna","Tacoma","Tundra","RAV4","Venza","Highlander","FJ Cruiser","4Runner","Sequoia","Land Cruiser","Camry Hybrid","Avalon Hybrid","RAV4 EV","Highlander Hybrid","Prius","Prius c","Prius Plug-in","Prius v"],initialize:function(){},url:function(){return a.lscs_base+"TComVehiclesData/Series/data/CombinedSeries.xml"},parse:function(i){var a=this,r={},n=i.Root.Series;return window.Series=n,t.map(n,function(e){e.DriveTrain=e.DriveTrain.split(/[\s,]+/),e.Engine=e.Engine.split(/[\s,]+/),e.modelCategory=e.modelCategory.split(/[\s,]+/),e.price=t.toDollar(e.BaseMsrp),e.asShownAs=e.asShownAs?t.toDollar(e.asShownAs):null,e.imageModelName=a.getImageModelName(e),e.displayYear=e.displayYear||e.modelYear,e.multiYear="",r[e.modelCode]=r[e.modelCode]?r[e.modelCode]+1:1}),t.each(n,function(e){r[e.modelCode]>1&&(e.multiYear=e.displayYear+" "),"camryhybrid"===e.modelCode||"avalonhybrid"===e.modelCode||"highlanderhybrid"===e.modelCode?e.imgName=e.imageModelName+"-hybrid.png":"prius-plug-in"===e.modelCode?(e.modelCode="priusplugin",e.imgName="base.png"):e.imgName="base.png"}),e.UnfilteredSeriesList=n,e.SeriesList=t.filter(n,function(e){return e.inAppDisplay&&e.inAppDisplay.searchinventory}),e.SeriesList},getImageModelName:function(e){return e.LinkedSeries&&""!==e.LinkedSeries?e.LinkedSeries:e.modelCode},getSeriesList:function(){return this},getSeriesListByCategory:function(e){var i=this;return t.chain(this.models).filter(function(i){return t.contains(i.get("modelCategory"),e)}).sortBy(function(e){return t.indexOf(i.vehicleSort,e.get("modelName"))}).value()},getSeriesCategories:function(){return t.chain(this.pluck("modelCategory")).flatten().unique().value()}});return r}),define("app/promises",["sit","app/collections/series"],function(e,t){function i(e){e?(h=new o.Deferred,debuggerOn&&(v=(new Date).valueOf()),o.getJSON(C+e,function(t){b=!0;var i=a(t);i.valid&&i.response.success?(debuggerOn&&(y=(new Date).valueOf()-v,o("#debuggerBox").html(o("#debuggerBox").html()+"<br> DIS Lookup: "+y)),d.trigger("SIT:region:ready",t),h.resolve({regionCode:t.regionCode,zipcode:e})):i.response.success?(d.trigger("SIT:region:fail",i),h.reject({reason:"region",redirect_url:i.redirectURL,region_code:i.regionCode})):(d.trigger("SIT:service:fail"),h.reject({reason:"region",redirect_url:i.redirectURL,region_code:i.regionCode}))}).fail(function(){b=!0,d.trigger("SIT:region:fail",{}),h.reject({})})):(b=!0,d.trigger("SIT:region:fail"),h.reject())}function a(e){var t=50,i="toyotahawaii",a="toyotapr",n=[t],s=[i,a],o={valid:!0,response:e};return(l.contains(n,e.regionCode)||l.find(s,function(t){return new RegExp(t,"gi").test(e.redirectUrl)}))&&(o.valid=!1,o.regionCode=e.regionCode||0,o.redirectURL=r(e)),o}function r(e){var t=50,i=60,a=u.regionRedirectURLs;if(/hawaii.com/gi.test(e.redirectUrl))return a.HI;if(/pr.com/gi.test(e.redirectUrl))return a.PR;if(e.regionCode===i)return a.GST;if(e.regionCode===t){var r=-1!==l.indexOf(window.location.toString().split("/"),"espanol")?a.SET_ESP:a.SET,n={avalonhybrid:"avalon-hybrid",camryhybrid:"camry-hybrid",highlanderhybrid:"highlander-hybrid",priusc:"prius-c",priusv:"prius-v",fjcruiser:"fj-cruiser",landcruiser:"land-cruiser","prius-plug-in":"prius"},s=window.location.toString().split("#!"),c=s[1]||"",d=c.split("/"),p=d[3]&&d[3].toLowerCase()||"",_=n[p]||p;return r+"/"+_+"?originating_zip_code="+o.cookie("zipcode")}}function n(e){e?(f=new o.Deferred,o.getJSON(k+e,function(e){if(w=!0,e&&e.tdaGroups&&e.tdaGroups[0]&&e.tdaGroups[0].dealers&&e.tdaGroups[0].dealers.length){var t=l.pluck(e.tdaGroups[0].dealers,"dealerCode");console.debug("triggering dealers ready"),d.trigger("SIT:dealers:ready",{dealerCodes:t}),f.resolve({dealerCodes:t,tdaCode:e.tdaGroups[0].tdaCode})}else d.trigger("SIT:dealers:fail"),f.reject()}).fail(function(e){w=!0,d.trigger("SIT:dealers:fail",e),f.reject()})):(w=!0,d.trigger("SIT:dealers:fail"),f.reject())}function s(t){var a=p.on("sync",function(e,t,i){g.resolve(e)},this).fetch();a.fail(function(){g.reject()}),_.done(function(a){"pending"!==h.state()&&(h=o.Deferred()),"pending"!==f.state()&&(f=o.Deferred()),e.API.setCurrentZipCode(a),t.inventory.set("zipcode",a),i(a),n(a),l.delay(function(){b===!1&&"pending"===h.state()&&h.reject(),w===!1&&"pending"===f.state()&&f.reject()},2e4)}).fail(function(){e.touchsite&&window.location.hash.length>1,d.trigger("SIT:zipcode:fail"),d.trigger("inventory:loaded","error")}),m.done(function(t){c.setZip(t),d.trigger("SIT:refresh:count"),d.trigger("zipcode:changed",t),e.API.setCurrentZipCode(t)}),d.on("zipcode:changed",l.debounce(function(a,r){var s=a;d.trigger("SIT:refresh:count"),e.API.setCurrentZipCode(s),"pending"!==h.state()&&(h=o.Deferred()),"pending"!==f.state()&&(f=o.Deferred()),t.inventory.set("zipcode",s),i(s),n(s)},500,!0))}var o=e.$,l=e._,c=e.Geolocation,d=e.Events,u=e.Config,p=new t,_=c.getZip(),h=new o.Deferred,f=new o.Deferred,g=new o.Deferred,m=new o.Deferred,v=0,y=0,b=!1,w=!1,C=(e.touchsite?"/toyotaSite":"/ToyotaSite")+"/rest/dealerLocator/getRegionCode?brandId=1&zipCode=",k=(e.touchsite?"/toyotaSite":"/ToyotaSite")+"/rest/dealerLocator/dealerPoolV2?zipCode=",S={initialize:s,zipCode:function(){return _},zipEntry:function(){return m},region:function(){return h},series:function(){return g},dealers:function(){return f},passed:function(){return l.every([g,_,f,h],function(e){return"pending"!==e.state()})},setZip:function(t){c.setZip(t),c.getZip().done(function(t){e.API.setCurrentZipCode(t),i(t),n(t)})}};return S}),define("app/router",["sit"],function(e){var t=e.$,i=e._,a=e.i18n,r=e.Backbone,n=e.Events,s=0,o=r.Router.extend({archived_series:["matrix"],initialize:function(e){var t=this;window.rt=this,t.appView=e.appView,t.inventory=e.inventory,t.inventoryDetail=e.inventoryDetail,n.on("SIT:pick:changed",t.setRouteByCurrentPicks,t)},routes:{"":"landing","!/landing":"landing","!/landing/:deepLink":"landing","!/results/:year/:series(/)(*query)":"results","!/details/:year/:series(/)(*query)":"details"},landing:function(t){console.log("landing route:",t),n.trigger("inventory:loading"),t&&(e.deepLink=decodeURIComponent(t)),s=0,this.inventory.picks.resetAllPicks(),this.inventory.set("currentView","landing")},results:function(r,o,l){var c=this,d=t("#sit-errors").is(":visible");if(!d){if(n.trigger("inventory:loading"),"details"===c.inventory.get("currentView")&&(e.API.resetUserPicks(),console.error("router:results:",arguments)),c.inventory.set("currentView","results"),c.inventory.details.set("resultsUrl",window.location.hash),i.isUndefined(l)&&s>0)return c.navigate("#!/landing",{trigger:!0}),void c.inventory.filters.reset();s++;var u=("string"==typeof l?decodeURIComponent(l).split("/"):[]).concat(["","","","","","","","","","","","",""]),p="tundra"===o?{grade:"",cab:"",bed:"",engine:"",drive:"",transmission:"",exteriorcolor:"",interiorcolor:"",accessory:"",sort:"",page:"",msrp:""}:{grade:"",model:"",exteriorcolor:"",interiorcolor:"",accessory:"",sort:"",page:"",msrp:""},_=i.extend(p,i.object(i.keys(p),u),{year:r,series:o});i.each(c.archived_series,function(e){if(o.indexOf(e)>=0){var t="en"==a.lang?"":"espanol/";return window.location.href="/apps/vehicle-archive/"+t+e+".html",!1}}),_.model=c.getSplitParam("model",_),_.exteriorcolor=c.getSplitParam("exteriorcolor",_),_.interiorcolor=c.getSplitParam("interiorcolor",_),_.accessory=c.getSplitParam("accessory",_),e.API.session()&&e.API.removeRangeConstraint(),c.inventory.picks.parsePicks(_),n.trigger("SIT:router:results")}},getSplitParam:function(e,t){return i.compact(t[e]?t[e].split("-"):i.compact[t[e]])},details:function(e,t,r){var o=this;n.trigger("inventory:loading"),s=0,this.inventory.set("currentView","details");var l=("string"==typeof r?decodeURIComponent(r).split("/"):[]).concat(["","","","","","","","","","","",""]),c={grade:"",model:"",exteriorcolor:"",interiorcolor:"",accessory:""},d=i.extend(c,i.object(i.keys(c),l),{year:e,series:t});return i.each(o.archived_series,function(e){if(t.indexOf(e)>=0){var i="en"==a.lang?"":"espanol/";return window.location.href="/apps/vehicle-archive/"+i+e+".html",!1}}),d.year&&d.series?d.model&&d.exteriorcolor&&d.interiorcolor?(d.accessory=i.compact(d.accessory?d.accessory.split("-"):i.compact[d.accessory]),void o.inventory.details.load(d)):(this.navigate("#!/results/"+d.year+"/"+d.series),!1):(this.navigate("#!/landing"),!1)},getPicksFromRoute:function(e){var t=("string"==typeof e?decodeURIComponent(e).split("/"):[]).concat(["","","","","","","","","","","",""]),a="tundra"===series?{details:"",year:"",series:"",grade:"",cab:"",bed:"",engine:"",drive:"",transmission:"",exteriorcolor:"",interiorcolor:"",accessory:"",sort:"",page:""}:{details:"",year:"",series:"",grade:"",model:"",exteriorcolor:"",interiorcolor:"",accessory:"",sort:"",page:""},r=i.extend(a,i.object(i.keys(a),t),{});return r},getRouteFromPicks:function(e){var t=this,a="tundra"===e.series?["year","series","grade","cab","bed","engine","drive","transmission","exteriorcolor","interiorcolor","accessory","sort","page","msrp"]:["year","series","grade","model","exteriorcolor","interiorcolor","accessory","sort","page","msrp"],r=[];i.each(a,function(t,a){var n="";i.isArray(e[t])?n=e[t].join("-"):"string"==typeof e[t]?n=e[t]:e[t]&&(n=""+e[t]),r.push(n)}),r=i.initial(r,function(e){return""===e});var n="#!/results/"+r.join("/");return t.inventory.details.set("resultsUrl",n),n},navigateToPicks:function(e,t){this.navigate(this.getRouteFromPicks(e),t)},setRouteByCurrentPicks:function(){var t=this,i=t.inventory.picks.attributes,a=e.API.getDefaultGrade();a&&a.code&&(i.grade=a.code),t.navigate("#!/results/"+e.API.getCurrentQueryParams(),{silent:!0})}});return o}),define("ritLoading",["sit"],function(e){var t=e.$,i=e._,a=(e.Events,{delay:0,masked:!0,fixed:!1});t.fn.loading=function(e){var r=i.clone(a),n=this;return"stop"===e||"hide"===e||e===!1?t(n).each(function(){t.unmaskElement(t(this))}):("small"===e?e={size:"small"}:"string"==typeof e&&(e={label:e}),i.extend(r,e),r.masked=!1,t(this).each(function(){if("number"==typeof r.delay&&r.delay>0){var e=t(this);e.data("_load_timeout",setTimeout(function(){t.maskElement(t(this),r)},delay))}else t.maskElement(t(this),r)})),n},t.fn.mask=function(e){var r=i.clone(a);"small"===e?e={size:"small"}:"string"==typeof e&&(e={label:e}),i.extend(r,e),t(this).each(function(){if("number"==typeof r.delay&&r.delay>0){var e=t(this);e.data("_load_timeout",setTimeout(function(){t.maskElement(t(this),r)},delay))}else t.maskElement(t(this),r)})},t.fn.unmask=function(){t(this).each(function(){t.unmaskElement(t(this))})},t.fn.isMasked=function(){return this.hasClass("masked")},t.maskElement=function(e,i){if(void 0!==e.data("_load_timeout")&&(clearTimeout(e.data("_load_timeout")),e.removeData("_load_timeout")),e.isMasked())return!1;"static"==e.css("position")&&e.addClass("load-relative"),i.masked&&e.height()>100&&e.addClass("masked");var a=i.masked?"loadmask":"load";a=i.fixed?"loadfixed":a;var r=t('<div class="'+a+'"></div>'),n=t('<i class="load-icon"></i>');if("small"==i.size)r.addClass("small");else if("number"==typeof i.size)if(!Modernizr.cssanimations&&i.size<=20)r.addClass("small");else{var s=-1*Math.floor(i.size/2);n.css({"background-size":i.size+"px",height:i.size+"px",width:i.size+"px",margin:s+"px 0 0 "+s+"px"})}else"string"==typeof i.size&&Modernizr.cssanimations&&n.css({"background-size":i.size,height:i.size,width:i.size});"number"==typeof i.top?n.css("top",i.top+"px"):"string"==typeof i.top&&n.css("top",i.top),"number"==typeof i.left?n.css("left",i.left+"px"):"string"==typeof i.left&&n.css("left",i.left),r.append(n).appendTo(e),"string"==typeof i.label&&e.append('<div class="load-msg">'+i.label+"</div>")},t.unmaskElement=function(e){void 0!==e.data("_load_timeout")&&(clearTimeout(e.data("_load_timeout")),e.removeData("_load_timeout")),e.removeClass("masked load-relative"),e.find(".load-msg,.load,.loadmask,.loadfixed").remove()}}),define("ritPlaceholder",["sit"],function(e){function t(){function e(e){var t={},a=/^jQuery\d+$/;return i.each(e.attributes,function(e,i){i.specified&&!a.test(i.name)&&(t[i.name]=i.value)}),t}function t(e,t){var a=this,r=i(a);if(a.value==r.attr("placeholder")&&r.hasClass("tcom-placeholder"))if(r.data("placeholder-password")){if(r=r.hide().next().show().attr("id",r.removeAttr("id").data("placeholder-id")),e===!0)return r[0].value=t;r.focus()}else a.value="",r.removeClass("tcom-placeholder"),a==document.activeElement&&a.select()}function a(){var a,r=this,n=i(r),s=this.id;if(""==r.value){if("password"==r.type){if(!n.data("placeholder-textinput")){try{a=n.clone().attr({type:"text"})}catch(o){a=i("<input>").attr(i.extend(e(this),{type:"text"}))}a.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":s}).bind("focus.placeholder",t),n.data({"placeholder-textinput":a,"placeholder-id":s}).before(a)}n=n.removeAttr("id").hide().prev().attr("id",s).show()}n.addClass("tcom-placeholder"),n[0].value=n.attr("placeholder")}else n.removeClass("tcom-placeholder")}var r,n,s="placeholder"in document.createElement("input"),o="placeholder"in document.createElement("textarea"),l=i.fn,c=i.valHooks;s&&o?(n=l.placeholder=function(){return this},n.input=n.textarea=!0):(n=l.placeholder=function(){var e=this;return e.filter((s?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":t,"blur.placeholder":a}).data("placeholder-enabled",!0).trigger("blur.placeholder"),e},n.input=s,n.textarea=o,r={get:function(e){var t=i(e);return t.data("placeholder-enabled")&&t.hasClass("tcom-placeholder")?"":e.value},set:function(e,r){var n=i(e);return n.data("placeholder-enabled")?(""==r?(e.value=r,e!=document.activeElement&&a.call(e)):n.hasClass("tcom-placeholder")?t.call(e,!0,r)||(e.value=r):e.value=r,n):e.value=r}},s||(c.input=r),o||(c.textarea=r),i(function(){i(document).delegate("form","submit.placeholder",function(){var e=i(".placeholder",this).each(t);setTimeout(function(){e.each(a)},10)})}),i(window).bind("beforeunload.placeholder",function(){i(".placeholder").each(function(){this.value=""})}))}var i=e.$;t()}),define("ritBootstrapTransition",["sit"],function(e){var t=e.$;t(function(){"use strict";t.support.transition=function(){var e=function(){var e,t=document.createElement("bootstrap"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(e in i)if(void 0!==t.style[e])return i[e]}();return e&&{end:e}}()})}),define("ritBootstrapTooltip",["sit","ritBootstrapTransition"],function(e){"use strict";var t=e.$,i=function(e,t){this.init("tooltip",e,t)};i.prototype={constructor:i,init:function(e,i,a){var r,n;this.type=e,this.$element=t(i),this.options=this.getOptions(a),this.enabled=!0,"click"==this.options.trigger||"touchstart"==this.options.trigger?this.$element.on(this.options.trigger+"."+this.type,this.options.selector,t.proxy(this.toggle,this)):"manual"!=this.options.trigger&&(r="hover"==this.options.trigger?"mouseenter":"focus",n="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(n+"."+this.type,this.options.selector,t.proxy(this.leave,this))),this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(e){return e=t.extend({},t.fn[this.type].defaults,e,this.$element.data()),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},enter:function(e){var i=t(e.currentTarget)[this.type](this._options).data(this.type);return i.options.delay&&i.options.delay.show?(clearTimeout(this.timeout),i.hoverState="in",void(this.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show))):i.show()},leave:function(e){var i=t(e.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),i.options.delay&&i.options.delay.hide?(i.hoverState="out",void(this.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide))):i.hide()},show:function(){var e,t,i,a,r,n,s;if(this.hasContent()&&this.enabled){switch(e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),n="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(n),e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body),i=this.getPosition(t),a=e[0].offsetWidth,r=e[0].offsetHeight,t?n.split(" ")[1]:n){case"bottom":s={top:i.top+i.height,left:i.left+i.width/2-a/2};break;case"top":s={top:i.top-r,left:i.left+i.width/2-a/2};break;case"left":s={top:i.top+i.height/2-r/2,left:i.left-a};break;case"right":s={top:i.top+i.height/2-r/2,left:i.left+i.width}}e.css(s).addClass(n).addClass("in")}},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function e(){var e=setTimeout(function(){i.off(t.support.transition.end).remove()},500);i.one(t.support.transition.end,function(){clearTimeout(e),i.remove()})}var i=this.tip();return i.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?e():i.remove(),this},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(e){return t.extend({},e?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,i=this.options;return e=t.attr("data-original-title")||("function"==typeof i.title?i.title.call(t[0]):i.title)},tip:function(){return this.$tip=this.$tip||t(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}},t.fn.tooltip=function(e){return this.each(function(){var a=t(this),r=a.data("tooltip"),n="object"==typeof e&&e;r||a.data("tooltip",r=new i(this,n)),"string"==typeof e&&r[e]()})},t.fn.tooltip.Constructor=i,t.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!0}}),define("ritBootstrapPopover",["sit","ritBootstrapTooltip"],function(e){"use strict";var t=e.$,i="tmob"===e.Util.site,a=function(e,t){this.init("popover",e,t)};a.prototype=t.extend({},t.fn.tooltip.Constructor.prototype,{constructor:a,setContent:function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content > *")[this.options.html?"html":"text"](i),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,i=this.options;return e=t.attr("data-content")||("function"==typeof i.content?i.content.call(t[0]):i.content)},tip:function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}}),t.fn.popover=function(e){return this.each(function(){var i=t(this),r=i.data("popover"),n="object"==typeof e&&e;r||i.data("popover",r=new a(this,n)),"string"==typeof e&&r[e]()})},t.fn.popover.Constructor=a,t.fn.popover.defaults=t.extend({},t.fn.tooltip.defaults,{placement:"right",trigger:i?"touchstart":"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}),define("ritZipcodeChanger",["sit","ritLoading","ritPlaceholder","ritBootstrapPopover"],function(e,t,i,a){var r=e.$,n=e._,s=e.Util,o=s.i18n,l=e.Events,c=(e.cookie,e.Geolocation),d=e.Backbone,u=d.View.extend({events:{"click h4":"clicked","click input":"clicked","keypress input":"keypressed","input input":"onInputInput","focus input":"onInputFocus","keyup input":"keyup","click .enter":"onEnterClick"},placeholderText:"Enter ZIP Code",initialize:function(){var e,t=this,i=c.getZip();t.$el=e=r(t.el),t.title=t.getTitle(),t.locked=!1,r.fn.placeholder&&e.find("input[placeholder], textarea[placeholder]").placeholder(),r("body").hasClass("configurator")?t.elHtml=n.template('<p><%= title %></p><div class="h4-container"><h4><%= zipcode %></h4><input pattern="[0-9]*" class="zipcode-changer-input" type="text" value="<%= zipcode %>" placeholder="Enter ZIP Code"><div class="enter"></div></div>'):"dealers-seo-v2"==r("body").data("app-name")?t.elHtml=n.template('<p><%= title %></p><div class="h4-container"><h4><%= zipcode %></h4><input pattern="[0-9]*" class="zipcode-changer-input" type="text" value="<%= zipcode %>" placeholder="Enter ZIP Code or City & State or Dealer Name"><div class="enter"></div></div>'):"en"===o.lang?t.elHtml=n.template('<p><%= title %></p><div class="h4-container"><h4><%= zipcode %></h4><input pattern="[0-9]*" class="zipcode-changer-input" type="text" value="<%= zipcode %>" placeholder="Enter ZIP Code"><div class="enter"></div></div>'):t.elHtml=n.template('<p><%= title %></p><div class="h4-container"><h4><%= zipcode %></h4><input pattern="[0-9]*" class="zipcode-changer-input" type="text" value="<%= zipcode %>" placeholder="Cód. Postal"><div class="enter"></div></div>'),t.options.intercept?t.setElement(r("<div />",{"class":"zipcode-changer intercept"})):t.setElement(r("<div />",{"class":"zipcode-changer"+(r.cookie("zipcode")?" akzipcode":"")+(r.cookie("ugzipcode")?" ugzipcode":"")})),t.$el.loading("small"),t.promise=i,l.on("zipcode:changed",function(e){var i=t.$el,a=i.find("h4",t.$el),r=i.find(".zipcode-changer-input",t.$el),n=i.find(".enter",t.$el);a.text()!=e&&a.text(e),r.val()!=e&&r.val(e),a.show(),r.hide(),n.hide(),t.calculate()}),i.done(function(e){t.zipcode=e,t.render()}),i.fail(function(e){console.error("zipcode request fail: "+e),r("body").hasClass("configurator")?t.title="Please confirm your location":"en"===o.lang?t.title="Please confirm your location":t.title="Por favor pon tu código postal",t.zipcode="",t.render()})},getTitle:function(){return r("body").hasClass("configurator")?r.cookie("ugzipcode")?"Your Location":r.cookie("zipcode")?"Not your location?":"N/A":"en"===o.lang?r.cookie("ugzipcode")?"Your Location":r.cookie("zipcode")?"Not your location?":"N/A":"Tu ubicación"},render:function(){var e=this,t=e.$el,i={title:e.title,zipcode:e.options.intercept?"":e.zipcode},a=""+i.zipcode,n=e.elHtml(i);e.$el.html(r(n)),a.length||(t.find("input",e.$el).show(),t.find("h4",e.$el).hide(),e.$el.addClass("empty")),r("body").hasClass("configurator")?t.find("input").popover({placement:"top",content:"Please enter a valid zip code, like '90034'.",trigger:"manual",template:e.popoverTemplate()}):"en"===o.lang?t.find("input").popover({placement:"top",content:"Please enter a valid zip code, like '90034'.",trigger:"manual",template:e.popoverTemplate()}):t.find("input").popover({placement:"top",content:"Por favor pon tu código postal, así '90034'.",trigger:"manual",template:e.popoverTemplate()}),e.$el.loading("stop")},validate:function(e){var t=0;if(e=""+e,5===e.length&&-1===e.indexOf(" ")){for(;5>t;){var i=e.substr(t,t+1);if(" "==i||isNaN(i))return!1;t++}return r.get("/ToyotaSite/rest/dealerLocator/locateDealersByString?brandId=1&searchString="+e)}return!1},popoverTemplate:function(e){var t=this.options.popoverClass||"";return'<div class="popover bottom in form-error '+t+'" style="display: block;"><div class="arrow arrow-shadow"></div><div class="arrow form-error"></div><div class="arrow"></div><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>'},clicked:function(e){var t=this,i=t.$el,a=(r(e.currentTarget),i.find("input")),n=i.find(".enter"),s=i.find("h4");a.is(":visible")||(a.show().focus(),n.show(),s.hide(),l.trigger("zipcode:edit",e))},keyup:function(e){var t=r(e.currentTarget),i=t.val();i.length>=5&&t.val(i.substr(0,5))},keypressed:function(e){var t=this,i=e.keyCode||e.charCode,a=e.charCode;(e.shiftKey||e.ctrlKey||e.altKey)&&e.preventDefault();var n=0===a&&i>=37&&40>=i,s=8==i||9==i||127==i||n;return n||s?void 0:13==i&&5===r(e.currentTarget).val().length?(e.preventDefault(),t.calculate(!0),void t.hideKeyboard()):i>47&&58>i?void 0:(e.preventDefault(),!1)},hideKeyboard:function(){document.activeElement.blur()},onEnterClick:function(){this.calculate(!0)},onInputInput:function(e){var t=e.target;t.value},onInputFocus:function(e){var t=this,i=r(e.target);t.$el.removeClass("empty"),t.$el.removeClass("edit").addClass("edit"),i.attr({placeholder:""}),t.$el.on("blur","input",n.bind(t.onInputBlur,t))},onInputBlur:function(e){var t=this,i=r(e.target);if(t.$el.hasClass("edit")){console.log("blur",i);var a;if(a="en"===o.lang?t.placeholderText:"Cód. Postal",i.attr({placeholder:a}),t.$el.removeClass("edit"),""===i.val()&&t.$el.removeClass("empty").addClass("empty"),t.options.noBlur)return!1;t.calculate()}t.$el.off("blur","input",n.bind(t.onInputBlur,t))},calculate:function(e){var t=this,i=t.$el,a=i.find("input"),n=(i.find(".error"),
i.find(".enter")),s=(i.find(".success"),a.val());t.locked=!0,r.when(t.validate(s)).done(function(o){t.locked=!1,o&&1!==o.code&&1==o.success?(i.find("p").text(t.getTitle()),t.$el.removeClass("empty"),t.options.intercept||t.$el.removeClass("akzipcode ugzipcode").addClass((r.cookie("zipcode")?" akzipcode":"")+(r.cookie("ugzipcode")?" ugzipcode":"")),i.find("h4").text(a.val()).show(),a.hide(),n.hide(),c.getZip().done(function(i){(i!==s||1==e)&&(c.setZip(s),l.trigger("zipcode:changed",s),t.options.triggerDealerSearch&&l.trigger("zipform:updated",s))}).fail(function(){c.setZip(s)}),t.$el.removeClass("error"),a.popover("hide"),l.trigger("zipcode:blur")):(t.$el.addClass("error"),a.popover("show"),l.trigger("zipcode:validation:error"))}),window.setTimeout(function(){a.popover("hide")},3e3)}});return u}),define("app/jst/rit/landing-vehicle",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<div class="series-item'+(null==(__t=lastColumn)?"":__t)+' car-item" data-series-code="'+(null==(__t=modelCode)?"":__t)+'" data-series-name="'+(null==(__t=modelName)?"":__t)+'" data-series-year="'+(null==(__t=Math.floor(String(displayYear)))?"":__t)+'">	<div class="item-info-row">\n<div class="meta-row">\n<h3 class="item-title"><span>'+(null==(__t=multiYear)?"":__t)+(null==(__t=modelName)?"":__t)+'</span></h3>\n<div class="stats-row">\n<div class="stats-item">\n<span class="price">'+(null==(__t=price)?"":__t)+' starting msrp<a class="disclaimer" href="#" data-disclaimer="msrp" data-code="msrp">1</a></span>\n</div>\n',asShownAs&&(__p+='\n<div class="stats-item">\n<span class="msrp">'+(null==(__t=asShownAs)?"":__t)+" as shown</span>\n</div>\n"),__p+='\n</div>\n</div>\n<div class="car-row">\n<div class="jelly-small car-image" style="background-image:url(\'/content/common/img/jellies/small/'+(null==(__t=modelYear)?"":__t)+"/"+(null==(__t=imageModelName)?"":__t)+"/"+(null==(__t=imgName)?"":__t)+"');\"></div>\n</div>\n</div>\n</div>";return __p}}),define("app/jst/rit/landing-category",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+='<h2 class="caption'+(null==(__t=headerClear)?"":__t)+'">\n<span>Toyota '+(null==(__t=category)?"":__t)+"</span>\n</h2>\n"+(null==(__t=seriesList)?"":__t);return __p}}),define("app/views/rit/landing",["sit","app/promises","app/jst/rit/landing-vehicle","app/jst/rit/landing-category"],function(e,t,i,a){var r,n=(e.RIT,e.$),s=e._,o=e.Backbone,l=e.Events,c=e.Config,d=e.Analytics,u=5,p=o.View.extend({didFireLoadTag:!1,events:{"click .series-item":"onClickSeries"},initialize:function(){var i=this;i.appView=i.options.appView,i.router=i.options.router,r=i.$("#car-items"),l.on("SIT:region:ready",function(a){e.API.setRegionCode(a.regionCode),n.when(t.series()).then(function(e){i.collection=e,i.render()})})},onClickSeries:function(t){var i=this,a=n(t.currentTarget),r=n(t.target);debuggerOn&&(console.time("SESSION TIME"),console.time("seriesChange"),e.appView.debugging.seriesChange=(new Date).valueOf()),r.hasClass("disclaimer")||(l.trigger("inventory:loading"),i.router.navigate("#!/results/"+a.data("series-year")+"/"+a.data("series-code"),{trigger:!0}),i.appView.fireIS("117.7",{model_name:a.data("series-code")}))},show:function(){var t=this;t.$el.addClass("is-on"),d.setPageName("T:Inventory:Landing"),t.appView.resetDisclaimers(),t.appView.updateHeader({title:e.strings.title,subTitle:e.strings.subTitle}),l.on("inventory:loaded",function(){t.didFireLoadTag||(t.didFireLoadTag=!0,t.appView.fireIS("117.1"),l.off("inventory:loaded",this))})},hide:function(){var e=this;e.$el.removeClass("is-on")},render:function(){var o=this,d=i,p=a,_=0,h=e.API.isGST(),f=s.map(c.categories,function(e){var t=o.collection.getSeriesListByCategory(e.id),i=s.chain(t).filter(function(e){return!h||"priusplugin"!==e.get("modelCode")&&"rav4ev"!==e.get("modelCode")?!0:!1}).map(function(e){return e.set("lastColumn",++_%u===0?" last-column":""),d(e.toJSON())}).join("").value();return p({category:e.name,seriesList:i,headerClear:(_-t.length)%u===0||(_-t.length)%u===4?" header-clear":""})}).join("");r.html(f).show(),h?n(".caption:eq(3)").css({clear:"both"}):n(".caption:eq(3)").css({clear:""}),s.defer(function(){n("body").css({overflow:"auto"})}),n.when(t.series(),t.zipCode(),t.region()).then(function(){"landing"===o.appView.inventory.get("currentView")&&l.trigger("inventory:loaded","landing")})}});return p}),define("app/jst/rit/filter",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+='<div class="accordion-heading chzn-container-single">\n<div class="accordian-header accordion-toggle chzn-single" data-toggle="collapse" href="#'+(null==(__t=type)?"":__t)+'FilterBody">\n<strong>'+(null==(__t=title)?"":__t)+'</strong>\n<a href="#" class="btn btn-circle smaller pull-right">\n<i class="icon-arrow-down"></i>\n<i class="icon-arrow-up"></i>\n</a>\n</div>\n</div><div id="'+(null==(__t=type)?"":__t)+'FilterBody" class="accordion-body in collapse" data-type="'+(null==(__t=type)?"":__t)+'" style="height: auto">\n<div class="accordion-inner">\n'+(null==(__t=itemsHTML)?"":__t)+"\n</div>\n</div>";return __p}}),define("app/jst/rit/color-filter",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+='<div class="accordion-heading chzn-container-single">\n<div class="accordian-header accordion-toggle chzn-single" data-toggle="collapse" href="#'+(null==(__t=type)?"":__t)+'FilterBody">\n<strong>'+(null==(__t=title)?"":__t)+'</strong>\n<a href="#" class="btn btn-circle smaller pull-right">\n<i class="icon-arrow-down"></i>\n<i class="icon-arrow-up"></i>\n</a>\n</div>\n</div><div id="'+(null==(__t=type)?"":__t)+'FilterBody" class="accordion-body in collapse" style="height: auto">\n<ul class="interior-colors color-picker unstyled">\n<div class="accordion-inner">\n'+(null==(__t=itemsHTML)?"":__t)+"\n</div>\n</ul>\n</div>";return __p}}),define("app/jst/rit/checkbox",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<label class="checkbox',isPicked&&(__p+=" is-on"),isDisabled&&(__p+=" disabled"),__p+='">\n<input type="checkbox" class="" value="'+(null==(__t=prefix)?"":__t)+'" data-title="'+(null==(__t=title)?"":__t)+'" data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'" data-name="'+(null==(__t=name)?"":__t)+'"',isPicked&&(__p+=' checked="checked"'),__p+=">\n"+(null==(__t=SIT._.linkDisclaimer(title))?"":__t)+' <span class="count filter-count">('+(null==(__t=count)?"":__t)+")</span>\n</label>";return __p}}),define("app/jst/rit/color-chip",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<li class="',isPicked&&(__p+=" hangtag"),__p+='" data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'" data-title="'+(null==(__t=title)?"":__t)+'">\n<a href="#" data-msrp="0" data-name="'+(null==(__t=title)?"":__t)+'" style="background:'+(null==(__t=hex)?"":__t)+'"></a>\n<div class="color-chip" data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'" data-tooltip="',title&&(__p+="<strong>"+(null==(__t=title)?"":__t)+" </strong>"),__p+='" data-original-title="'+(null==(__t=title)?"":__t)+'"></div>\n</li>';return __p}}),define("ritBootstrapCollapse",["sit","ritBootstrapTransition"],function(e){"use strict";var t=e.$,i=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.collapse.defaults,i),this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle()};i.prototype={constructor:i,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var e,i,a,r;if(!this.transitioning){if(e=this.dimension(),i=t.camelCase(["scroll",e].join("-")),a=this.$parent&&this.$parent.find("> .accordion-group > .in"),a&&a.length){if(r=a.data("collapse"),r&&r.transitioning)return;a.collapse("hide"),r||a.data("collapse",null)}this.$element[e](0),this.transition("addClass",t.Event("show"),"shown"),t.support.transition&&this.$element[e](this.$element[0][i])}},hide:function(){var e;this.transitioning||(e=this.dimension(),this.reset(this.$element[e]()),this.transition("removeClass",t.Event("hide"),"hidden"),this.$element[e](0))},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[null!==e?"addClass":"removeClass"]("collapse"),this},transition:function(e,i,a){var r=this,n=function(){"show"==i.type&&r.reset(),r.transitioning=0,r.$element.trigger(a)};this.$element.trigger(i),i.isDefaultPrevented()||(this.transitioning=1,this.$element[e]("in"),t.support.transition&&this.$element.hasClass("collapse")?this.$element.one(t.support.transition.end,n):n())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},t.fn.collapse=function(e){return this.each(function(){var a=t(this),r=a.data("collapse"),n="object"==typeof e&&e;r||a.data("collapse",r=new i(this,n)),"string"==typeof e&&r[e]()})},t.fn.collapse.defaults={toggle:!0},t.fn.collapse.Constructor=i,t(function(){t("body").on("click.collapse.data-api","[data-toggle=collapse]",function(e){var i,a=t(this),r=a.attr("data-target")||e.preventDefault()||(i=a.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),n=t(r).data("collapse")?"toggle":a.data();a[t(r).hasClass("in")?"addClass":"removeClass"]("collapsed"),t(r).collapse(n)})})}),define("app/views/rit/results/filter",["sit","app/jst/rit/filter","app/jst/rit/color-filter","app/jst/rit/checkbox","app/jst/rit/color-chip","ritBootstrapCollapse"],function(e,t,i,a,r){var n=e.$,s=e._,o=e.Backbone,l=e.Events,c=o.View.extend({filterType:"model",events:{"click input[type=checkbox]":"onCheckboxClick","click .inline-disclaimer":"onInlineDisclaimerClick"},initialize:function(){var e=this;switch(e.filterType=e.options.type,e.filterType){case"exteriorcolor":case"interiorcolor":e.categoryTpl=i,e.itemTpl=r;break;default:e.categoryTpl=t,e.itemTpl=a}s.bind(e.render,e),e.model.on("change",e.render,e)},onInlineDisclaimerClick:function(e){n(e.currentTarget).parent().is(".disabled")&&e.stopImmediatePropagation()},onCheckboxClick:function(t){var i=n(t.currentTarget);i.parent().is(".disabled")||(debuggerOn&&(console.time("filterChange"),e.appView.debugging.filterChange=(new Date).valueOf()),i.parent().toggleClass("is-on"),l.trigger("SIT:filter:changed",{prefix:i.val(),isChecked:i.is(":checked"),id:i.data("id").toString(),originalEvent:t}))},render:function(){var e=this,t=s.findWhere(e.model.attributes.filters,{type:e.filterType});if(t){var i=s.map(t.filters,function(t){return e.itemTpl(t)}).join(""),a=e.categoryTpl({title:t.title,type:t.type,itemsHTML:i});e.$el.html(a),e.$el.find(".accordion-heading span").addClass("trim-year")}else e.$el.html("")}});return c}),define("app/jst/rit/color-swatch",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+="<li ",isPicked&&(__p+='class="hangtag"'),__p+=' data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'" data-title="'+(null==(__t=title)?"":__t)+'">\n<a href="#" data-msrp="0" data-name="'+(null==(__t=title)?"":__t)+'" style="background-image:url(\''+(null==(__t=swatch)?"":__t)+'\');"></a>\n<div class="color-chip" data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'" data-tooltip="',title&&(__p+="<strong>"+(null==(__t=title)?"":__t)+" </strong>"),__p+='" data-original-title="'+(null==(__t=title)?"":__t)+'"></div>\n</li>';return __p}}),define("app/views/rit/results/color-filter",["sit","app/views/rit/results/filter","app/jst/rit/color-filter","app/jst/rit/color-chip","app/jst/rit/color-swatch","ritBootstrapCollapse"],function(e,t,i,a,r){var n=(e.RIT,e.$),s=e._,o=(e.Backbone,e.Events),l=t.extend({filterType:"model",lastItems:"",events:{"click .color-picker li":"onColorPickerClick"},initialize:function(){var e=this;e.filterType=e.options.type,e.categoryTpl=i,e.itemTpl=a,s.bind(e.render,e),e.model.on("change",e.render,e)},onColorPickerClick:function(e){console.log("conColorPickerClick:",e);var t=n(e.currentTarget);t.find("div").is(".invalid")||(t.toggleClass("hangtag"),o.trigger("SIT:filter:changed",{prefix:t.data("prefix"),isChecked:t.hasClass("hangtag"),id:t.data("id").toString(),originalEvent:e}))},render:function(){var e=this,t=s.findWhere(e.model.attributes.filters,{type:e.filterType});if(e.destroyTooltips(),t){var i=s.map(t.filters,function(e){return e.prefix.indexOf("XCOL_")>-1?a(e):r(e)}).join(""),n=e.categoryTpl({title:t.title,type:t.type,itemsHTML:i});e.$el.html(n),e.$el.find(".accordion-heading span").addClass("trim-year"),e.applyTooltips()}else e.$el.html("")},destroyTooltips:function(){var e=this;s.each(e.$(".color-picker div"),function(e){n(e).popover("destroy")})},applyTooltips:function(){var e=this;Modernizr.touch||s.each(e.$(".color-picker div"),function(e){n(e).popover({trigger:"hover",placement:"bottom",content:n(e).attr("data-tooltip")})})}});return l}),define("app/jst/rit/results-controls",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<a class="btn btn-pill" id="results-start-over" href="#!/landing">\n<i class="icon-refresh"></i>\n<span>Start Over</span>\n</a><select id="results-sort-vehicles" data-placeholder="Sort Vehicles">\n',_.each(options,function(e){__p+='\n<option value="'+(null==(__t=e.value)?"":__t)+'"',e.checked&&(__p+=' selected="selected"'),__p+=">"+(null==(__t=e.text)?"":__t)+"</option>\n"}),__p+="\n</select>";return __p}}),define("app/views/rit/results/controls",["sit","app/jst/rit/results-controls"],function(e,t){var i,a=e.$,r=e._,n=e.Events,s=Modernizr.touch,o=e.Backbone;return Controls=o.View.extend({events:{"change #results-sort-vehicles":"onSortChange"},initialize:function(){var e=this;e.model.on("change",e.render,e)},updateState:function(t){var s=this,o=(e.API.getSortOrder(),s.model);i=a("#results-sort-vehicles"),s.resetDropDown(),o.get("sort")&&(i.find("option").attr("selected",!1),a(i).find('option[value="'+o.get("sort")+'"]').attr("selected","selected")),i.trigger("liszt:updated"),n.trigger("SIT:pick:changed"),a.when(e.API.getResultsDeferred(),e.API.getFacetCountsDeferred(),e.API.getRangeDeferred()).then(function(){r.defer(function(){console.warn("should be done"),n.trigger("inventory:loaded","results")})})},onSortChange:function(t){console.log("controls:onSortChange:",t);var i=this,a=t.currentTarget.value,r=i.model;r.set({sort:a},{silent:!0,tap:t}),r.trigger("change:sort",r,a),e.appView.fireIS("117.1"+("asc"===a?"2":"1")),n.trigger("SIT:sort:changed",{sort:a}),i.updateState()},resetDropDown:function(){console.log("Controls:resetDropDown",i);i.find("option:selected").removeAttr("selected"),i.trigger("liszt:updated")},optionsData:function(){var e=this,t=e.model&&e.model.get("sort")||"";return[{value:"asc",text:"Price: Low to High",checked:"asc"===t},{value:"desc",text:"Price: High to Low",checked:"desc"===t}]},onFacetChange:function(e,t){},render:function(r,n){var o=this,l=e.API.getSortOrder();o.$el.html(t({options:o.optionsData()})),i=a("#results-sort-vehicles"),s||i.chosen({disable_search:!0}),a("#results-sort-vehicles").val(l).trigger("liszt:updated").trigger("chosen:updated")}}),Controls}),define("app/jst/rit/grade-filter",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+='<div class="grades-mask"><ul class="unstyled clearfix">\n'+(null==(__t=gradesHTML)?"":__t)+"\n</ul></div>";return __p}}),define("app/jst/rit/grade-item",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<li class="',isPicked&&(__p+=" is-on"),__p+='">\n<div class="grade-item" data-grade-name="'+(null==(__t=code)?"":__t)+'" data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'">\n<div class="item-info-row">\n<div class="meta-row">\n<span class="series-name">'+(null==(__t=series)?"":__t)+'</span> <span class="grade-name">'+(null==(__t=title.replace(/ *\([^)]*\) */g,""))?"":__t)+'</span><span class="count grade-count">&nbsp;('+(null==(__t=count)?"":__t)+')</span>\n</div>\n</div>\n<div class="grade-hot-spot"></div>\n</div>\n</li>';return __p}}),define("app/views/rit/results/grade-filter",["sit","app/jst/rit/grade-filter","app/jst/rit/grade-item"],function(e,t,i){var a,r=e.$,n=e._,s=e.Backbone,o=e.Events,l=s.View.extend({events:{"click .grade-item":"onSelectGrade"},initialize:function(){var e=this;e.router=e.options.router,e.isTablet=Modernizr.touch,e.model.on("change:grades",e.onGrades,e)},onGrades:function(e,t,i){var a=this;a.render(e,t)},onSelectGrade:function(t){debuggerOn&&(console.time("gradeChange"),e.appView.debugging.gradeChange=(new Date).valueOf());var i=r(t.currentTarget);i.data();i.parent().hasClass("is-on")||(a.removeClass("is-on"),i.parent().addClass("is-on"),o.trigger("inventory:loading"),o.trigger("SIT:filter:changed",{prefix:i.data("prefix"),isChecked:!0,id:i.data("id").toString()}))},render:function(){var e=this,r=e.model.get("grades"),s=n.map(r,function(e){return i(e)}).join(""),o=t({title:r.title,type:r.type,gradesHTML:s});e.$el.html(o),a=e.$("li")}});return l}),define("app/jst/rit/price-filter",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+='<div class="accordion-heading chzn-container-single">\n<div class="accordian-header accordion-toggle chzn-single" data-toggle="collapse" href="#priceFilterBody">\n<strong>Price</strong>\n<a href="#" class="btn btn-circle smaller pull-right">\n<i class="icon-arrow-down"></i>\n<i class="icon-arrow-up"></i>\n</a>\n</div>\n</div><div id="priceFilterBody" class="accordion-body in collapse" style="height: auto">\n<div class="accordion-inner">\n<div id="priceSlider" class="sliderContainer MainrangeSlider">\n<div class="sliderComponent">\n<div class="slider rangeSlider noUiSlider" style="position: relative;"></div>\n<div class="sliderValues">\n<span class="minValue pull-left">'+(null==(__t=min_msrp)?"":__t)+'</span>\n<span class="maxValue pull-right">'+(null==(__t=max_msrp)?"":__t)+"</span>\n</div></div>\n</div>\n</div>\n</div>";return __p}}),define("ritNoUiSlider",["sit"],function(e){var t=e.$;e._,e.Events;t.fn.noUiSlider=function(e,i){function a(e,t,i){"function"==typeof e&&e.call(t,i)}function r(e,t,i){var a=t.data("setup"),r=a.handles,n=a.settings,s=a.pos;if(e=0>e?0:e>100?100:e,2==n.handles)if(i.is(":first-child")){var o=parseFloat(r[1][0].style[s])-n.margin;e=e>o?o:e}else{var o=parseFloat(r[0][0].style[s])+n.margin;e=o>e?o:e}if(n.step){var c=l.from(n.range,n.step);e=Math.round(e/c)*c}return e}function n(e){try{return[e.clientX||e.originalEvent.clientX||e.originalEvent.touches[0].clientX,e.clientY||e.originalEvent.clientY||e.originalEvent.touches[0].clientY]}catch(t){return["x","y"]}}function s(e,t){return parseFloat(e[0].style[t])}var o=window.navigator.msPointerEnabled?2:"ontouchend"in document?3:1;window.debug&&console&&console.log(o);var l={to:function(e,t){return t=e[0]<0?t+Math.abs(e[0]):t-e[0],100*t/this._length(e)},from:function(e,t){return 100*t/this._length(e)},is:function(e,t){return t*this._length(e)/100+e[0]},_length:function(e){return e[0]>e[1]?e[0]-e[1]:e[1]-e[0]}},c={handles:2,serialization:{to:["",""],resolution:.01}};methods={create:function(){return this.each(function(){function i(e,t,i){e.css(d,t+"%").data("input").val(l.is(p.range,t).toFixed(y))}var d,u,p=t.extend(c,e),_="<a><div></div></a>",h=t(this).data("_isnS_",!0),f=[],g="",m=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},v=(p.serialization.resolution=p.serialization.resolution||.01).toString().split("."),y=1==v[0]?0:v[1].length;p.start=m(p.start)?[p.start,0]:p.start,t.each(p,function(e,t){m(t)?p[e]=parseFloat(t):"object"==typeof t&&m(t[0])&&(t[0]=parseFloat(t[0]),m(t[1])&&(t[1]=parseFloat(t[1])));var i=!1;switch(t="undefined"==typeof t?"x":t,e){case"range":case"start":i=2!=t.length||!m(t[0])||!m(t[1]);break;case"handles":i=1>t||t>2||!m(t);break;case"connect":i="lower"!=t&&"upper"!=t&&"boolean"!=typeof t;break;case"orientation":i="vertical"!=t&&"horizontal"!=t;break;case"margin":case"step":i="undefined"!=typeof t&&!m(t);break;case"serialization":i="object"!=typeof t||!m(t.resolution)||"object"==typeof t.to&&t.to.length<p.handles;break;case"slide":i="function"!=typeof t}i&&console&&console.error("Bad input for "+e+" on slider:",h)}),p.margin=p.margin?l.from(p.range,p.margin):0,(p.serialization.to instanceof t||"string"==typeof p.serialization.to||p.serialization.to===!1)&&(p.serialization.to=[p.serialization.to]),"vertical"==p.orientation?(g+="vertical",d="top",u=1):(g+="horizontal",d="left",u=0),g+=p.connect?"lower"==p.connect?" connect lower":" connect":"",h.addClass(g);for(var b=0;b<p.handles;b++){f[b]=h.append(_).children(":last");var w=l.to(p.range,p.start[b]);f[b].css(d,w+"%"),100==w&&f[b].is(":first-child")&&f[b].css("z-index",2);var C="MSPointerDown",k="MSPointerMove",S="MSPointerUp";window.PointerEvent&&(C="pointerdown",k="pointermove",S="pointerup");var I=".noUiSlider",T=(1===o?"mousedown":2===o?C:"touchstart")+I+"X",P=(1===o?"mousemove":2===o?k:"touchmove")+I,x=(1===o?"mouseup":2===o?S:"touchend")+I;f[b].find("div").on(T,function(e){if(t("body").bind("selectstart"+I,function(){return!1}),!h.hasClass("disabled")){t("body").addClass("TOUCH");var i=t(this).addClass("active").parent(),s=i.add(t(document)).add("body"),o=parseFloat(i[0].style[d]),c=n(e),_=c,g=!1;t(document).on(P,function(e){e.preventDefault();var t=n(e);if("x"!=t[0]){t[0]-=c[0],t[1]-=c[1];var s=[_[0]!=t[0],_[1]!=t[1]],m=o+100*t[u]/(u?h.height():h.width());m=r(m,h,i),s[u]&&m!=g&&(i.css(d,m+"%").data("input").val(l.is(p.range,m).toFixed(y)),a(p.slide,h.data("_n",!0)),g=m,i.css("z-index",2==f.length&&100==m&&i.is(":first-child")?2:1)),_=t}}).on(x,function(){s.off(I),t("body").removeClass("TOUCH"),h.find(".active").removeClass("active").end().data("_n")&&h.data("_n",!1).change()})}}).on("click",function(e){e.stopPropagation()})}(1==o||2==o||3==o)&&h.on("click",function(e){if(!h.hasClass("disabled")){var t=n(e),s=100*(t[u]-h.offset()[d])/(u?h.height():h.width()),o=f.length>1?t[u]<(f[0].offset()[d]+f[1].offset()[d])/2?f[0]:f[1]:f[0];i(o,r(s,h,o),h),a(p.slide,h),h.change()}});for(var b=0;b<f.length;b++){var A=l.is(p.range,s(f[b],d)).toFixed(y);"string"==typeof p.serialization.to[b]?f[b].data("input",h.append('<input type="hidden" name="'+p.serialization.to[b]+'">').find("input:last").val(A).change(function(e){e.stopPropagation()})):0==p.serialization.to[b]?f[b].data("input",{val:function(e){return"undefined"==typeof e?this.handle.data("noUiVal"):void this.handle.data("noUiVal",e)},handle:f[b]}):f[b].data("input",p.serialization.to[b].data("handleNR",b).val(A).change(function(){var e=[null,null];e[t(this).data("handleNR")]=t(this).val(),h.val(e)}))}t(this).data("setup",{settings:p,handles:f,pos:d,res:y})})},val:function(){if("undefined"!=typeof arguments[0]){var e="number"==typeof arguments[0]?[arguments[0]]:arguments[0];return this.each(function(){for(var i=t(this).data("setup"),a=0;a<i.handles.length;a++)if(null!=e[a]){var n=r(l.to(i.settings.range,e[a]),t(this),i.handles[a]);i.handles[a].css(i.pos,n+"%").data("input").val(l.is(i.settings.range,n).toFixed(i.res))}})}for(var i=t(this).data("setup").handles,a=[],n=0;n<i.length;n++)a.push(parseFloat(i[n].data("input").val()));return 1==a.length?a[0]:a},disabled:function(){return i?t(this).addClass("disabled"):t(this).removeClass("disabled")}};var d=t.fn.val;return t.fn.val=function(){return this.data("_isnS_")?methods.val.apply(this,arguments):d.apply(this,arguments)},"disabled"==e?methods.disabled.apply(this):methods.create.apply(this)}}),define("app/views/rit/results/price-filter",["sit","app/jst/rit/price-filter","ritNoUiSlider","ritBootstrapCollapse"],function(e,t,i,a){var r,n,s=e.$,o=e._,l=e.Backbone,c=e.Events,d=l.View.extend({events:{"mousedown .noUi-handle":"onNoUIHandleMouseDown"},initialize:function(){var i=this;this.lastMin=0,this.lastMax=1e7,this.priceFilterTpl=t,o.bind(i.render,i),c.on("SIT:api:session:ready SIT:grade:picked",function(){s.when(e.API.getMSRPRange()).then(function(e){i.render(e)})}),c.on("SIT:router:results",function(){e.API.session()&&s.when(e.API.getMSRPRange()).then(function(e){i.render(e)})})},onNoUIHandleMouseDown:function(e){r=s(e.currentTarget).hasClass("noUi-lowerHandle")?"lower":"upper"},render:function(i){var a=this,r=e.API.getCurrentMSRPRange(),l=i.min,d=i.max,u=r&&r.min&&"undefined"!==r.min&&r.min||i.min||i[0],p=r&&r.max&&"undefined"!==r.max&&r.max||i.max||i[1];u=Math.max(l,u),p=Math.min(d,p);var _=t({min_msrp:o.toDollar(u),max_msrp:o.toDollar(p)});a.lastMin=l,a.lastMax=d,a.$el.html(_),l!==d&&(n=s(".rangeSlider").empty().noUiSlider({range:[l,d],start:[u,p],slide:function(){var e=s(this),t=e.val();n.val();a.$(".minValue").html(o.toDollar(parseInt(t[0]))),a.$(".maxValue").html(o.toDollar(parseInt(t[1])))}}),n.change(function(){var t=s(this).val();c.trigger("inventory:loading"),t[0]=parseInt(t[0],10),t[1]=parseInt(t[1],10),a.lastMin!=parseInt(t[0])&&(a.lastMin=parseInt(t[0]),e.appView.fireIS("117.20",{price_filter_tier:parseInt(t[0])+" - "+parseInt(t[1])})),a.lastMax!=parseInt(t[1])&&(a.lastMax=parseInt(t[1]),e.appView.fireIS("117.21",{price_filter_tier:parseInt(t[0])+" - "+parseInt(t[1])})),s.when(e.API.setRangeConstraint(t[0],t[1])).then(function(){c.trigger("SIT:pick:changed"),c.trigger("SIT:update:filters"),e.API.triggerResults(),s.when(e.API.getFacetCountsDeferred()).then(function(){o.defer(function(){c.trigger("inventory:loaded","results")})})})}))}});return d}),define("app/jst/rit/vehicle-result",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<div class="vehicle-result" data-index="'+(null==(__t=index)?"":__t)+'" data-engine="'+(null==(__t=engine)?"":__t)+'" data-display-name="'+(null==(__t=displayName)?"":__t)+'" data-msrp="'+(null==(__t=msrp)?"":__t)+'" data-path="'+(null==(__t=details)?"":__t)+'">\n<div class="vehicle-result-title-row clearfix">\n',jelly&&(__p+='\n<img class="vehicle-image" src="'+(null==(__t=jelly)?"":__t)+'" />\n'),__p+="\n<h3>"+(null==(__t=displayYear)?"":__t)+" "+(null==(__t=title.replace(/ *\([^)]*\) */g,""))?"":__t)+'</h3>\n<a class="btn btn-pill contact-a-dealer" data-index="'+(null==(__t=index)?"":__t)+'" data-flyout-form="INVENTORY_SEARCH" data-model-code="'+(null==(__t=seriesCode)?"":__t)+'" data-trim-id="'+(null==(__t=model.code)?"":__t)+'" href="#">\n<i class="icon-arrow-right"></i><span>Contact a Dealer</span>\n</a>\n</div>\n<div class="vehicle-result-description engine separator">\n<h4>Engine &amp; Transmission</h4>\n<span class="line-item">'+(null==(__t=SIT._.linkDisclaimer(engine))?"":__t)+'</span>\n<span class="line-item">'+(null==(__t=SIT._.linkDisclaimer(transmission))?"":__t)+'</span>\n</div>\n<div class="vehicle-result-description colors separator">\n<h4>Colors</h4>\n<ul class="exterior-colors color-picker unstyled">\n<li>\n<a href="#" data-code="'+(null==(__t=exteriorcolor)?"":__t)+'" data-msrp="0" data-name="'+(null==(__t=exteriorcolor)?"":__t)+'"\nstyle="background:'+(null==(__t=hex)?"":__t)+'"></a>\n<div data-tooltip="&lt;strong&gt;'+(null==(__t=exteriorcolor)?"":__t)+' &lt;/strong&gt;" class="ext" data-original-title="'+(null==(__t=exteriorcolor)?"":__t)+'"></div>\n</li>\n<li>\n<a href="#" data-code="'+(null==(__t=interiorcolor)?"":__t)+'" data-msrp="0" data-name="'+(null==(__t=interiorcolor)?"":__t)+'" style="background-image:url(\''+(null==(__t=swatch)?"":__t)+'\')"></a>\n<div data-tooltip="&lt;strong&gt;'+(null==(__t=interiorcolor)?"":__t)+' &lt;/strong&gt;" class="ext" data-original-title="'+(null==(__t=interiorcolor)?"":__t)+'"></div>\n</li>\n</ul>\n</div>\n<div class="vehicle-result-description package separator">\n<h4>Packages &amp; Options</h4>',packages.length||accessories.length?(__p+="<ul>",_.each(accessories,function(e){""!==e.title&&(__p+="<li>"+(null==(__t=SIT._.linkDisclaimer(e.title))?"":__t)+"</li>")}),_.each(packages,function(e){""!==e.title&&(__p+="<li>"+(null==(__t=SIT._.linkDisclaimer(e.title))?"":__t)+"</li>")}),__p+="</ul>"):__p+="N/A",__p+='</div>\n<div class="vehicle-result-description price">\n',"$0"!==displayMsrp&&(__p+="<h4>"+(null==(__t=displayMsrp)?"":__t)+'</h4><span class="starting-text">total msrp'+(null==(__t=SIT._.linkDisclaimer("[msrp_total]"))?"":__t)+"</span>"),__p+='\n<a class="btn btn-circle tiny view-details" href="#!'+(null==(__t=details)?"":__t)+'">\n<i class="icon-arrow-right-tiny"></i>\n<span>View Details</span>\n</a>\n</div>\n</div>';return __p}}),define("ritChosen",["sit"],function(e){var t=e.$;e.$;(function(){var e;e=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,i,a,r,n,s;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:e.label,children:0,disabled:e.disabled}),n=e.childNodes,s=[],a=0,r=n.length;r>a;a++)i=n[a],s.push(this.add_option(i,t,e.disabled));return s},e.prototype.add_option=function(e,t,i){return"OPTION"===e.nodeName.toUpperCase()?(""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:i===!0?i:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},e}(),e.select_to_array=function(t){var i,a,r,n,s;for(a=new e,s=t.childNodes,r=0,n=s.length;n>r;r++)i=s[r],a.add_node(i);return a.parsed},this.SelectParser=e}).call(this),function(){var e,t;t=this,e=function(){function e(e,t){this.form_field=e,this.options=null!=t?t:{},this.set_default_values(),this.is_multiple=this.form_field.multiple,this.set_default_text(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup()}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!0,this.search_contains=this.options.search_contains||!1,this.numeric_keyboard=this.options.numeric_keyboard||!1,this.choices=0,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0},e.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options":this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option",this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||"No results match"},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(e){var t=this;return this.active_field?void 0:setTimeout(function(){return t.container_mousedown()},50)},e.prototype.input_blur=function(e){var t=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return t.blur_test()},100))},e.prototype.result_add_option=function(e){var t,i;return e.disabled?"":(e.dom_id=this.container_id+"_o_"+e.array_index,
t=e.selected&&this.is_multiple?[]:["active-result"],e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),i=""!==e.style.cssText?' style="'+e.style+'"':"",'<li id="'+e.dom_id+'" class="'+t.join(" ")+'"'+i+">"+e.html+"</li>")},e.prototype.results_update_field=function(){return this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(e){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.keyup_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},e.prototype.generate_field_id=function(){var e;return e=this.generate_random_id(),this.form_field.id=e,e},e.prototype.generate_random_char=function(){var e,t,i;return e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=Math.floor(Math.random()*e.length),t=e.substring(i,i+1)},e}(),t.AbstractChosen=e}.call(this),function(){var e,i,a,r,n=Object.prototype.hasOwnProperty,s=function(e,t){function i(){this.constructor=e}for(var a in t)n.call(t,a)&&(e[a]=t[a]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=this,e=t,e.fn.extend({chosen:function(t){return this.each(function(a){var r;return r=e(this),r.hasClass("chzn-done")?void 0:r.data("chosen",new i(this,t))})}}),i=function(t){function i(){i.__super__.constructor.apply(this,arguments)}return s(i,t),i.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.current_value=this.form_field_jq.val(),this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},i.prototype.finish_setup=function(){var t=1e3,i=e(".chzn-container"),a=i.length;return i.each(function(i,r){e(r).css({"z-Index":t+(a-i)})}),this.form_field_jq.addClass("chzn-done")},i.prototype.set_up_html=function(){var t,i,r,n;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",this.f_width=this.form_field_jq.outerWidth(),t=e("<div />",{id:this.container_id,"class":"chzn-container"+(this.is_rtl?" chzn-rtl":""),style:"width: "+this.f_width+"px;"}),this.is_multiple?t.html(e(this.form_field).data("type")):t.html('<a href="javascript:void(0)" class="chzn-single chzn-default"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="'+(e(this.form_field).data("type")?e(this.form_field).data("type"):"text")+'" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(t),this.container=e("#"+this.container_id),this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single")),this.dropdown=this.container.find("div.chzn-drop").first(),i=this.container.height(),r=this.f_width-a(this.dropdown),this.dropdown.css({width:r+"px",top:i+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),n=r-a(this.search_container)-a(this.search_field),this.search_field.css({width:n+"px"})),this.results_build(),this.set_tab_index(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},i.prototype.register_observers=function(){var e=this;return this.container.mousedown(function(t){return e.container_mousedown(t)}),this.container.mouseup(function(t){return e.container_mouseup(t)}),this.container.mouseenter(function(t){return e.mouse_enter(t)}),this.container.mouseleave(function(t){return e.mouse_leave(t)}),this.search_results.mouseup(function(t){return e.search_results_mouseup(t)}),this.search_results.mouseover(function(t){return e.search_results_mouseover(t)}),this.search_results.mouseout(function(t){return e.search_results_mouseout(t)}),this.form_field_jq.bind("liszt:updated",function(t){return e.results_update_field(t)}),this.form_field_jq.bind("liszt:activate",function(t){return e.activate_field(t)}),this.form_field_jq.bind("liszt:open",function(t){return e.container_mousedown(t)}),this.search_field.blur(function(t){return e.input_blur(t)}),this.search_field.keyup(function(t){return e.keyup_checker(t)}),this.search_field.keydown(function(t){return e.keydown_checker(t)}),this.is_multiple?(this.search_choices.click(function(t){return e.choices_click(t)}),this.search_field.focus(function(t){return e.input_focus(t)})):this.container.click(function(e){return e.preventDefault()})},i.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},i.prototype.container_mousedown=function(t){var i;return this.is_disabled?void 0:(i=null!=t?e(t.target).hasClass("search-choice-close"):!1,t&&"mousedown"===t.type&&!this.results_showing&&t.stopPropagation(),this.pending_destroy_click||i?this.pending_destroy_click=!1:(this.active_field?this.is_multiple||!t||e(t.target)[0]!==this.selected_item[0]&&!e(t.target).parents("a.chzn-single").length||(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(document).click(this.click_test_action),this.results_show()),this.activate_field()))},i.prototype.container_mouseup=function(e){return"ABBR"!==e.target.nodeName||this.is_disabled?void 0:this.results_reset(e)},i.prototype.blur_test=function(e){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},i.prototype.close_field=function(){return e(document).unbind("click",this.click_test_action),this.is_multiple||(this.selected_item.attr("tabindex",this.search_field.attr("tabindex")),this.search_field.attr("tabindex",-1)),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},i.prototype.activate_field=function(){return this.is_multiple||this.active_field||(this.search_field.attr("tabindex",this.selected_item.attr("tabindex")),this.selected_item.attr("tabindex",-1)),this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.options.disable_search||this.search_field.focus(),this.search_field},i.prototype.test_active_click=function(t){return e(t.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},i.prototype.results_build=function(){var e,t,i,a,n;for(this.parsing=!0,this.results_data=r.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),e="",n=this.results_data,i=0,a=n.length;a>i;i++)t=n[i],t.group?e+=this.result_add_group(t):t.empty||(e+=this.result_add_option(t),t.selected&&this.is_multiple?this.choice_build(t):t.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(t.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(e),this.parsing=!1},i.prototype.result_add_group=function(t){return t.disabled?"":(t.dom_id=this.container_id+"_g_"+t.array_index,'<li id="'+t.dom_id+'" class="group-result">'+e("<div />").text(t.label).html()+"</li>")},i.prototype.result_do_highlight=function(e){var t,i,a,r,n;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),a=parseInt(this.search_results.css("maxHeight"),10),n=this.search_results.scrollTop(),r=a+n,i=this.result_highlight.position().top+this.search_results.scrollTop(),t=i+this.result_highlight.outerHeight(),t>=r)return this.search_results.scrollTop(t-a>0?t-a:0);if(n>i)return this.search_results.scrollTop(i)}},i.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},i.prototype.results_show=function(){var e;if(this.is_multiple){if(this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1}else this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected);return e=this.is_multiple?this.container.height():this.container.height()-1,this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.dropdown.css({top:e+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.form_field_jq.trigger("focusin"),this.winnow_results()},i.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this}),this.dropdown.css({left:"-9000px"}),this.form_field_jq.trigger("focusout"),this.results_showing=!1},i.prototype.set_tab_index=function(e){var t;return this.form_field_jq.attr("tabindex")?(t=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.is_multiple?this.search_field.attr("tabindex",t):(this.selected_item.attr("tabindex",t),this.search_field.attr("tabindex",-1))):void 0},i.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},i.prototype.search_results_mouseup=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i.length?(this.result_highlight=i,this.result_select(t)):void 0},i.prototype.search_results_mouseover=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i?this.result_do_highlight(i):void 0},i.prototype.search_results_mouseout=function(t){return e(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},i.prototype.choices_click=function(t){return t.preventDefault(),!this.active_field||e(t.target).hasClass("search-choice")||this.results_showing?void 0:this.results_show()},i.prototype.choice_build=function(t){var i,a,r,n=this;return this.is_multiple&&this.max_selected_options<=this.choices?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(i=this.container_id+"_c_"+t.array_index,this.choices+=1,a=t.disabled?'<li class="search-choice search-choice-disabled" id="'+i+'"><span>'+t.html+"</span></li>":'<li class="search-choice" id="'+i+'"><span>'+t.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+t.array_index+'"></a></li>',this.search_container.before(a),r=e("#"+i).find("a").first(),r.click(function(e){return n.choice_destroy_link_click(e)}))},i.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),this.is_disabled?t.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(e(t.target)))},i.prototype.choice_destroy=function(e){return this.result_deselect(e.attr("rel"))?(this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove()):void 0},i.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},i.prototype.results_reset_cleanup=function(){return this.current_value=this.form_field_jq.val(),this.selected_item.find("abbr").remove()},i.prototype.result_select=function(e){var t,i,a,r;return this.result_highlight?(t=this.result_highlight,i=t.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(t):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=t,this.selected_item.removeClass("chzn-default")),t.addClass("result-selected"),r=i.substr(i.lastIndexOf("_")+1),a=this.results_data[r],a.selected=!0,this.form_field.options[a.options_index].selected=!0,this.is_multiple?this.choice_build(a):(this.selected_item.find("span").first().text(a.text),this.allow_single_deselect&&this.single_deselect_control_build()),e.metaKey&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field_jq.val()!==this.current_value)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[a.options_index].value}),this.current_value=this.form_field_jq.val(),this.search_field_scale()):void 0},i.prototype.result_activate=function(e){return e.addClass("active-result")},i.prototype.result_deactivate=function(e){return e.removeClass("active-result")},i.prototype.result_deselect=function(t){var i,a;return a=this.results_data[t],this.form_field.options[a.options_index].disabled?!1:(a.selected=!1,this.form_field.options[a.options_index].selected=!1,i=e("#"+this.container_id+"_o_"+t),i.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[a.options_index].value}),this.search_field_scale(),!0)},i.prototype.single_deselect_control_build=function(){return this.allow_single_deselect&&this.selected_item.find("abbr").length<1?this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'):void 0},i.prototype.winnow_results=function(){var t,i,a,r,n,s,o,l,c,d,u,p,_,h,f,g,m,v;for(this.no_results_clear(),c=0,d=this.search_field.val()===this.default_text?"":e("<div/>").text(e.trim(this.search_field.val())).html(),s=this.search_contains?"":"^",n=new RegExp(s+d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),_=new RegExp(d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),v=this.results_data,h=0,g=v.length;g>h;h++)if(i=v[h],!i.disabled&&!i.empty)if(i.group)e("#"+i.dom_id).css("display","none");else if(!this.is_multiple||!i.selected){if(t=!1,l=i.dom_id,o=e("#"+l),n.test(i.html))t=!0,c+=1;else if((i.html.indexOf(" ")>=0||0===i.html.indexOf("["))&&(r=i.html.replace(/\[|\]/g,"").split(" "),r.length))for(f=0,m=r.length;m>f;f++)a=r[f],n.test(a)&&(t=!0,c+=1);t?(d.length?(u=i.html.search(_),p=i.html.substr(0,u+d.length)+"</em>"+i.html.substr(u+d.length),p=p.substr(0,u)+"<em>"+p.substr(u)):p=i.html,o.html(p),this.result_activate(o),null!=i.group_array_index&&e("#"+this.results_data[i.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&l===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(o))}return 1>c&&d.length?this.no_results(d):this.winnow_results_set_highlight()},i.prototype.winnow_results_clear=function(){var t,i,a,r,n;for(this.search_field.val(""),i=this.search_results.find("li"),n=[],a=0,r=i.length;r>a;a++)t=i[a],t=e(t),t.hasClass("group-result")?n.push(t.css("display","auto")):this.is_multiple&&t.hasClass("result-selected")?n.push(void 0):n.push(this.result_activate(t));return n},i.prototype.winnow_results_set_highlight=function(){var e,t;return this.result_highlight||(t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),e=t.length?t.first():this.search_results.find(".active-result").first(),null==e)?void 0:this.result_do_highlight(e)},i.prototype.no_results=function(t){var i;return i=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),i.find("span").first().html(t),this.search_results.append(i)},i.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},i.prototype.keydown_arrow=function(){var t,i;return this.result_highlight?this.results_showing&&(i=this.result_highlight.nextAll("li.active-result").first(),i&&this.result_do_highlight(i)):(t=this.search_results.find("li.active-result").first(),t&&this.result_do_highlight(e(t))),this.results_showing?void 0:this.results_show()},i.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},i.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last(),e.length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},i.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},i.prototype.keydown_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},i.prototype.search_field_scale=function(){var t,i,a,r,n,s,o,l,c;if(this.is_multiple){for(a=0,o=0,n="position:absolute; left: -1000px; top: -1000px; display:none;",s=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],l=0,c=s.length;c>l;l++)r=s[l],n+=r+":"+this.search_field.css(r)+";";return i=e("<div />",{style:n}),i.text(this.search_field.val()),e("body").append(i),o=i.width()+25,i.remove(),o>this.f_width-10&&(o=this.f_width-10),this.search_field.css({width:o+"px"}),t=this.container.height(),this.dropdown.css({top:t+"px"})}},i.prototype.generate_random_id=function(){var t;for(t="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();e("#"+t).length>0;)t+=this.generate_random_char();return t},i}(AbstractChosen),a=function(e){var t;return t=e.outerWidth()-e.width()},r.get_side_border_padding=a}.call(this)}),define("app/views/rit/raq",["sit"],function(e){var t=(e.$,e._),i=(e.Events,{getCookieValues:function(e){var i="";return e.accessories&&(i=e.accessories),e.msrps&&(i=e.msrps.accessoryMsrps),{accessoriesList:e.accessoriesList,deliveryFee:e.deliveryFee,description:"N/A",displayName:e.displayName.toString().replace(/(<([^>]+)>)/gi,""),bedName:e.bed||"N/A",cabName:e.cab||"N/A",driveName:e.drive||"N/A",engineName:e.engine,exteriorColor:e.exterior_color_name,exteriorColorCode:e.exteriorcolorcode||e.exterior_color_code,exteriorColorName:e.exteriorcolor||e.exterior_color_name,gradeName:e.grade.toString().replace(/(<([^>]+)>)/gi,""),id:e.trimId,interiorColor:e.interior_color_name||"N/A",interiorColorCode:e.interiorcolorcode||e.interior_color_code,interiorColorName:e.interiorcolor||e.interior_color_name,modelCode:e.seriesCode,modelId:e.trimId,modelSeries:"",modelYear:e.displayYear||e.year,year:e.displayYear||e.year,modelName:e.seriesName.toString().replace(/(<([^>]+)>)/gi,""),series:e.seriesCode,msrp:e.msrp&&e.msrp.toString().replace("$","").replace(",",""),msrps:e.msrps,name:e.seriesName,pakage:t.pluck(e.packages,"code"),packageName:t.pluck(e.packages,"title"),image:e.jelly||e.image,seriesName:e.seriesCode,tdaCode:"N/A",msrpTotal:e.totalMsrp.toString().replace("$","").replace(",",""),totalMsrp:e.totalMsrp.toString().replace("$","").replace(",",""),transmissionName:e.transmission}},setConfigCookie:function(t){e.configuredInventory=this.getCookieValues(t)}});return i}),define("app/views/rit/results",["sit","app/views/rit/results/filter","app/views/rit/results/color-filter","app/views/rit/results/controls","app/views/rit/results/grade-filter","app/views/rit/results/price-filter","app/jst/rit/vehicle-result","ritChosen","ritBootstrapPopover","app/views/rit/raq"],function(e,t,i,a,r,n,s,o,l,c){var d,u,p,_,h=e.$,f=e._,g=e.Backbone,m=e.Events,v=(e.Config,e.touchsite,0),y=(window.location.toString(),{"click #vehicleResults .view-details":"onViewDetailsClick","click #results-start-over":"onStartOverClick","click .add-more-button .btn":"onAddMoreClick","click .contact-a-dealer":"onContactADealerClick","click #gradeFilter .grade-item":"onGradeClick"}),b=g.View.extend({events:y,initialize:function(){var e=this;e.appView=e.options.appView,e.router=e.options.router,f.bindAll(e,"render","generateMarkup"),m.on("SIT:showResults",e.render),m.on("SIT:results",e.onResults,e),m.on("SIT:update:filters",e.updateFilters,e),m.on("SIT:filter:changed",e.handleFilterChange,e),m.on("SIT:router:results",e.onRefreshCount,e),d=e.$("#results-content"),u=e.$("#results-controls"),e.filters=[{el:"#trimFilter",type:"model","class":t},{el:"#packageFilter",type:"packages","class":t},{el:"#accessoryFilter",type:"accessories","class":t},{el:"#exteriorColorFilter",type:"exteriorcolor","class":i},{el:"#interiorColorFilter",type:"interiorcolor","class":i},{el:"#cabFilter",type:"cab","class":t},{el:"#bedFilter",type:"bed","class":t},{el:"#driveFilter",type:"drive","class":t},{el:"#transmissionFilter",type:"transmission","class":t}],e.gradeFilter=new r({model:e.model.grades,el:e.$("#gradeFilter #grade-panels"),router:e.router}),e.priceFilter=new n({model:e.model.filters,el:e.$("#priceFilter")}),e.controls=new a({model:e.model.filters,el:u}),f.each(e.filters,function(t){t.obj=new t["class"]({model:t.model||e.model.filters,el:e.$(t.el),router:e.router,type:t.type})})},onRefreshCount:function(){v=0},handleFilterChange:function(e){var t=this,i=e.originalEvent&&h(e.originalEvent.delegateTarget),a=e.originalEvent&&h(e.originalEvent.currentTarget);i&&(i.is("#trimFilter")?t.appView.fireIS("117.16",{filter_name:a.data("title").trim()}):i.is("#accessoryFilter")?t.appView.fireIS("117.17",{"package":a.data("title").trim()}):i.is("#exteriorColorFilter")?t.appView.fireIS("117.18",{color:a.data("title").trim()}):i.is("#interiorColorFilter")&&t.appView.fireIS("117.19",{color:a.data("title").trim()}))},onViewDetailsClick:function(e){var t=this,i=h(e.target).closest(".view-details"),a=i.closest(".vehicle-result");return m.trigger("inventory:loading"),e.preventDefault(),t.appView.fireIS("117.15",{result_position:a.index()+1,trim_engine:[a.data("displayName"),a.data("engine")].join(" "),percentage_match:"N/A"}),t.router.navigate(i.attr("href"),{trigger:!0}),!1},onContactADealerClick:function(t){var i=this,a=h(t.target).parents(".vehicle-result"),r=e.API.getTotalParsedResults()[a.index()];f.each(r.packages,function(e){e.title.length>0&&(e.title=" "+e.title.replace(/\[.*?\]/g,"").replace(/[ \t]+$/,""))}),f.each(r.accessoriesList,function(e){e.description.length>0&&(e.description=" "+e.description.replace(/\[.*?\]/g,"").replace(/[ \t]+$/,""))}),r=f.cloneDeep(session.apiWrapper.getDataForContactDealer(r),r),c.setConfigCookie(r),i.appView.fireIS("117.14",{result_position:a.index()+1,trim_engine:[r.displayName,r.engine].join(" "),percentage_match:"N/A"})},onGradeClick:function(e,t){var i=h(e.currentTarget),a=i.data("grade-name").split("|")[0]||"N/A";t||this.appView.fireIS("117.13",{model_trim:a})},onStartOverClick:function(e){var t=this;t.model.filters.reset(),t.appView.fireIS("117.10")},showNoResults:function(){debuggerOn&&console.log("results:showNoResults");var t=this,i=(t.model.filters,h("#sit-errors"));t.controls.render(),h("#gradeFilter, #filters, #results_sort_vehicles_chzn").hide(),t.appView.errors.showErrorMessage({type:"region",message:"Please check with your local dealer<br/>to learn about offers in your area.",redirect_url:""}),h(".zipcode-changer",i).remove(),h("a span",i).html("Find a Dealer"),h("a",i).attr("href","/dealers/#!zipcode/"+e.API.getCurrentZipCode()),h("a",i).attr("target","_self")},onGstContinueBtnClicked:function(){var e=this,t=e.model.filters,i=t.get("zipCode");e.appView.analytics.setPageName("T:Inventory:TDA_Redirect"),e.appView.fireIS("117.112",{device_type:e.appView.analytics.deviceType,tda_code:i,zip_code:i})},updateSeriesHeaders:function(){var t=this,i=h("#series-title"),a=e.API.getCurrentSeries(),r=e.API.getCurrentYear(),n=a.title?a.title:"",s=r.title?r.title:"";i.text(s+" "+n),"es"===e.lang?t.appView.updateHeader({title:"Nueva búsqueda en el inventario Toyota "+n,subTitle:"Encontrar un Toyota "+n+" disponible en tu área nunca ha sido más fácil."}):t.appView.updateHeader({title:"New Toyota "+n+" Inventory Search",subTitle:"Finding a Toyota "+n+" in stock near you has never been easier."})},applyColorChipToolTip:function(e,t){return},onAddMoreClick:function(t){var i=this;t.preventDefault(),e.API.getNextPageOfResults(),i.router.setRouteByCurrentPicks(),i.appView.fireIS("117.109")},show:function(){v=0},hide:function(){var e=this;e.$el.removeClass("is-on"),d.find("#gradeFilter ul, #vehicleResults, #filters #trimFilter, #filters #accessoryFilter, #filters #exteriorColorFilter, #filters #interiorColorFilter, #filters #cabFilter, #filters #bedFilter, #filters #engineFilter, #filters #driveFilter, #filters #transmissionFilter, #filters #priceFilter, #filters #results-controls").empty()},firePageLoad:function(){var t=this,i=t.model,a=(t.model.get("currentSeries"),f.contains(window.location.search.split("="),"byt")?"117.3":"117.2");t.appView.analytics.setPageName("T:Inventory:Results:"+e.API.getCurrentSeries().title+":General"),t.appView.fireIS(a,{model_name:e.API.getCurrentSeries().title,number_of_results:i.results.get("results").length})},render:function(){var e=this;e.model;e.$el.addClass("is-on"),e.applyColorChipToolTip(),_=e.$(".add-more-button")},generateMarkup:function(e){var t=this,i=(t.model,e.results),a=h("#filters"),r=h("#gradeFilter"),n=h("#results-controls"),o=f.map(i,function(e,t){return e.index=t,s(e)}).join("");t.model.results.set("page",1),d.addClass("is-on"),u.show(),a.show(),r.show(),p=h(o),h("#results-sort-vehicles, #results_sort_vehicles_chzn",n).css("visibility","visible"),t.applyColorChipToolTip(),0===v&&(t.firePageLoad(),t.render()),v++},onResults:function(e){debuggerOn&&console.error("onResults:",e);var t=this;return debuggerOn&&console.time("onResults"),0===e.matchCount?void t.showNoResults():(t.generateMarkup(e),"first-page"===e.pageType?t.ingestResults():t.appendResults(),t.render(),t.updateAddMoreButton(e.showMoreButton),debuggerOn&&console.timeEnd("onResults"),void(1===v&&(t.updateFilters(),f.defer(function(){m.trigger("inventory:loaded","results")}))))},updateAddMoreButton:function(e){e?_.show():_.hide()},ingestResults:function(){var e=this;e.$("#vehicleResults").html(p)},appendResults:function(){var e=this;p.appendTo(e.$("#vehicleResults"))},updateFilters:function(){var t=this,i=t.$("#filters input[type=checkbox], #filters .color-chip");h.when(e.API.getFacetCounts()).then(function(e){f.each(i,function(t){var i=h(t),a=i.is(".color-chip"),r=i.siblings(".count"),n=e[i.data("prefix")];0===n?a?i.addClass("invalid").parents("li").removeClass("hangtag"):(i.parent().addClass("disabled"),r.text("(0)")):a?i.removeClass("invalid"):(i.parent().removeClass("disabled"),r.text("("+n+")"))})})}});return b}),define("app/jst/rit/threed-image",[],function(){return function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div class="preview_image_block"><div class="IMAGE_3DROTATOR"><div class="image_area"><div class="IMAGE_3D"><div class="threed_image_error" style="display: none;"></div></div></div><div class="cleardiv"></div></div></div>';return __p}}),define("app/views/threed/image",["sit","app/jst/rit/threed-image"],function(e,t){var i=e.$,a=(e._,e.RIT,e.Backbone),r=e.Events;({body:e.$body});return a.View.extend({el:"#threed-wrapper",events:{},cacheImgsDiv:null,clicking:!1,_tmpX:null,_tmpY:null,isTouchSupported:null,curLayers:[],lHolder:null,initialize:function(e){var i=this;i.threed=e,i.options=i.threed.options,debuggerOn&&console.log("threed options:",e.options),i.isTouchSupported="ontouchstart"in window,i.threed.$el.html(t()),i.threed.$dom.image3D=i.$el.find(".IMAGE_3D"),i.initImagePlacement(),i.bindEvents()},bindEvents:function(){var e=this;r.on("angle.changed.threed",e.onAngleChange,e),r.on("view.changed.threed",e.onViewChange,e),r.on("image.next.threed",e.onBtnImgPrevClick,e),r.on("image.prev.threed",e.onBtnImgNextClick,e),r.on("imgJSON.loaded.threed",e.onImgJSONLoaded,e),r.on("picks.changed.threed",e.onPicksChange,e),r.on("profile.changed.threed",e.onProfileChange,e)},unbindEvents:function(){var e=this;r.off("angle.changed.threed",e.onAngleChange,e),r.off("view.changed.threed",e.onViewChange,e),r.off("image.next.threed",e.onBtnImgPrevClick,e),r.off("image.prev.threed",e.onBtnImgNextClick,e),r.off("imgJSON.loaded.threed",e.onImgJSONLoaded,e),r.off("picks.changed.threed",e.onPicksChange,e),r.off("profile.changed.threed",e.onProfileChange,e)},onAngleChange:function(){var e=this;debuggerOn&&console.log("onAngleChange: ",e.threed.tempAngle);var t=e.threed.tempAngle;null!==t&&""!==t?(e.threed.curAngle=t,debuggerOn&&console.log("lAngle: ",t),e.placeAngledImage(e.threed.curView,e.threed.curAngle,e.threed.curMode,e.threed.curProfile)):debuggerOn&&console.log("something wrong with angle initilization")},onImgJSONLoaded:function(){var e=this;e.pI()},onPicksChange:function(){var e=this;e.initImagePlacement()},onProfileChange:function(){var e=this;e.initImagePlacement()},onViewChange:function(){var t=this,i=t.threed.tempView;null!==i&&""!==i?(t.threed.curView=i.toLowerCase(),t.threed.curAngle=1,e.touchsite||"exterior"!==t.threed.curView||(t.threed.curAngle=2),t.placeAngledImage(t.threed.curView,t.threed.curAngle,t.threed.curMode,t.threed.curProfile)):debuggerOn&&console.log("something wrong with view initiilization")},showNextView:function(){debuggerOn&&console.log("showNextView")},showPreviousView:function(){debuggerOn&&console.log("showPreviousView")},showPreviousImage:function(){debuggerOn&&console.log("showPreviousImage");var e=this;e.threed.curAngle>1?e.threed.curAngle--:e.threed.curAngle=e.threed.viewAnglesCount,e.pI()},showNextImage:function(){debuggerOn&&console.log("showNextImage");var e=this;e.threed.curAngle<e.threed.viewAnglesCount?e.threed.curAngle++:e.threed.curAngle=1,e.pI()},initImagePlacement:function(){var e,t,i=this;if(null!==i.threed.imageModelJSON){if(e=JSON.stringify(i.threed.imageModelJSON),t=i.threed.configVariableName.getImageViews(),!t)return debuggerOn&&console.log("No Views found!!"),
null;for(var a=0;a<t.length;a++)debuggerOn&&console.log(t[a].getName()),i.threed.threedViews.push(t[a].getName());i.threed.threedViews.sort(),(void 0===i.threed.curView||null===i.threed.curView)&&(i.threed.curView=i.threed.threedViews[0].toLowerCase(),i.threed.viewAnglesCount=t[0].getAngleCount()),i.pI()}},pI:function(){var e=this;null!==e.threed.imageModelJSON?e.placeAngledImage(e.threed.curView,e.threed.curAngle,e.threed.curMode,e.threed.curProfile):e.$el.html("<span style='color:red'><b>Image model JSON not found</b></span>")},placeAngledImage:function(t,a,r,n){var s,o=this,l=e.API;i.when(e.API.getFixedPicksThreed()).then(function(e){s=l.getImagePaths(t,a,r,n,e),void 0===s&&(o.$el.empty(),debuggerOn&&console.log("image path is undefined")),o.threed.$dom.image3D.children(".LAYER_HOLDER").remove();var c=o.threed.$dom.image3D.children("img");if(s&&1===s.length&&c.length)c.attr("src",s[0]).show();else if(s&&1===s.length)c=i(document.createElement("img")).attr("src",s[0]).addClass("image_class").appendTo(o.threed.$dom.image3D);else if(s&&s.length>1){c.hide(),o.curLayers=[],o.lHolder=i(document.createElement("div")).addClass("LAYER_HOLDER");for(var d=0;d<s.length;d++){var u=o.getShortSha(s[d]);o.curLayers.push(u);var p=i(document.createElement("div")).attr("data-layerid",u).addClass("layered_layer").css("z-index",d+1).appendTo(o.lHolder);i(document.createElement("img")).attr("src",s[d]).appendTo(p).error(o.hideBrokenImg)}o.lHolder.appendTo(o.threed.$dom.image3D)}var _="string"==typeof o.threed.curView?o.threed.curView.toLowerCase():"";o.$el.removeClass("view-exterior view-interior").addClass("view-"+_)})},hideBrokenImg:function(){this.nodeName&&(debuggerOn&&console.log("Missing Hero Image",this),i(this).hide())},getShortSha:function(e){var t,i=e.substr(e.lastIndexOf("/")+1),a=i.split(".");return 2==a.length&&(t=a[0]),t},destroy:function(){var e=this;e.unbindEvents(),e.remove()}})}),define("app/views/threed/threed",["sit","app/views/threed/image"],function(e,t){var i=e.$,a=e._,r=(e.RIT,e.Backbone),n=e.Events,s=(e.$window.width(),["380_214_PNG","680_383_PNG","864_477_PNG"]);return r.View.extend({el:"#threed-wrapper",curAngle:e.touchsite?1:2,curMode:!1,curProfile:null,tempAngle:null,tempView:null,imageSection:null,anglesSection:null,viewsSection:null,configVariableName:null,imageModelJSON:null,threedViews:[],viewAnglesCount:null,threedProfiles:[],imageWidth:null,imageHeight:null,$dom:e.$dom,setConfigVariables:function(e){var t=this;t.configVariableName=e,t.imageModelJSON=e.getImageModelJsonUsingSha(),debuggerOn&&console.log("self.imageModelJSON: ",t.imageModelJSON),i.isEmptyObject(t.imageModelJSON)?t.$el.html("<span style='color:red'><b>Image model JSON not found</b></span>"):t.loadThreedImage()},initialize:function(e,t){var i=this;i.options=t,debuggerOn&&console.log("init options:",i.options),i.setConfigVariables(e)},loadedIMGJSON:function(){debuggerOn&&console.log("onImgJSONLoaded"),n.trigger("imgJSON.loaded.threed")},refresh3DUI:function(){debuggerOn&&console.log("change picks triggered"),n.trigger("picks.changed.threed")},changeView:function(t){debuggerOn&&console.log("view: ",t);var i=this;null!==t&&""!==t&&t!==i.curView?(i.tempView=t,i.$dom.image3D.children("img").attr("src",e.blanksrc),i.$dom.image3D.children(".LAYER_HOLDER").remove(),n.trigger("view.changed.threed",{view:t})):debuggerOn&&console.log("no view argument / same view")},changeAngle:function(e){var t=this;null!==e&&""!==e&&e!=t.curAngle?(t.tempAngle=e,n.trigger("angle.changed.threed",{angle:e})):debuggerOn&&console.log("no angle argument / same angle")},showNextImage:function(){n.trigger("image.next.threed")},showPreviousImage:function(){n.trigger("image.prev.threed")},getAllViews:function(){debuggerOn&&console.log("returns all views");var e=this,t=e.configVariableName.getImageViews();return t?t:null},getAnglesForView:function(e){var t,i=this;return null!==e&&""!==e?(t=i.configVariableName.getImageViews(),t?(a.each(t,function(t){void 0!==t.getName()&&t.getName().toLowerCase()===e.toLowerCase()&&(i.viewAnglesCount=t.getAngleCount())}),i.viewAnglesCount):(debuggerOn&&console.log("No Views found!!"),null)):void(debuggerOn&&console.log("no view argument"))},setProfile:function(e){var t=this;"string"==typeof e&&e.length?t.curProfile=e:debuggerOn&&console.log("No profile is supplied")},getProfiles:function(){var e=this,t=[];return void 0!==e.threedProfiles&&e.threedProfiles.length>0?t=e.threedProfiles:void 0},loadThreedImage:function(){var i,r,n=this;if(null!==n.imageModelJSON&&(n.threedProfiles=[],i=n.imageModelJSON.profileMap,void 0!==i)){if(a.each(i,function(e,t,i){a.contains(s,t)&&n.threedProfiles.push({key:t,w:e.imageSize.w,h:e.imageSize.h})}),n.threedProfiles=a.sortBy(n.threedProfiles,"w"),n.threedProfiles.length&&e.touchsite)r=n.threedProfiles[0];else{if(!n.threedProfiles.length)return void(debuggerOn&&console.log("ERROR: No Threed Profiles found!"));r=n.threedProfiles[n.threedProfiles.length-1]}n.setProfile(r.key),n.imageWidth=r.w,n.imageHeight=r.h,n.$el.attr("data-profile",r.key),n.threedImage&&n.threedImage.destroy(),n.threedImage=new t(n,n.options),debuggerOn&&console.log("self.threedImage: ",n.threedImage)}},destroy:function(){var e=this;e.threedImage.destroy(),e.threedImage=null,e.off("*"),e.remove()}})}),define("ritLocalSpecialNoModels",["sit"],function(e){var t=(e.$,e._,e.Backbone,[{apr:{tiers:{tier:[{term:[{dollarsPerThousand:"16.67",duration:"60",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"},{dollarsPerThousand:"27.78",duration:"36",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"},{dollarsPerThousand:"20.83",duration:"48",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"}],level:"0"},{term:[{dollarsPerThousand:"27.78",duration:"36",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"},{dollarsPerThousand:"20.83",duration:"48",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"},{dollarsPerThousand:"16.67",duration:"60",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"}],level:"1"},{term:[{dollarsPerThousand:"29",duration:"36",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"2.9"},{dollarsPerThousand:"22",duration:"48",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"2.9"},{dollarsPerThousand:"17",duration:"60",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"2.9"}],level:"2"},{term:[{dollarsPerThousand:"30",duration:"36",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"5.9"},{dollarsPerThousand:"23",duration:"48",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"5.9"},{dollarsPerThousand:"19",duration:"60",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"5.9"}],level:"3"}]},monthlyPayment:"",downPayment:"0",subventionDollarAmount:null},tfsCalculator:!1,offerLabel:"Finance Specials",offerLabelNum:"1",seriesList:{series:{included:"",excluded:null,id:"",name:"",year:""}},offerId:"prius_apr_1412191947007",startDate:"2014-10-01",endDate:"2014-11-03",title:"",useForEmail:!1,description:"Get 0.0% APR for 60 months Plus $500 Bonus Cash on a new 2014 Prius.",offerImage:"",offerImageAlt:"",offerImageDisclaimer:"",offerCard:{cardTitle:"",cardImage:"",cardImageAlt:""},bullets:{bullet:[{text:"Get 0% APR for 36 months, 0% APR for 48 months or 0% APR for 60 months for Tier 1+ and Tier 1 credit customers who finance through TFS",link:""},{text:"Plus $500 TFS Bonus Cash",link:""},{text:"All new Toyotas come standard with ToyotaCare no cost maintenance plan with roadside assistance",link:"http://www.southerncalifornia.buyatoyota.com/en/landing/toyota-care"}]},disclaimers:{disclaimer:["0.0% Annual Percentage Rates (APR) for 36 months, 0.0% APR for 48 months, 0.0% APR for 60 months available to eligible customers who finance a new, unused, or unlicensed 2014 Prius from Toyota Motor Sales, USA, Inc. (TMS) and Toyota Financial Services (TFS). Offer valid 2014-10-01 through 2014-11-03. Specific vehicles are subject to availability.  You must take retail delivery from dealer stock. Special APR may not be combined with any other Customer Cash Rebates, Bonus Cash Rebates, or Lease Offers. Finance programs available on credit approval. Not all buyers will qualify for financing from Toyota Financial Services through participating dealers. Monthly payment for every $1,000 financed is 0.0% - 36 months = $27.78; 0.0% - 48 months = $20.83; 0.0% - 60 months = $16.67. See your Toyota dealer for actual pricing, annual percentage rate (APR), monthly payment, and other terms and special offers. Pricing and terms of any finance or lease transaction will be agreed upon by you and your dealer. Special offers are subject to change or termination at any time."]},additionalDisclaimers:"",restrictions:{restriction:[]},additionalRestrictions:"",states:{state:["CA"]},lang:"EN",offerType:"APR"},{cash:{cannotBeCombinedWith:{offerId:[""]},cashAmount:"500",maxAprTerm:null,maxLeaseTerm:null,requiresTfsFinancing:!1,stackableWithApr:!1,stackableWithLease:!1,subTypeLabels:"Cash Back"},tfsCalculator:!1,offerLabel:"Cash Back",offerLabelNum:"7",seriesList:{series:{included:"",excluded:null,id:"",year:"",name:""}},offerId:"corolla_cash_1413573148285",startDate:"2014-10-01",endDate:"2014-11-03",title:"2015 Corolla Cash Back Offer",useForEmail:!1,description:"Get $500 Factory Cash Back on the purchase on a New 2015 Corolla",offerImage:"",offerImageAlt:"",offerImageDisclaimer:"",offerCard:{cardTitle:"",cardImage:"",cardImageAlt:""},bullets:{bullet:[{text:"$500 Factory Cash Back",link:""},{text:"All new Toyotas come standard with ToyotaCare no cost maintenance plan with roadside assistance",link:"http://www.southerncalifornia.buyatoyota.com/en/landing/toyota-care"}]},disclaimers:{disclaimer:["Offer ends 2014-11-03, cannot be combined and is subject to availability. Cash back from Toyota Motor Sales USA, Inc. Varies by region. See participating dealer for details. Does Not include College Grad or Military Rebate. ToyotaCare covers normal factory scheduled service. Plan is 2 years or 25K miles, whichever comes first. The new vehicle cannot be part of a rental or commercial fleet, or a livery/taxi vehicle. See participating Toyota dealer for plan details. Valid only in the continental U.S. and Alaska. Roadside Assistance does not include parts and fluids. Does not include taxes, license, title fees, insurance and dealer charges."]},additionalDisclaimers:"",restrictions:{restriction:[]},additionalRestrictions:"",states:{state:[]},lang:"EN",offerType:"Cash"},{lease:{tiers:{tier:[{term:[{allowableMileage:"12000",capitalizedCost:"30144",dueAtSigningAmount:"1499",duration:"24",extraCashAmount:"",extraCashLabel:"",leaseEndPurchase:"",mileageOverageFee:".15",monthlyPayment:"339",rentChargeFactor:".00001",securityDeposit:"0"}],level:"0"}]},acquisitionFee:"650",dispositionFee:null,subventionDollarAmount:null,dealerCash:null,downPayment:null,vehicleSellingPrice:"32375",dueAtSigning:{acquisitionFee:"0",monthlyPayment:"0",securityDeposit:"0"},accessories:{accessory:[{content:"",code:null,msrp:null,requirement:""}]}},tfsCalculator:!1,offerLabel:"Lease Specials ",offerLabelNum:0,seriesList:{series:{included:"",excluded:null,id:"",year:"",name:""}},offerId:"avalon_lease_1412192682196",startDate:"2014-10-01",endDate:"2014-11-03",title:"",useForEmail:!1,description:"Get a 2014 Avalon for $339/month for 24 months (after $200 TFS lease cash applied)",offerImage:null,offerImageAlt:"",offerImageDisclaimer:"",offerCard:{cardTitle:"",cardImage:"",cardImageAlt:""},bullets:{bullet:[{text:"Lease example for model #3544 3.5L 6-Cyl",link:""},{text:"$339/month for 24 months (after $200 TFS lease cash applied)",link:""},{text:"$1,499 drive-off",link:""},{text:"All new Toyotas come standard with ToyotaCare no cost maintenance plan with roadside assistance",link:"http://www.southerncalifornia.buyatoyota.com/en/landing/toyota-care"}]},disclaimers:{disclaimer:["Lease example for a new  2014 Avalon model  #2014 Models 3544.  Security deposit waived. Plus tax and license. Individual dealer prices vary.  Lessee responsible for maintenance, excess wear and tear, and pays $0.15 per mile for all mileage over 12,000 miles per year.  Lessee to pay $ 339 a month for 24 months with $ 1499 drive-off. Payment may vary depending on model, equipment choice, and final transaction price. Lease cash, if advertised, is only valid in combination with lease program through TFS. Must be leased from new car dealer stock by 2014-11-03. Offers cannot be combined. See your Toyota Dealer for Details.ToyotaCare covers normal factory scheduled service. Plan is 2 years or 25K miles, whichever comes first. The new vehicle cannot be part of a rental or commercial fleet, or a livery/taxi vehicle. See participating Toyota dealer for plan details. Valid only in the continental U.S. and Alaska. Roadside Assistance does not include parts and fluids."]},additionalDisclaimers:"Lease cash valid in combination with program through Toyota Financial Services.",restrictions:{restriction:[]},additionalRestrictions:"",states:{state:["CA"]},lang:"EN",offerType:"Lease"},{miscellaneous:{subTypeLabels:"Service"},tfsCalculator:!1,startDate:"2014-10-01",endDate:"2014-11-03",cashAmount:null,seriesList:{series:[{id:"",year:"",name:""}]},offerId:"miscellaneous_1412128640551",title:"ToyotaCare No Cost Maintenance Plan",useForEmail:!1,offerLabel:"",offerLabelNum:null,description:"No cost maintenance plan with roadside assistance*",offerImage:"/img/Offers/ToyotaCare_240x122.jpg",offerImageAlt:"ToyotaCare",offerImageDisclaimer:"Restrictions apply",offerCard:{cardTitle:"ToyotaCare",cardImage:"/img/Offers/ToyotaCare_240x122.jpg",cardImageAlt:"ToyotaCare"},bullets:{bullet:[{text:"Maintenance: Toyota-trained technicians will help you fulfill maintenance obligations and help improve your Toyota's overall performance, while keeping a complete history of maintenance visits. Toyota will also deliver timely reminders before your scheduled maintenance. Scheduled factory maintenance covers:-Inspect and adjust all fluid levels-Replace engine oil and oil filter-Rotate tires-Multi-point vehicle inspection",link:""},{text:"24 Hour Roadside Assistance: ToyotaCare features 24-hour roadside assistance5 for those days when you need a tire changed or a door unlocked. It covers:-Batter jump starts-Tire service-Emergency fuel delivery-Lockout protection-Towing-Winching",link:""}]},disclaimers:{disclaimer:[]},additionalDisclaimers:"*Covers normal factory scheduled service. Plan is 2 years or 25K miles, whichever comes first. The new vehicle cannot be part of a rental or commercial fleet, or a livery/taxi vehicle. See participating Toyota dealer for plan details. Valid only in the continental U.S. and Alaska. Roadside assistance does not include parts and fluids, except emergency fuel delivery. Prius Plug-in Hybrid comes with an extra year of roadside assistance, for a total of three (3) years from date of first use.",restrictions:{restriction:[]},additionalRestrictions:"",states:{state:[]},lang:"EN",offerType:"Miscellaneous"}]);return{setNoModels:function(){return t}}}),define("ritLocalSpecialTrimModel",["sit"],function(e){var t=(e.$,e._),i=e.Events,a=e.Backbone,r=a.Model.extend({url:function(){var e=this.get("service");return e},initialize:function(e){console.log("LOG init")},onFetchSuccess:function(e){console.log("onFetchSuccess:",e)},onFetchFail:function(e){console.log("onFetchFail:",e),i.trigger("trimFetch:failed")},parse:function(e){var t,i=this,a=(this.get("year"),e.series),t=i.seriesListTrimNames(a);i.set("trimData",t)},seriesListTrimNames:function(e){var i,a,r=[],n=[];return t.each(e,function(e){"tundra"===e.series_code||"tacoma"===e.series_code?t.each(e.trims,function(e){r[0]=r[1]=r[2]="",t.each(e.series_trim_attributes,function(e){switch(e.type){case"grade":r[0]=e.name;break;case"bed":r[1]=e.name;break;case"cab":r[2]=e.name}}),a=r.join(" "),n[e.trim_id]=a}):t.each(e.trims,function(e){i=t.find(e.series_trim_attributes,function(e){return"grade"===e.type?e.name:void 0}),i&&(n[e.trim_id]=i.name)})}),n}});return r}),define("ritLocalSpecialIncentivesModel",["sit","ritLoading","ritLocalSpecialNoModels","ritLocalSpecialTrimModel"],function(e,t,i,a){var r=e._,n=e.$,s=e.Events,o=e.Backbone,l=e.i18n,c=e.cookie,d=e.Geolocation,u=e.Analytics,p=["matrix|2012","matrix|2013","matrix|2014","fjcruiser|2015","fjcruiser|2014","rav4ev|2015","rav4ev|2014"],_=o.Model.extend({defaults:{zipcode:"",zipChange:["0"],filteredData:{},serviceData:{},serviceDataRendered:0,selectedVehicles:{},clearFilters:0,filteredOffers:{offertypes:[]},renderedVehicles:[],serviceFailed:0,tdaCode:"",routerData:{},pageload:0,modelName:null,modelYear:null,clickable:!0,next:0,prev:0,currentPanel:0,start:0},$wrapper:n(".local-specials-wrapper"),modelNameMap:{"prius-plug-in":"priusplugin",priuspluginhybrid:"priusplugin"},url:function(){var e,t,i=this,a=(i.get("zipcode"),c("selectedDealer"),c("selectedTDA"));return a?(e="tdaCode="+a+"&",t="/specialOffers/allOffers?"+e+"zipCode="+i.get("zipcode")):t="/specialOffers/allOffers?zipCode="+i.get("zipcode")+(i.get("modelName")?"&series="+i.get("modelName"):""),t},parse:function(e){var t,a=this,n=i.setNoModels(),s=[];e.offerBundle&&(t=e.offerBundle.offers,r.each(t,function(e,t){r.each(e.bullets.bullet,function(e){if(e&&e.text){var t=e.text.match(/\s/);t||(e.text=unescape(decodeURIComponent(e.text))),e.link=unescape(decodeURIComponent(e.link))}})}),a.options&&a.options.dealType&&(s=r.filter(t,function(e){return e.offerType.toLowerCase()===a.get("dealType")}),e.offerBundle.offers=s,0===s.length&&(s=n,e.offerBundle.offers=s))),a.data=e},initialize:function(t,i){var a=this,o=d.getZip();a.gstZip=!1,a.options=t,a.mapModelNames(),a.on("change:serviceData",a.initTrimCollection,this),s.on("trimData:isSet trimFetch:failed",a.filterIncentives,this),o.done(function(e){a.set("zipcode",e),a.getLocalSpecialsData(!1)}),s.on("zipcode:changed",function(t){t===a.get("zipcode")&&e.incentives||(a.set("zipcode",t),window.location.href.indexOf("efc")>-1&&d.setZip(t),a.zipCodeChanged())}),s.on("tdaCode:isSet",a.getLocalSpecialsData,this),o.fail(function(){s.trigger("zipcode:failed"),u.fire("misc","102.23",{current_pagename:u.currentPageName(),zip_code:n.cookie("zipcode"),device_type:u.deviceType}),n(".filters").hide(),a.$wrapper&&a.$wrapper.length>0&&a.$wrapper.unmask(),require(["text!apps/localspecials/js/template/zip-promise-fail.html","text!apps/localspecials/js/template/espanol/zip-promise-fail.html","common/js/views/zipcode-changer"],function(e,t,i){a.zipCoder=new i,"en"==l.lang?n("#vehicleoffers").html(r.template(e)):n("#vehicleoffers").html(r.template(t)),n(".zip-promise-fail .zipcode-container").html(a.zipCoder.el)})})},zipCodeChanged:function(){var e=this;e.$wrapper.mask({top:"200px"}),e.resetModel(),e.getLocalSpecialsData(!0)},resetModel:function(){var e=this;e.attributes.selectedVehicles={},e.attributes.filteredOffers&&(e.attributes.filteredOffers.offertypes=[]),e.attributes.renderedVehicles=[]},getLocalSpecialsData:function(t){var i,a,o=this;o.fetch({success:function(){if(o.data&&o.data.success!==!1){if(t&&o.get("zipChange")&&(o.get("zipChange").pop(),o.get("zipChange").push("1")),0===o.data.totalOffers&&s.trigger("offers:noIncentives"),i=o.data.offerBundle,null!=i)if(a=o.data.offerBundle.offers[0],"undefined"==typeof a)s.trigger("responseBundle:empty");else{if(void 0!==a&&o.data.code&&"GST10"===o.data.code&&o.gstZip===!1)return o.gstZip=!0,o.getLocalSpecialsData(),!1;void 0===a||a.noIncentives?a&&"GST10"!==o.data.code&&(n(".filters").show(),s.trigger("offers:noIncentives")):(o.gstZip=!1,1==n(".zip-promise-fail").length&&u.fire("misc","102.24",{tda_code:o.data.code,current_pagename:"T:Local_Specials:Zip_Code_Entry",zip_code:n.cookie("zipcode"),device_type:u.deviceType}),n(".filters").show(),o.$wrapper.unmask(),r.isEqual(o.data,o.get("serviceData"))?s.trigger("offersview:render"):o.set("serviceData",o.data))}}else console.log("getLocalSpecialsData error"),s.trigger("offersview:servicefailed");e.incentives=o},error:function(){console.log("offersview:servicefailed"),s.trigger("offersview:servicefailed")}})},initTrimCollection:function(){var e,t,i,s,o=this,l=[],c=[],d=[],u=[],p=o.get("filteredYearTrims"),_=o.get("serviceData").offerBundle.offers;if(t=o.filterTrimAndYear(_),t.singleIncludedTrim===!0){if(e=r.union(t.yearList),p){if(r.each(e,function(e,t){var i=r.find(p,function(t,i){return i.toString()===e});i||u.push(e)}),!(u.length>=1))return void o.filterIncentives();e=u}r.each(e,function(e){i=new a({service:"/CLSREST/api/vehicle_data/series?brand=toyota&key=1rPU7baCdPhU2qHbflmG&depth=1&year="+e,year:e}),l.push(i),c.push(i.fetch())}),n.when.apply(n,c).done(function(){o.get("filteredYearTrims")&&(s=o.get("filteredYearTrims"),d=s),r.each(l,function(e){d[""+e.get("year")]=e.get("trimData")}),o.set("filteredYearTrims",d),o.filterIncentives()})}else o.filterIncentives()},filterTrimAndYear:function(e){var t,i,a,n=[],s=[];return r.each(e,function(e){"Miscellaneous"!==e.offerType,!0&&e.seriesList.series.included&&(a=e.seriesList.series.included.split(","),1===a.length&&(t=!0,i=a[0].split("-"),n.push(i[0]),e.trimId={id:i[1],year:i[0]}))}),s.incentives=e,s.yearList=n,s.singleIncludedTrim=t,s},filterIncentives:function(){var e,t,i,a,n,o,l,c,d,u,_=this,h=_.get("serviceData").offerBundle.offers,f=[],g=[],m=[],v=[],y=[],b=function(e){return Math.floor(e)},w=new Date,C=new Date(w.getFullYear(),w.getMonth(),w.getDate());if(window.location.href.indexOf("#!")>=0&&0===_.get("pageload")&&(s.trigger("offers:storeRouterInfo"),_.set("pageload",1)),!r.isEmpty(h)&&void 0!==h[0]){if(_.get("modelName")){var e=_.get("serviceData").offerBundle.offers;r.each(e,function(e,t){r.isArray(e.seriesList.series)?r.each(e.seriesList.series,function(t){l=t.id.split(", "),c=t.name.split(", "),d=r.indexOf(l,_.get("modelName")),_.get("modelYear")==t.year&&l[d]==_.get("modelName")&&(e.currentFilterId=l[d],e.currentFilterName=c[d],e.currentFilterYear=t.year,y.push(e))}):e.seriesList.series.id==_.get("modelName")&&e.seriesList.series.year==_.get("modelYear")&&y.push(e)}),_.set("vehicleIncentives",y)}if(_.set("tdaCode",_.get("serviceData").code),_.get("serviceData").containsErrors)s.trigger("offers:noIncentives");else{e=_.get("serviceData").offerBundle.offers,r(e.length).times(function(t){var i=e[t].offerType;if("Miscellaneous"!=i&&"Multiple_Vehicle"!=i)f.push(e[t].seriesList.series.id),void 0==e[t].seriesList.series.id;else if("Miscellaneous"==i||"Multiple_Vehicle"==i){r.each(e[t].seriesList.series,function(e){var t=e.id.split(", ");m.push(t)});var a=e[t].seriesList.series[0].id,n=a.split(", ");r.each(n,function(e){g.push(e)})}}),r(m.length).times(function(e){var t=m[e];v=void 0!=v?v.concat(t):t});var f=r.union(v,f,g);o={},r(f.length).times(function(e){void 0===o[f[e]]&&(o[f[e]]={})}),u=_.filterTrimAndYear(e),e=u.incentives,r.each(e,function(e,s){if(-1!=e.endDate.indexOf("-")&&_.formatDate(e),void 0!=e.cash&&void 0!=e.cash.cashAmount&&(e.cash.cashAmount=b(e.cash.cashAmount)),void 0!=e.apr&&void 0!=e.apr.tiers.tier[0].term[0].extraCashAmount&&r.each(e.apr.tiers.tier[0].term,function(t,i){e.apr.tiers.tier[0].term[i].extraCashAmount=b(t.extraCashAmount)}),void 0!=e.lease&&void 0!=e.lease.tiers.tier[0].term[0].extraCashAmount&&r.each(e.lease.tiers.tier[0].term,function(t,i){e.lease.tiers.tier[0].term[i].extraCashAmount=b(t.extraCashAmount),e.lease.tiers.tier[0].term[i].capitalizedCost=b(t.capitalizedCost),e.lease.tiers.tier[0].term[i].dueAtSigningAmount=b(t.dueAtSigningAmount),e.lease.tiers.tier[0].term[i].monthlyPayment=b(t.monthlyPayment),e.lease.tiers.tier[0].term[i].allowableMileage=b(t.allowableMileage)}),_.multipleToMisc(e),"Miscellaneous"!=e.offerType){if(e.isMultipleVehicle=!1,t=e.seriesList.series.id,i=e.seriesList.series.year,-1!==r.indexOf(p,t+"|"+i)||new Date(e.endDate)<C)return;a=e.offerType,n=e.offerId,_.addTrimData(e),void 0===o[t][i]&&(o[t][i]={}),void 0!==o[t][i]&&void 0===o[t][i].incentiveid&&(o[t][i][n]={},void 0===o[t][i][n].incentivetype&&(o[t][i][n][a]=e))}else"Miscellaneous"==e.offerType&&r.each(e.seriesList.series,function(s){t=s.id,t=t.split(", "),i=s.year,r.each(t,function(t){-1!==r.indexOf(p,t+"|"+i)||new Date(e.endDate)<C||(a=e.offerType,n=e.offerId,void 0===o[t][i]&&(o[t][i]={}),void 0!==o[t][i]&&void 0===o[t][i].incentiveid&&(o[t][i][n]={},void 0===o[t][i][n].incentivetype&&(o[t][i][n][a]=e)))})})}),_.set("filteredData",o),s.trigger("offers:filtered")}}},addTrimData:function(e){var t=this,i=t.get("filteredYearTrims");e.trimId?e.trimName=i[e.trimId.year][e.trimId.id]:e.trimName=""},formatDate:function(e){var t,i,a,n,s=[],o=[],l=["year","month","day"];i=e.endDate.split("-"),t=e.startDate.split("-"),r(3).times(function(e){o[l[e]]=i[e],s[l[e]]=t[e]}),n=o.month+"/"+o.day+"/"+o.year,a=s.month+"/"+s.day+"/"+s.year,e.endDate=n,e.startDate=a},multipleToMisc:function(e){var t,i,a;"Multiple_Vehicle"==e.offerType&&(e.offerType="Miscellaneous",e.isMultipleVehicle=!0,t=e.offerId.replace("_",""),i=t.split("_")[1],a=t.split("_")[0].replace("multiplevehicle","miscellaneous"),offerId=a+"_"+i,e.offerId=offerId,e.hasOwnProperty("multivehicle")&&(e.miscellaneous=e.multivehicle,delete e.multivehicle))},getIncentiveByID:function(e){var t=this,i=t.get("serviceData").offerBundle.offers[0];return r.findWhere(i,{offerId:e})},mapModelNames:function(){var e=this;e.modelNameMap[e.get("modelName")]&&e.set("modelName",e.modelNameMap[e.get("modelName")])},setDirection:function(e){var t=this;t.set("direction",e),t.trigger("animate")},setPanel:function(e){var t=this;t.set("currentPanel",e),t.trigger("goToPanel")}});return _}),define("ritPanelSetPageTurner",["sit"],function(e){var t=e.$,i=e._,a=e.Backbone,r=e.i18n,n=a.View.extend({events:{"click .page-turn-next":"handleArrowClicks","click .page-turn-prev":"handleArrowClicks"},initialize:function(){var e=this;e.render()},render:function(){var e=this,t=e.$el,a=parseInt(t.find(".panel").css("height"),10),n="en"==r.lang?{prev:"Previous",next:"Next"}:{prev:"anterior",next:"próximo"},s=i.template('<div class="page-turner"><a class="btn page-turn-prev is-on" href="#"><span class="page-turn-position"><i class="icon-arrow-left-big"></i><span class="btn btn-page-turn-prev"></span><span class="btn page-turn-base-prev"></span><span class="btn page-turn-tip-prev"><%= prev %></span></span></a><a class="btn page-turn-next is-on" href="#"><span class="page-turn-position"><i class="icon-arrow-right-big"></i><span class="btn page-turn-tip-next"><%= next %></span><span class="btn page-turn-base-next"></span><span class="btn btn-page-turn-next"></span></span></a></div>',n);e.$(".page-turner")&&e.$(".page-turner").remove(),t.append(s(n)),e.$(".page-turn-prev, .page-turn-next").css("height",a),e.$(".page-turn-position").css("top",a/2-30),e.$(".page-turner").css({width:e.model.get("width"),"margin-left":"-"+e.model.get("width")/2+"px"}),e.handleButtons(),e.hideShowArrows()},handleArrowClicks:function(e){var i,a=this;a.$(".page-turn-prev, .page-turn-next");e.preventDefault(),a.model.playInterval&&(clearInterval(a.model.playInterval),a.model.playInterval=setInterval(function(){a.model.setDirection("next")},a.model.autoInterval)),a.model.get("clickable")&&(i=t(e.currentTarget).hasClass("page-turn-prev")?"prev":"next",a.model.setDirection(i)),a.hideShowArrows()},hideShowArrows:function(){var e=this,t=e.model.get("currentPanel");e.model.get("infinite")||(0===t?e.$(".page-turn-prev").hide():e.$(".page-turn-prev").show(),t+1===e.model.get("max")&&"next"===e.model.get("direction")?e.$(".page-turn-next").hide():e.$(".page-turn-next").show())},fadeButton:function(e){var t=this,i=t.PageTurners;t[e+"FadeTo"]=setTimeout(function(){i.arrows[e].removeClass("white"),i.buttons[e].fadeOut()},1e3)},handleButtons:function(){function e(e,t){var a=i.PageTurners,r={},n="prev"===t?"left":"right";clearTimeout(i[t+"FadeTo"]),a.arrows[t].addClass("white"),a.buttons[t].show(),a.tips[t].show(),a.base[t].show(),r["margin-"+n]=0,a.tips[t].stop().animate(r,200)}function t(e,t){var a=i.PageTurners,r={},n="prev"===t?"left":"right";clearTimeout(i[t+"FadeTo"]),r["margin-"+n]=-1*a.tips[t].outerWidth()+"px",a.tips[t].stop().animate(r,200,function(){i.fadeButton(t),a.tips[t].hide(),a.base[t].hide()})}var i=this;i.PageTurners={tips:{prev:i.$(".page-turn-tip-prev").hide(),next:i.$(".page-turn-tip-next").hide()},base:{prev:i.$(".page-turn-base-prev").hide(),next:i.$(".page-turn-base-next").hide()},buttons:{prev:i.$(".btn-page-turn-prev").hide(),next:i.$(".btn-page-turn-next").hide()},arrows:{prev:i.$(".icon-arrow-left-big"),next:i.$(".icon-arrow-right-big")}};var a=-1*i.PageTurners.buttons.prev.width();i.PageTurners.tips.next.css("margin-right",a),i.PageTurners.tips.prev.css("margin-left",a),i.$(".page-turn-prev").hover(function(t){e(t,"prev")},function(e){t(e,"prev")}),i.$(".page-turn-next").hover(function(t){e(t,"next")},function(e){t(e,"next")})}});return n}),define("ritPanelSetPageIndicator",["sit"],function(e){var t=e.$,i=e._,a=e.Backbone,r={"click .page-indicator":"handleClicks","click .indicator ul li":"handleNavClicks"};Modernizr.touch&&(r={"touchstart .page-indicator":"handleClicks","touchstart .indicator ul li":"handleNavClicks","click .page-indicator":"handleClicks","click .indicator ul li":"handleNavClicks"});var n=a.View.extend({events:r,initialize:function(){var e=this;e.model.on("change:currentPanel",function(){e.updateIndicator(e.model.get("currentPanel"))},e),e.render()},render:function(){var e=this,i='<ul class="page-indicator"></ul>';e.$el.append(i);for(var a=e.model.get("max");a>=1;a--)t("<li/>").appendTo(e.$el.find(".page-indicator"));e.$(".page-indicator li").first().addClass("page-indicator-is-on")},handleClicks:function(e,a){var r=this,n=t(e.currentTarget),s=i.indexOf(r.$(n.find(e.target.tagName)),e.target),o=r.$("li",n).eq(s).hasClass("page-indicator-is-on");r.model.playInterval&&(clearInterval(r.model.playInterval),r.model.playInterval=setInterval(function(){r.model.setDirection("next")},r.model.autoInterval)),-1===s||o||a&&a.silent||(console.log("!!!!: ",s),r.model.setPanel(s),r.model.set("currentPanel",s),0===r.model.get("currentPanel")?r.$(".page-turn-prev").hide():r.$(".page-turn-prev").show(),r.model.get("currentPanel")+1===r.model.get("max")?r.$(".page-turn-next").hide():r.$(".page-turn-next").show())},handleNavClicks:function(e,a){var r=this,n=t(e.currentTarget),s=i.indexOf(t("li",n.parent()),e.currentTarget),o=r.$("li",n).eq(s).hasClass("page-indicator-is-on");e.preventDefault(),r.model.playInterval&&(clearInterval(r.model.playInterval),r.model.playInterval=setInterval(function(){r.model.setDirection("next")},r.model.autoInterval)),-1===s||o||a&&a.silent||(console.log("!!!!: ",s),r.model.setPanel(s),r.model.set("currentPanel",s))},updateIndicator:function(e){var t=this;t.$(".page-indicator li").removeClass("page-indicator-is-on").eq(e).addClass("page-indicator-is-on"),t.$("#explore-nav li").eq(e).trigger("click",[{silent:!0}])}});return n}),define("ritJQPPEventsKey",["sit"],function(e){function t(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}var i=e.$,a=(e._,e.Events,{}),r={},n=t(navigator.userAgent).browser;i.event.key=function(e,t){if(void 0===e)return a;void 0===t&&(t=e,e=n),a[e]||(a[e]={}),i.extend(a[e],t),r[e]||(r[e]={});for(var s in t)r[e][t[s]]=s},i.event.key({"\b":"8","	":"9","\r":"13",shift:"16",ctrl:"17",alt:"18","pause-break":"19",caps:"20",escape:"27","num-lock":"144","scroll-lock":"145",print:"44","page-up":"33","page-down":"34",end:"35",home:"36",left:"37",up:"38",right:"39",down:"40",insert:"45","delete":"46"," ":"32",0:"48",1:"49",2:"50",3:"51",4:"52",5:"53",6:"54",7:"55",8:"56",9:"57",a:"65",b:"66",c:"67",d:"68",e:"69",f:"70",g:"71",h:"72",i:"73",j:"74",k:"75",l:"76",m:"77",n:"78",o:"79",p:"80",q:"81",r:"82",s:"83",t:"84",u:"85",v:"86",w:"87",x:"88",y:"89",z:"90",num0:"96",num1:"97",
num2:"98",num3:"99",num4:"100",num5:"101",num6:"102",num7:"103",num8:"104",num9:"105","*":"106","+":"107","-":"109",".":"110","/":"111",";":"186","=":"187",",":"188","-":"189",".":"190","/":"191","`":"192","[":"219","\\":"220","]":"221","'":"222","left window key":"91","right window key":"92","select key":"93",f1:"112",f2:"113",f3:"114",f4:"115",f5:"116",f6:"117",f7:"118",f8:"119",f9:"120",f10:"121",f11:"122",f12:"123"}),jQuery.Event.prototype.keyName=function(){var e=this,t=/\w/,i=r[n][(e.keyCode||e.which)+""],a=String.fromCharCode(e.keyCode||e.which),s=e.charCode&&r[n][e.charCode+""],o=e.charCode&&String.fromCharCode(e.charCode);return o&&t.test(o)?o.toLowerCase():s&&t.test(s)?o.toLowerCase():a&&t.test(a)?a.toLowerCase():i&&t.test(i)?i.toLowerCase():"keypress"==e.type?e.keyCode?String.fromCharCode(e.keyCode):String.fromCharCode(e.which):!e.keyCode&&e.which?String.fromCharCode(e.which):r[n][e.keyCode+""]}}),define("ritPanelSet",["sit","ritPanelSetPageTurner","ritPanelSetPageIndicator","ritJQPPEventsKey"],function(e,t,i,a,r){var n=e.$,s=e._,o=e.Backbone,l=e.Events,c=e.touchsite,d=e.$document,u=e.$window,p=!0,_=e.i18n,h=Modernizr.touch?{"swipeleft .panel":"leftSwiper","swiperight .panel":"rightSwiper","touchstart .yt-container":"togglePausePlay",'touchstart a[data-toggle="tab"]':"handleTabNavs"}:{'click a[data-toggle="tab"]':"handleTabNavs","hover .yt-container":"togglePausePlay"},f=o.View.extend({events:h,initialize:function(e){var a=this;a.options=s.extend({el:a.$(".panel-container"),pageTurner:!1,pageIndicator:!1,pageIndicatorContainer:null,infinite:!0,autoInterval:0,resize:!1,minMax:!1,maxWidth:1500,minWidth:1024,keyNavigation:!0},e),a.model=a.options.state,a.resizeTimer,a.currentScrollPos=0,a.prevScrollPos=0,a.options.minMax&&(a.model.minMax=a.options.minMax,a.model.minWidth=a.options.minWidth,a.model.maxWidth=a.options.maxWidth),s.bindAll(a,"render"),a.options.keyNavigation&&(d.on("keydown",a.handleKeyStrokes).on("keyup",a.setAllowed),d.on("focus",a.setAllowed).on("scroll",a.handleScroll)),a.model.set("infinite",a.options.infinite),a.model.on("animate",function(){"next"===a.model.get("direction")?a.next():a.prev()}),a.model.on("goToPanel",function(){a.goToPanel()}),l.on("mlp:goToPanel",function(e,i,r){if(a.el.id===i.attr("id")){if(a.model.setPanel(e),a.model.set("currentPanel",e),a.model.set("direction","next"),a.goToPanel(),r)return;a.pageTurner=new t({el:a.el,model:a.options.state})}}),a.$panelSet=a.$(".panel-set"),a.$allPanels=a.$(".panel"),a.render(),a.options.pageIndicator&&a.$allPanels.length>1&&(a.pageIndicator=new i({el:a.options.pageIndicatorContainer?n(a.options.pageIndicatorContainer,this.el):this.el,model:a.options.state})),a.options.resize&&u.on("resize",a.onResize),a.options.autoInterval&&(a.model.autoInterval=a.options.autoInterval,a.model.playInterval=setInterval(function(){a.model.setDirection("next")},a.model.autoInterval));var r=a.options.start||a.model.get("start");r&&(a.model.set("currentPanel",r-1),a.model.setPanel(r-1))},render:function(){var e,i,a,r=this;n(".panel-container:first").addClass("active-section"),r.model.set("clickable",!0),r.$allPanels.each(function(e){var t=n(this),i=t.data(),a={};i.background&&(a["background-image"]="url("+i.background+")",a["background-position"]="center top"),i.color&&(a.color="#"+i.color),t.css(a),i.title&&t.find(".page-header h2").html(i.title),t.hasClass("panel-custom")&&i.customPanel&&("en"==_.lang?require(["common/js/views/panels/custom/"+i.customPanel+"/main"],function(e){new e({el:t})}):require(["common/js/views/panels/custom/espanol/"+i.customPanel+"/main"],function(e){new e({el:t})}),r.customPanelDisclaimers(t),r.$(".nav-tabs, .explore-tabs, .pill-tab").parent().navIndicator()),r.absolutize(t)}),r.$allPanels.first().show(),a=r.$allPanels.length,r.model.set("max",a),e=r.$allPanels.outerWidth(),i=(a-1)*e===0?e:(a-1)*e,a>1&&r.options.pageTurner&&(r.pageTurner=new t({el:r.el,model:r.options.state})),r.$panelSet.css({width:i+"px",left:"-"+e+"px"})},absolutize:function(e){var t=this,i=t.$el.outerWidth();t.model.minMax&&(parseInt(i,10)<=t.model.minWidth&&(i=t.model.minWidth),parseInt(i,10)>=t.model.maxWidth&&(i=t.model.maxWidth)),t.model.set("width",i),e.css({width:i,position:"absolute",left:i})},next:function(){var e=this,t=e.model.get("currentPanel"),i=e.model.get("max"),a=e.model.get("width"),r=t+1;i===r&&(r=0),e.model.set({prev:t,next:r,position:2*a,move:"-"+2*a,currentPanel:r}),e.animate()},prev:function(){var e=this,t=e.model.get("currentPanel"),i=e.model.get("max"),a=t-1;-1===a&&(a=i-1),e.model.set({prev:t,next:a,position:0,move:0,currentPanel:a}),e.animate()},animate:function(){var e=this,t=e.model.get("width"),i=e.model.get("next"),a=e.model.get("prev"),r=e.model.get("position"),n=e.model.get("move");$panelSet=e.$panelSet,e.model.set("clickable",!1),$panelSet.children(":eq("+i+")").css({left:r,display:"block"}),$panelSet.animate({left:n},500,function(){$panelSet.css({left:"-"+t+"px"}),$panelSet.children(":eq("+i+")").css({left:t,zIndex:5}),$panelSet.children(":eq("+a+")").css({left:t,display:"none",zIndex:0}),e.model.set("clickable",!0)})},goToPanel:function(){var e=this;e.$allPanels.hide().eq(e.model.get("currentPanel")).fadeIn()},setAllowed:function(){p=!0},pause:function(){var e=this;e.model.playInterval&&(clearInterval(e.model.playInterval),delete e.model.playInterval,e.trigger("pause"))},play:function(){var e=this;!e.model.playInterval&&e.options.autoInterval&&(e.model.autoInterval=e.options.autoInterval,e.model.playInterval=setInterval(function(){e.model.setDirection("next")},e.model.autoInterval),e.trigger("play"))},togglePausePlay:function(e){this["mouseenter"===e.type?"pause":"play"]()},handleKeyStrokes:function(e){var t,i=this,a=e.keyName();if((i.$el.is(".active-section")||i.$el.parents("section").hasClass("active-section"))&&i.model.get("clickable")&&("left"==a||"right"==a)){if(1===i.model.get("max"))return;if(!i.model.get("infinite")){if(0===i.model.get("currentPanel")&&"left"===a&&"prev"===i.model.get("direction"))return;if(i.model.get("currentPanel")+1===i.model.get("max")&&"next"===i.model.get("direction")&&"right"==a&&"next"===i.model.get("direction"))return}i.model.playInterval&&(clearInterval(i.model.playInterval),i.model.playInterval=setInterval(function(){i.model.setDirection("next")},i.model.autoInterval)),t="left"==a?"prev":"next",i.model.setDirection(t),i.model.get("infinite")||(0===i.model.get("currentPanel")?i.$(".page-turn-prev").hide():i.$(".page-turn-prev").show(),i.model.get("currentPanel")+1===i.model.get("max")&&"next"===i.model.get("direction")?i.$(".page-turn-next").hide():i.$(".page-turn-next").show())}if(p){p=!1;var r=n(".active-section"),s=n(".wrapper header").height(),o=r.position().top-s;"j"===a&&r.next().is(".panel-container")?(o>u.scrollTop()?o=r.position().top:o===i.prevScrollPos&&(o=r.next().position().top-s),n("html, body").animate({scrollTop:o},800)):"k"===a&&r.prev().is(".panel-container")&&(o<u.scrollTop()?o=r.position().top:o==i.prevScrollPos&&(o=r.prev().position().top-s),n("html, body").animate({scrollTop:o},800)),i.prevScrollPos=o}},handleScroll:function(){var e,t=this,i=n(".active-section"),a=u.scrollTop(),r=u.height(),s=i.outerHeight(!0),o=i.position().top-a,l=o+s;a>t.currentScrollPos&&l<parseInt(r/2,10)?(e=i.next(),e.hasClass("panel-container")&&(i.removeClass("active-section"),e.addClass("active-section"))):a<t.currentScrollPos&&o>parseInt(r/2,10)&&(e=i.prev(),e.hasClass("panel-container")&&(i.removeClass("active-section"),e.addClass("active-section"))),t.currentScrollPos=a},onResize:function(){var e=this;clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){e.$allPanels.each(function(t){e.absolutize(n(this))}),e.panelSetAdjust()},100)},panelSetAdjust:function(){var e=this,t=e.model.get("width");e.$panelSet.css({left:"-"+t+"px",width:t}),e.$(".page-turner").css({width:t,"margin-left":"-"+t/2+"px"})},leftSwiper:function(e){console.log("swipe left"),this.swipe("left")},rightSwiper:function(e){console.log("swipe right"),this.swipe("right")},swipe:function(e){var t=this,i=t.model.get("infinite"),a=t.model.get("currentPanel"),r=t.model.get("max"),n=t.model.get("clickable");if(e="left"===e?"next":"prev",1!=r){if(t.model.playInterval&&(clearInterval(t.model.playInterval),t.model.playInterval=setInterval(function(){t.model.setDirection("next")},t.model.autoInterval)),"next"===e&&!i&&a+1===r)return;if("prev"===e&&!i&&0===a)return;n&&c&&t.model.setDirection(e)}},handleTabNavs:function(e){function t(){console.debug("end of the transition"),c.css("background-image","url("+o+")"),_.toggleClass("in")}var i=this,a=i.$(e.currentTarget),r=a.data(),o=r.background,l=n.support.transition,c=a.parents("section.panel"),d=a.parents(".nav-options"),u=c.find(".page-header"),p=a.parents(".page-content"),_=c.children(".panel-background"),h=r.navBackgroundClass?s.contains(r.navBackgroundClass.split(" "),"light"):void 0,f=r.headerBackgroundClass?s.contains(r.headerBackgroundClass.split(" "),"light"):void 0,g=r.textBackgroundClass?s.contains(r.textBackgroundClass.split(" "),"light"):void 0;a.hasClass("current-tab")||(o&&(l?(console.log(n.support.transition.end),_.one(n.support.transition.end,t),console.log(_),console.log("css transition"),_.css({"background-image":"url("+o+")"}),_.toggleClass("in")):(console.log("dom animated"),_.css({"background-image":"url("+o+")",display:"none"}).stop(!0,!0).fadeIn({complete:function(e){end()},duration:333,queue:!0})),i.$(".current-tab").removeClass("current-tab"),a.addClass("current-tab")),void 0!==h&&(h?d.removeClass("dark").addClass("light"):d.removeClass("light").addClass("dark")),void 0!==f&&(f?u.removeClass("dark").addClass("light"):u.removeClass("light").addClass("dark")),void 0!==g&&(g?p.removeClass("dark").addClass("light"):p.removeClass("light").addClass("dark")))},customPanelDisclaimers:function(e){var t=e.html(),i=e.attr("data-custom-disclaimer");s.each(i.split(","),function(e){var i=e.replace(/[\[\]']+/g,""),a=i.split(":")[0],r=i.split(":")[1],n=new RegExp("data-disclaimer=&quot;"+a+"&quot;>(.*?)</a>","g"),s=new RegExp("data-disclaimer=&quot;"+a+"&quot;&gt;(.*?)&lt;/a&gt;","g"),o=new RegExp('data-disclaimer="'+a+'"(.*?)</a>',"g");t=t.replace(n,"data-disclaimer=&quot;"+r+"&quot;><sup>"+r+"</sup></a>"),t=t.replace(s,"data-disclaimer=&quot;"+r+"&quot;><sup>"+r+"</sup></a>"),t=t.replace(o,"data-disclaimer="+r+"><sup>"+r+"</sup></a>")}),e.html(t)}});return f}),define("app/jst/rit/local-specials/apr-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<li><div class="offer apr-offer" data-type="apr" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-rate="'+(null==(__t=rate)?"":__t)+'" data-term="'+(null==(__t=term)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=modelYr)?"":__t)+'"><div class="ribbon"></div><div class="offer-header"><div class="apr-offer-label">Finance a <span class="model-year">'+(null==(__t=modelYr)?"":__t)+'</span></div><div class="apr-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="label-trim-name">'+(null==(__t=trimName)?"":__t)+'</div><div class="apr-rate"><span>'+(null==(__t=rate)?"":__t)+"<sup>%</sup>APR</span>for<span>"+(null==(__t=term)?"":__t)+"</span>months</div>",0!==additionalCash&&(__p+='<div class="cashback-rate"><span>+ <strong><sup>$</sup>'+(null==(__t=additionalCash)?"":__t)+"</strong></span>cash</div>"),__p+='</div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny apr" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#"><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/apr-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj){if(__p+='<div class="offer-details-container apr-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="apr-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional APR Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(e){var t=bltsData[e].text,i=bltsData[e].link;_.isEmpty(t)||(__p+=_.isEmpty(i)?"<li>"+(null==(__t=t)?"":__t)+"</li>":'<li><a href="'+(null==(__t=i)?"":__t)+'" target="_blank">'+(null==(__t=t)?"":__t)+"</a></li>")}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-series="'+(null==(__t=seriesList.series.name)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>';else if(void 0!=region&&_.isEqual(region,"SET10"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/build?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>');else if(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)?__p+="<!-- blank on purpose -->":(__p+='<a class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),!_.isEqual(applicableModelYear,"2012")){if("2014.5"==applicableModelYear){applicableModelYear="2014";var year="2014.5"}__p+='<a class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>',"2014.5"==year&&(applicableModelYear=year)}__p+='<a href="#" class="btn btn-gray large print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-print"></i></a><a class="btn apr-print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="#"><span>Print Offer</span></a><div class="email-offer"><a class="apr-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="apr-email-label">Email Offer</span></a></div>';var expDate=new Date(endDate);Date.UTC(expDate.getFullYear(),expDate.getMonth(),expDate.getDate());__p+='<div class="tcom-exact-target" data-type="localspecials" data-cta-title="Email Offer" data-title="Email Local Special" data-callout="Send an email with this Local Special" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-trim-name="'+(null==(__t=trimName)?"":__t)+'" data-zip-code="'+(null==(__t=zipCode)?"":__t)+'" data-vin="" data-offer-type="Regional APR Offer" data-incentive-type="'+(null==(__t=incentiveType)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-confirmation="An email with the details of this offer has been sent to:" data-error-details="Email services are down, please Print Offer or try again later." data-tda-code="'+(null==(__t=tdaCode)?"":__t)+'" data-featured="'+(null==(__t=featured)?"":__t)+'" data-tile-pos="'+(null==(__t=tilePos)?"":__t)+'" data-offer-description="'+(null==(__t=offerDescription)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-multivehicle-flag="'+(null==(__t=isMultipleVehicle)?"":__t)+'"></div></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers&&" "!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>"}return __p}}),define("app/jst/rit/local-specials/cashback-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+='<li><div class="offer cashback-offer" data-type="cash" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-cashback="'+(null==(__t=cashBack)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="offer-header"><div class="cashback-offer-label">Cash back on a<span class="model-year">'+(null==(__t=applicableModelYear)?"":__t)+'</span></div><div class="cashback-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="label-trim-name">'+(null==(__t=trimName)?"":__t)+'</div><div class="cashback-rate"><span><sup>&#36;</sup>'+(null==(__t=cashBack)?"":__t)+'</span>Cash Back</div></div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny cashback" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/cashback-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj){if(__p+='<div class="offer-details-container cashback-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="cashback-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional Cash Back Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(e){var t=bltsData[e].text,i=bltsData[e].link;_.isEmpty(t)||(__p+=_.isEmpty(i)?"<li>"+(null==(__t=t)?"":__t)+"</li>":'<li><a href="'+(null==(__t=i)?"":__t)+'" target="_blank">'+(null==(__t=t)?"":__t)+"</a></li>")}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-series="'+(null==(__t=seriesList.series.name)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>';else if(void 0!=region&&_.isEqual(region,"SET10"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/build?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>');else if(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)||(__p+='<a class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),!_.isEqual(applicableModelYear,"2012")){if("2014.5"==applicableModelYear){applicableModelYear="2014";var year="2014.5"}__p+='<a class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>',"2014.5"==year&&(applicableModelYear=year)}__p+='<a href="#" class="btn btn-gray large print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-print"></i></a><a class="btn cashback-print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="#"><span>Print Offer</span></a><div class="email-offer"><a class="cashback-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="cashback-email-label">Email Offer</span></a></div>';var expDate=new Date(endDate);Date.UTC(expDate.getFullYear(),expDate.getMonth(),expDate.getDate());__p+='<div class="tcom-exact-target" data-type="localspecials" data-title="Email Local Special" data-cta-title="Email Offer" data-callout="Send an email with this Local Special" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-trim-name="'+(null==(__t=trimName)?"":__t)+'" data-zip-code="'+(null==(__t=zipCode)?"":__t)+'" data-vin="" data-offer-type="Regional Cash Back Offer" data-incentive-type="'+(null==(__t=incentiveType)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-confirmation="An email with the details of this offer has been sent to:" data-error-details="Email services are down, please Print Offer or try again later." data-tda-code="'+(null==(__t=tdaCode)?"":__t)+'" data-featured="'+(null==(__t=featured)?"":__t)+'" data-tile-pos="'+(null==(__t=tilePos)?"":__t)+'" data-offer-description="'+(null==(__t=offerDescription)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-multivehicle-flag="'+(null==(__t=isMultipleVehicle)?"":__t)+'"></div></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers&&" "!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>"}return __p}}),define("app/jst/rit/local-specials/lease-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<li><div class="offer lease-offer" data-type="lease" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-monthly="'+(null==(__t=leaseMonthlyPayment)?"":__t)+'" data-term="'+(null==(__t=leaseTerm)?"":__t)+'" data-due="'+(null==(__t=leaseDueAtSigning)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="ribbon"></div><div class="offer-header"><div class="lease-offer-label">Lease a<span class="model-year">'+(null==(__t=applicableModelYear)?"":__t)+'</span></div><div class="lease-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="label-trim-name">'+(null==(__t=trimName)?"":__t)+'</div><div class="lease-rate"><span><sup>&#36;</sup>'+(null==(__t=leaseMonthlyPayment)?"":__t)+"</span>per month for<span>"+(null==(__t=leaseTerm)?"":__t)+'</span>months</div><div class="lease-due-signing"><span><sup>&#36;</sup>'+(null==(__t=leaseDueAtSigning)?"":__t)+"</span>due at signing</div>",0!==additionalCash&&void 0!==additionalCash&&(__p+='<div class="cashback-rate"><span>+ <strong><sup>$</sup>'+(null==(__t=additionalCash)?"":__t)+"</strong></span>cash</div>"),__p+='</div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny lease" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/lease-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj){if(__p+='<div class="offer-details-container lease-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="lease-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional Lease Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(e){var t=bltsData[e].text,i=bltsData[e].link;_.isEmpty(t)||(__p+=_.isEmpty(i)?"<li>"+(null==(__t=t)?"":__t)+"</li>":'<li><a href="'+(null==(__t=i)?"":__t)+'" target="_blank">'+(null==(__t=t)?"":__t)+"</a></li>")}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-series="'+(null==(__t=seriesList.series.name)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>';else if(void 0!=region&&_.isEqual(region,"SET10"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/build?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>');else if(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)||(__p+='<a class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),!_.isEqual(applicableModelYear,"2012")){if("2014.5"==applicableModelYear){applicableModelYear="2014";var year="2014.5"}__p+='<a class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>',
"2014.5"==year&&(applicableModelYear=year)}__p+='<a href="#" class="btn btn-gray large print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-print"></i></a><a class="btn lease-print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="#."><span>Print Offer</span></a><div class="email-offer"><a id="emailBtn" class="lease-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="lease-email-label">Email Offer</span></a></div>';var expDate=new Date(endDate);Date.UTC(expDate.getFullYear(),expDate.getMonth(),expDate.getDate());__p+='<div class="tcom-exact-target" data-type="localspecials" data-title="Email Local Special" data-cta-title="Email Offer" data-callout="Send an email with this Local Special" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-trim-name="'+(null==(__t=trimName)?"":__t)+'" data-zip-code="'+(null==(__t=zipCode)?"":__t)+'" data-vin="" data-offer-type="Regional Lease Offer" data-incentive-type="'+(null==(__t=incentiveType)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-confirmation="An email with the details of this offer has been sent to:" data-error-details="Email services are down, please Print Offer or try again later." data-tda-code="'+(null==(__t=tdaCode)?"":__t)+'" data-featured="'+(null==(__t=featured)?"":__t)+'" data-tile-pos="'+(null==(__t=tilePos)?"":__t)+'" data-offer-description="'+(null==(__t=offerDescription)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-multivehicle-flag="'+(null==(__t=isMultipleVehicle)?"":__t)+'"></div></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers&&" "!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p> ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>"}return __p}}),define("app/jst/rit/local-specials/espanol/apr-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<li><div class="offer apr-offer" data-type="apr" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-rate="'+(null==(__t=rate)?"":__t)+'" data-term="'+(null==(__t=term)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=modelYr)?"":__t)+'"><div class="ribbon"></div><div class="offer-header"><div class="apr-offer-label">Finance a '+(null==(__t=modelYr)?"":__t)+'</div><div class="apr-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="apr-rate"><span>'+(null==(__t=rate)?"":__t)+"<sup>%</sup>APR</span>for<span>"+(null==(__t=term)?"":__t)+"</span>months</div>",0!==additionalCash&&(__p+='<div class="cashback-rate"><span>+ <strong><sup>$</sup>'+(null==(__t=additionalCash)?"":__t)+"</strong></span>cash</div>"),__p+='</div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny apr" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#"><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/espanol/apr-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<div class="offer-details-container apr-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="apr-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional APR Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(e){var t=bltsData[e].text,i=bltsData[e].link;if(!_.isEmpty(t)){var a=t.match(/\s/);if(!a||!a.length)try{t=unescape(decodeURIComponent(t.replace(/\+/g," ")))}catch(r){}if(_.isEmpty(i))__p+="<li>"+(null==(__t=t)?"":__t)+"</li>";else{try{i=unescape(decodeURIComponent(bltsData[e].link.replace(/\+/g," ")))}catch(r){}__p+='<li><a href="'+(null==(__t=i)?"":__t)+'" target="_blank">'+(null==(__t=t)?"":__t)+"</a></li>"}}}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST")?__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>':void 0!=region&&_.isEqual(region,"SET10")?(__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/construye?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')):(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)||(__p+='<a class="btn btn-pill buildYours" href="/espanol/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),_.isEqual(applicableModelYear,"2012")||(__p+='<a class="btn btn-pill searchInventory" href="/espanol/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')),__p+='<div class="email-offer"><a class="apr-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="apr-email-label">Email Offer</span></a></div><a href="#" class="btn btn-gray large print"><i class="icon-print"></i></a><a class="btn apr-print" href="#"><span>Print Offer</span></a></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>";return __p}}),define("app/jst/rit/local-specials/espanol/cashback-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+='<li><div class="offer cashback-offer" data-type="cash" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-cashback="'+(null==(__t=cashBack)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'"  data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="offer-header"><div class="cashback-offer-label">Cash Back on a<span class="model-year">'+(null==(__t=applicableModelYear)?"":__t)+'</span></div><div class="cashback-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="cashback-rate"><span><sup>&#36;</sup>'+(null==(__t=cashBack)?"":__t)+'</span>Cash Back</div></div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny cashback" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/espanol/cashback-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<div class="offer-details-container cashback-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="cashback-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional Cash Back Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(e){var t=bltsData[e].text,i=bltsData[e].link;if(!_.isEmpty(t)){var a=t.match(/\s/);if(!a||!a.length)try{t=unescape(decodeURIComponent(t.replace(/\+/g," ")))}catch(r){}if(_.isEmpty(i))__p+="<li>"+(null==(__t=t)?"":__t)+"</li>";else{try{i=unescape(decodeURIComponent(bltsData[e].link.replace(/\+/g," ")))}catch(r){}__p+='<li><a href="'+(null==(__t=i)?"":__t)+'" target="_blank">'+(null==(__t=t)?"":__t)+"</a></li>"}}}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><i class="icon-arrow-right-medium raq" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST")?__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>':void 0!=region&&_.isEqual(region,"SET10")?(__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/construye?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')):(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)||(__p+='<a class="btn btn-pill buildYours" href="/espanol/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),_.isEqual(applicableModelYear,"2012")||(__p+='<a class="btn btn-pill searchInventory" href="/espanol/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')),__p+='<div class="email-offer"><a class="cashback-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="cashback-email-label">Email Offer</span></a></div><a href="#" class="btn btn-gray large print"><i class="icon-print"></i></a><a class="btn cashback-print" href="#"><span>Print Offer</span></a></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>";return __p}}),define("app/jst/rit/local-specials/espanol/lease-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<li><div class="offer lease-offer" data-type="lease" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-monthly="'+(null==(__t=leaseMonthlyPayment)?"":__t)+'" data-term="'+(null==(__t=leaseTerm)?"":__t)+'" data-due="'+(null==(__t=leaseDueAtSigning)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'"  data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="ribbon"></div><div class="offer-header"><div class="lease-offer-label">Lease a<span class="model-year">'+(null==(__t=applicableModelYear)?"":__t)+'</span></div><div class="lease-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="lease-rate"><span><sup>&#36;</sup>'+(null==(__t=leaseMonthlyPayment)?"":__t)+"</span>per month for<span>"+(null==(__t=leaseTerm)?"":__t)+'</span>months</div><div class="lease-due-signing"><span><sup>&#36;</sup>'+(null==(__t=leaseDueAtSigning)?"":__t)+"</span>due at signing</div>",0!==additionalCash&&(__p+='<div class="cashback-rate"><span>+ <strong><sup>$</sup>'+(null==(__t=additionalCash)?"":__t)+"</strong></span>cash</div>"),__p+='</div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny lease" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/espanol/lease-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<div class="offer-details-container lease-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="lease-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional Lease Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(e){var t=bltsData[e].text,i=bltsData[e].link;if(!_.isEmpty(t)){var a=t.match(/\s/);if(!a||!a.length)try{t=unescape(decodeURIComponent(t.replace(/\+/g," ")))}catch(r){}if(_.isEmpty(i))__p+="<li>"+(null==(__t=t)?"":__t)+"</li>";else{try{i=unescape(decodeURIComponent(bltsData[e].link.replace(/\+/g," ")))}catch(r){}__p+='<li><a href="'+(null==(__t=i)?"":__t)+'" target="_blank">'+(null==(__t=t)?"":__t)+"</a></li>"}}}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST")?__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>':void 0!=region&&_.isEqual(region,"SET10")?(__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/construye?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')):(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)||(__p+='<a class="btn btn-pill buildYours" href="/espanol/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),_.isEqual(applicableModelYear,"2012")||(__p+='<a class="btn btn-pill searchInventory" href="/espanol/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')),__p+='<div class="email-offer"><a id="emailBtn" class="lease-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="lease-email-label">Email Offer</span></a></div><a href="#" class="btn btn-gray large print"><i class="icon-print"></i></a><a class="btn lease-print" href="#."><span>Print Offer</span></a></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>";return __p}}),define("app/jst/rit/local-specials/other-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+='<li><div class="offer newother-offer" data-type="miscellaneous" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="offer-header"><div class="other-offer-label">Other</div><div class="cashback-series-name">Offers</div><div class=\'other-text\'><p>See additional offers</p><p>available in your area</p></div></div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny newother" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View All</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/other-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj){__p+='<div class="offer-details-container newother-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="newother-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Other Regional Offers</h2></div>';var offers=offerObj;_.each(offers,function(e,t,i){if(__p+="<div data-model='"+(null==(__t=e.seriesName)?"":__t)+"' data-year='"+(null==(__t=e.applicableModelYear)?"":__t)+'\' class="offer-details-wrapper"><div class="details"><div class="text"><p class="heading">'+(null==(__t=e.description)?"":__t)+"<sub>Ends "+(null==(__t=e.endDate)?"":__t)+' </sub></p></div><div class="bullets"><ul>',_(e.bltsData.length).times(function(t){var i=e.bltsData[t].text,a=e.bltsData[t].link;if(!_.isEmpty(i))if(_.isEmpty(a))__p+="<li>"+(null==(__t=i)?"":__t)+"</li>";else{var r=a.replace(/.*href=[ "']*([^ "']+)[ "'\/>]+.*/,"$1");__p+='<li><a href="'+(null==(__t=r)?"":__t)+'" target="_blank">'+(null==(__t=i)?"":__t)+"</a></li>"}}),__p+='</ul></div></div><div class="offer-buttons"><!--RAQ button --><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=e.modelCode)?"":__t)+'" data-series-name="'+(null==(__t=e.seriesName)?"":__t)+'" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-model-year="'+(null==(__t=e.applicableModelYear)?"":__t)+'" data-series="'+(null==(__t=e.seriesList.series.name)?"":__t)+'" data-vehicle="'+(null==(__t=e.vehicleName)?"":__t)+'" data-type="'+(null==(__t=e.offerType)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Contact Dealer</span></a>',void 0!=e.region&&_.isEqual(e.region,"GST"))__p+='<!-- Build Button --><a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-type="'+(null==(__t=e.offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=e.gstMap.style)?"":__t)+"&model="+(null==(__t=e.gstMap.model)?"":__t)+"&zip="+(null==(__t=e.zipCodeSET)?"":__t)+'&Siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><!-- Search Inventory --><a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-type="'+(null==(__t=e.offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=e.gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=e.zipCodeSET)?"":__t)+'&Siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>';else if(void 0!=e.region&&_.isEqual(e.region,"SET10"))__p+='<!-- Build Button --><a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-type="'+(null==(__t=e.offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=e.setRegionModelCode)?"":__t)+"/build?originating_zip_code="+(null==(__t=e.zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(e.applicableModelYear,"2012")||(__p+='<!-- Search Inventory --><a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-type="'+(null==(__t=e.offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=e.setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=e.zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>');else if(/priusplugin/.test(e.queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-type="'+(null==(__t=e.offerType)?"":__t)+'" href="'+(null==(__t=e.configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(e.queryname)?__p+="<!-- blank on purpose -->":(__p+='<a class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-type="'+(null==(__t=e.offerType)?"":__t)+'" href="/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(e.queryname)?null==(__t=e.configMapping)?"":__t:null==(__t=e.modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),!_.isEqual(e.applicableModelYear,"2012")){if("2014.5"==e.applicableModelYear){e.applicableModelYear="2014";var a="2014.5"}__p+='<a class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-type="'+(null==(__t=e.offerType)?"":__t)+'" href="/search-inventory/#!/results/'+(null==(__t=e.applicableModelYear)?"":__t)+"/"+(null==(__t=e.queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>',"2014.5"==a&&(e.applicableModelYear=a)}__p+='<a href="#" class="btn btn-gray large print" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-type="'+(null==(__t=e.offerType)?"":__t)+'"><i class="icon-print"></i></a><a class="btn newother-print" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-type="'+(null==(__t=e.offerType)?"":__t)+'" href="#"><span>Print Offer</span></a><div class="tcom-exact-target" data-type="localspecials" data-title="Email Local Special" data-cta-title="Email Offer" data-callout="Send an email with this Local Special" data-series-name="'+(null==(__t=e.seriesName)?"":__t)+'" data-zip-code="'+(null==(__t=e.zipcode)?"":__t)+'" data-vin="" data-offer-type="Other Regional Offers" data-incentive-type="'+(null==(__t=e.incentiveType)?"":__t)+'" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-confirmation="An email with the details of this offer has been sent to:" data-error-details="Email services are down, please Print Offer or try again later." data-tda-code="'+(null==(__t=tagDetails.tdaCode)?"":__t)+'" data-featured="'+(null==(__t=tagDetails.offerFeatured)?"":__t)+'" data-tile-pos="'+(null==(__t=tagDetails.tilePos)?"":__t)+'" data-offer-description="'+(null==(__t=tagDetails.offerDescription)?"":__t)+'" data-model-year="'+(null==(__t=e.applicableModelYear)?"":__t)+'" data-multivehicle-flag="'+(null==(__t=e.isMultipleVehicle)?"":__t)+'"></div></div><div class="disclaimer-dtls">',__p+=e.disclaimers.disclaimer.length>1||""!==e.additionalDisclaimers&&" "!==e.additionalDisclaimers||""!==e.additionalRestrictions&&" "!==e.additionalRestrictions?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=e.disclaimers.disclaimer)?"":__t)+"</p><p>"+(null==(__t=e.additionalDisclaimers)?"":__t)+"</p><p>"+(null==(__t=e.additionalRestrictions)?"":__t)+"</p></div></div>"}),__p+="</div>"}return __p}}),define("app/jst/rit/local-specials/espanol/other-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+='<li><div class="offer newother-offer" data-type="miscellaneous" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="offer-header"><div class="other-offer-label">Other</div><div class="cashback-series-name">Offers</div><div class=\'other-text\'><p>See additional offers</p><p>available in your area</p></div></div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny newother" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View All</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/espanol/other-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj){__p+='<div class="offer-details-container newother-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="newother-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Other Regional Offers</h2></div>';var offers=offerObj;_.each(offers,function(e,t,i){__p+='<div class="offer-details-wrapper"><div class="details"><div class="text"><p class="heading">'+(null==(__t=e.description)?"":__t)+"<sub>Ends "+(null==(__t=e.endDate)?"":__t)+' </sub></p></div><div class="bullets"><ul>',_(e.bltsData.length).times(function(t){var i=e.bltsData[t].text,a=e.bltsData[t].link;if(!_.isEmpty(i))if(_.isEmpty(a))__p+="<li>"+(null==(__t=i)?"":__t)+"</li>";else{var r=a.replace(/.*href=[ "']*([^ "']+)[ "'\/>]+.*/,"$1");_.isEqual(e.language,"espanol")&&-1!=r.search("toyota-care")&&(r=r.split("toyota-care")[0]+"espanol/toyota-care/"),__p+='<li data-><a href="'+(null==(__t=r)?"":__t)+'" target="_blank">'+(null==(__t=i)?"":__t)+"</a></li>"}}),__p+='</ul></div></div><div class="offer-buttons"><!--RAQ button --><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=e.modelCode)?"":__t)+'" data-incentive-id="'+(null==(__t=e.incentiveId)?"":__t)+'" data-vehicle="'+(null==(__t=e.vehicleName)?"":__t)+'" data-model-year="'+(null==(__t=e.applicableModelYear)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Contact Dealer</span></a>',void 0!=e.region&&_.isEqual(e.region,"GST")?__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=e.gstMap.style)?"":__t)+"&model="+(null==(__t=e.gstMap.model)?"":__t)+"&zip="+(null==(__t=e.zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=e.gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=e.zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>':void 0!=e.region&&_.isEqual(e.region,"SET10")?(__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://comprauntoyota.com/'+(null==(__t=e.setRegionModelCode)?"":__t)+"/construye?originating_zip_code="+(null==(__t=e.zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(e.applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" href="http://comprauntoyota.com/'+(null==(__t=e.setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=e.zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')):(/priusplugin/.test(e.queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" href="'+(null==(__t=e.configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(e.queryname)||(__p+='<a class="btn btn-pill buildYours" href="/espanol/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(e.queryname)?null==(__t=e.configMapping)?"":__t:null==(__t=e.modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),_.isEqual(e.applicableModelYear,"2012")||(__p+='<a class="btn btn-pill searchInventory" href="/espanol/search-inventory/#!/results/'+(null==(__t=e.applicableModelYear)?"":__t)+"/"+(null==(__t=e.queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')),__p+='<!-- <div class="email-offer"><a class="newother-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="newother-email-label">Email Offer</span></a></div> --><a href="#" class="btn btn-gray large print"><i class="icon-print"></i></a><a class="btn newother-print" href="#"><span>Print Offer</span></a></div><div class="disclaimer-dtls">',
__p+=e.disclaimers.disclaimer.length>1||""!==e.additionalDisclaimers||""!==e.additionalRestrictions?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=e.disclaimers.disclaimer)?"":__t)+"</p><p>"+(null==(__t=e.additionalDisclaimers)?"":__t)+"</p><p>"+(null==(__t=e.additionalRestrictions)?"":__t)+"</p></div></div>"}),__p+="</div>"}return __p}}),define("ritLocalSpecialsConfig",["sit"],function(e){var t=(e.$,e._,e.Backbone,{Avalon:"avalon",Camry:"camry",Yaris:"yaris",Corolla:"corolla",Sienna:"sienna",Prius:"prius","Prius c":"priusc","Prius 3rd Gen":"prius","Prius Plug In":"prius-plug-in","Prius Plug-in":"prius-plug-in","Prius v":"priusv","Avalon Hybrid":"avalon","Camry Hybrid":"camry","Highlander Hybrid":"highlander",RAV4:"rav4",Venza:"venza",Highlander:"highlander","4Runner":"4runner",Sequoia:"sequoia","Land Cruiser":"landcruiser",Tacoma:"tacoma",Tundra:"tundra"}),i={avalon:"Avalon",avalonhybrid:"AvalonHybrid",camry:"Camry",camryhybrid:"CamryHybrid",yaris:"Yaris",corolla:"Corolla",sienna:"Sienna",prius:"Prius",priusc:"Priusc",priusplugin:"PriusPlugIn",priusv:"Priusv","4runner":"4Runner",highlander:"Highlander",highlanderhybrid:"HighlanderHybrid",landcruiser:"LandCruiser",rav4:"RAV4",sequoia:"Sequoia",venza:"Venza",tacoma:"Tacoma",tundra:"Tundra"},a={Avalon:"avalon",Camry:"camry",Yaris:"yaris",Corolla:"corolla",Sienna:"sienna",Prius:"prius","Prius c":"prius-c","Prius C":"prius-c","Prius 3rd Gen":"prius","Prius Plug In":"prius-plug-in","Prius Plug-In":"prius-plug-in","Prius v":"prius-v","Prius V":"prius-v","Avalon Hybrid":"avalon-hybrid","Camry Hybrid":"camry-hybrid","Highlander Hybrid":"highlander-hybrid",RAV4:"rav4",Venza:"venza",Highlander:"highlander","4Runner":"4runner",Sequoia:"sequoia","Land Cruiser":"land-cruiser",Tacoma:"tacoma",Tundra:"tundra"},r={en:{"Cars & Minivan":["Avalon","Camry","Corolla","Sienna","Yaris"],"Hybrids & EVs":["Avalon Hybrid","Camry Hybrid","Highlander Hybrid","Prius","Prius c","Prius Plug In","Prius v"],"Crossovers & SUVs":["4Runner","Highlander","Land Cruiser","RAV4","Sequoia","Venza"],Trucks:["Tacoma","Tundra"]},es:{"Autos y Minivan":["Avalon","Camry","Corolla","Sienna","Yaris"],"Híbridos y EVs":["Avalon Hybrid","Camry Hybrid","Highlander Hybrid","Prius","Prius c","Prius Plug In","Prius v"],"Crossovers y SUV":["4Runner","Highlander","Land Cruiser","RAV4","Sequoia","Venza"],Camionetas:["Tacoma","Tundra"]}},n={"4runner":"Crossovers|4Runner",avalon:"Cars|Avalon",camry:"Cars|Camry",corolla:"Cars|Corolla",highlander:"Crossovers|Highlander",landcruiser:"Crossovers|Land Cruiser",prius:"Hybrids-EVs|Prius",rav4:"Crossovers|RAV4",sequoia:"Crossovers|Sequoia",sienna:"Cars|Sienna",tacoma:"Trucks|Tacoma",tundra:"Trucks|Tundra",yaris:"Cars|Yaris",venza:"Crossovers|Venza",priusc:"Hybrids-EVs|Prius <em>c</em>",priusv:"Hybrids-EVs|Prius <em>v</em>",camryhybrid:"Hybrids-EVs|Camry Hybrid",avalonhybrid:"Hybrids-EVs|Avalon Hybrid",highlanderhybrid:"Hybrids-EVs|Highlander Hybrid"};return{getModelCodes:function(){return t},getSeriesCodes:function(){return i},getSetRegionModelCodes:function(){return a},getVehicleCategories:function(){return r},getGstMappings:function(){return n}}}),define("ritLocalSpecialR2",["sit","ritLocalSpecialIncentivesModel","ritPanelSet","ritBootstrapPopover","app/jst/rit/local-specials/apr-offer","app/jst/rit/local-specials/apr-offer-details","app/jst/rit/local-specials/cashback-offer","app/jst/rit/local-specials/cashback-offer-details","app/jst/rit/local-specials/lease-offer","app/jst/rit/local-specials/lease-offer-details","app/jst/rit/local-specials/espanol/apr-offer","app/jst/rit/local-specials/espanol/apr-offer-details","app/jst/rit/local-specials/espanol/cashback-offer","app/jst/rit/local-specials/espanol/cashback-offer-details","app/jst/rit/local-specials/espanol/lease-offer","app/jst/rit/local-specials/espanol/lease-offer-details","app/jst/rit/local-specials/other-offer","app/jst/rit/local-specials/other-offer-details","app/jst/rit/local-specials/espanol/other-offer","app/jst/rit/local-specials/espanol/other-offer-details","ritLocalSpecialsConfig"],function(e,t,a,r,n,s,o,l,c,d,u,p,_,h,f,g,m,v,y,b,w){var C,k=e.$,S=e._,I=(e.Backbone,e.Events),T=e.touchsite,P=e.i18n,x=e.Geolocation,A={Avalon:"avalon",Camry:"camry",Yaris:"yaris",Matrix:"matrix",Corolla:"corolla",Sienna:"sienna",Prius:"prius","Prius c":"priusc","Prius 3rd Gen":"prius","Prius Plug In":"prius-plug-in","Prius Plug-in":"prius-plug-in","Prius v":"priusv","Avalon Hybrid":"avalon","Camry Hybrid":"camry","Highlander Hybrid":"highlander",RAV4EV:"rav4ev",RAV4:"rav4","FJ Cruiser":"fjcruiser",Venza:"venza",Highlander:"highlander","4Runner":"4runner",Sequoia:"sequoia","Land Cruiser":"landcruiser",Tacoma:"tacoma",Tundra:"tundra"},D={"click .offer":"renderOfferType","click .offer-close":"closeOfferDetailsSection","click .apr-print, .lease-print, .cashback-print, .print, .newother-print":"printOffer","click .offers-nav a":"cleanUp","click .page-indicator2 li":"cleanUp","touchstart .offer":"renderOfferType","touchstart .offer-close":"closeOfferDetailsSection","touchstart .apr-print, .lease-print, .cashback-print, .newother-print, .print":"printOffer","touchstart .page-indicator2 li":"cleanUp"},M=a.extend({events:D,initialize:function(){var e=this;console.log("localspecials common init"),x.getZip().done(function(e){C=e}),defaults={year:null},e.panelEl=e.$(".panel-container"),e.options=S.extend(defaults,e.options),e.model=new t({modelName:e.options.seriesName,modelYear:e.options.year}),e.model.on("change:filteredData",e.build,this),e.cleanUp()},render:function(){},cleanUp:function(){var e=this;e.$(".offer-details-container").slideUp("slow",function(){k(".offer-details-container").remove(),k(".local-indicator").hide(),e.removePrevOfferStyles(e.$(".offer a.show-dtls"))})},printOffer:function(e){e.preventDefault();var t=k(e.currentTarget).closest(".offer-details-wrapper");k("body").addClass("local-specials-print-override"),t&&t.length>0&&(k(".offer-details-wrapper").removeClass("print-wrapper"),t.addClass("print-wrapper")),setTimeout(function(){window.print(),setTimeout(function(){k("body").removeClass("local-specials-print-override")},500)},500)},build:function(){var e,t,i=this,r=""+i.options.year,s="",l=[],d=i.$(".panel-set").first(),u="",p="",_="",h="",f={APR:n,Cash:o,Lease:c,Miscellaneous:m},g={},v=0,y=i.model.get("vehicleIncentives");i.model.get("vehicleIncentives").length<4&&i.$(".panel-set").css("z-index",5),S.each(y,function(a,n){if(e=S.isArray(a.seriesList.series)?a.currentFilterYear:a.seriesList.series.year,!i.options.year||S.isEqual(e,r)||S.isEqual(e,""+Math.floor(r)))if(t=a.offerType,"Miscellaneous"!==t){switch(g={id:a.offerId,seriesName:a.seriesList.series.name,modelYr:a.seriesList.series.year,applicableModelYear:a.seriesList.series.year,"self.collectionIndex":n,description:a.description,incentiveId:a.offerId,trimName:a.trimName,zipcode:""},t){case"APR":u=a.apr.tiers.tier[0].term[0],_={term:u.duration,rate:u.rate,additionalCash:u.extraCashAmount},S.extend(g,_);break;case"Lease":p=a.lease.tiers.tier[0].term[0],_={leaseMonthlyPayment:p.monthlyPayment,leaseTerm:p.duration,due:(""+p.dueAtSigningAmount).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),leaseDueAtSigning:(""+p.dueAtSigningAmount).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),additionalCash:p.extraCashAmount},S.extend(g,_);break;case"Cash":_={cashBack:(""+a.cash.cashAmount).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},S.extend(g,_)}h=f[t](g),l.push(h)}else 1>v&&(h=f[t]({seriesName:a.currentFilterName,applicableModelYear:a.currentFilterYear,incentiveType:t,incentiveId:a.offerId}),l.push(h),v++)}),s+=i.generateSliderMarkup(l),0===l.length&&i.$el.hide(),d.empty().append(s),i.$(".panel-set").eq(0).attr("style",""),l.length>3?(i.panelEl.find(".panel").css("zIndex",0),i.panelEl.find(".panel").eq(0).css("zIndex",5),panel=new a({el:i.panelEl,pageIndicator:!0,pageTurner:!0,buttonSize:"offers-nav",state:this.model,infinite:!1,minWidth:950,maxWidth:950,enableResize:!1}),T?panel.on("panelchange:before",function(){i.cleanUp()}):panel.on("swipe:before",function(){i.cleanUp()}),i.$(".panel-set").eq(0).removeClass("singlePanel")):(i.$(".offers-turn-next").hide(),i.$(".offers-turn-prev").hide(),i.$(".panel-set").eq(0).css("zIndex",5).addClass("singlePanel")),I.trigger("localspecials:ready")},generateSliderMarkup:function(e){var t="";for(i=0;i<e.length;i+=3)t+='<section class="panel">',t+="<ul>",t+=e[i],e.length>i+1&&(t+=e[i+1]),e.length>i+2&&(t+=e[i+2]),t+="</ul>",t+="</section>";return t},renderOfferType:function(e){var t,i,a,r,n,o=this,c=o.$(e.currentTarget).find(".offer-details a"),u=o.$(e.currentTarget).find(".offer-details a").attr("class").split(" ")[3],_={},f="Hide Details",m="View Details",y=[];if(e.preventDefault(),i=o.$(".offer-details-container"),a=o.$el.find(".offer a.show-dtls"),S.isEqual(a.attr("id"),c.attr("id"))||o.removePrevOfferStyles(a),c.toggleClass("show-dtls"),c.find(".icon-arrow-down-tiny").toggleClass("icon-arrow-up-tiny"),c.hasClass("show-dtls")){switch(i.slideUp("slow",function(){i.remove()}),S.each(o.model.get("vehicleIncentives"),function(e){"Miscellaneous"==e.offerType?(n={applicableModelYear:e.currentFilterYear,seriesName:e.currentFilterName,queryname:e.currentFilterId,vehicleName:e.currentFilterName,incentiveType:e.offerType,incentiveId:e.offerId,offertype:e.offerType,disclaimer:e.disclaimers.disclaimer},S.extend(e,n),y.push(o.updateOfferProperties(e))):(t="APR"===u.toUpperCase()?c.attr("id").split("-")[0]:c.attr("id"),e.offerId.toString()===t.toString()&&(n={applicableModelYear:e.seriesList.series.year,seriesName:e.seriesList.series.id,queryname:e.seriesList.series.id,vehicleName:e.seriesList.series.name,incentiveType:e.offerType,incentiveId:e.offerId,offertype:e.offerType,disclaimer:e.disclaimers.disclaimer},S.extend(e,n),_=o.updateOfferProperties(e)))}),c.find("span").html(f),c.closest(".offer").addClass(""+u+"-offer-hover"),c.closest(".panel-container").css({height:182}),c.closest(".offer").next().show(),_.zipCode=C,u.toUpperCase()){case"LEASE":c.closest(".panel").after(("en"==P.lang?d:g)(_));break;case"CASHBACK":c.closest(".panel").after(("en"==P.lang?l:h)(_));break;case"APR":c.closest(".panel").after(("en"==P.lang?s:p)(_));break;case"NEWOTHER":c.closest(".panel").after(("en"==P.lang?v:b)({offerObj:y,tagDetails:{},zipcode:""}))}c.closest(".panel-container").removeAttr("style"),r=o.$(".offer-details-container"),o.$(".panel-set").after(r),r.css({height:"auto","float":"left",position:"relative","margin-top":50}).slideDown("slow",function(){var e=c.closest(".panel");if(I.trigger("pageLayout:changed"),c.closest(".panel-set").find(".panel").length-1==k(e).index()){var t=o.$(".car-model.single:first").find(".offer-details-container");t.css("border-bottom","none"),t.find(".disclaimer").css("margin-bottom",-15)}})}else c.find("span").html(m),c.closest(".offer").removeClass(""+u+"-offer-hover"),c.closest(".offer").next().hide(),i.slideUp("slow",function(){i.remove(),c.closest(".panel-container").removeAttr("style"),I.trigger("pageLayout:changed")})},updateOfferProperties:function(e){var t,i,a=this,r=k.cookie("tda"),n=e.bullets.bullet,s={camryhybrid:"camry/grade/Hybrid LE",avalonhybrid:"avalon/grade/Hybrid XLE Premium",highlanderhybrid:"highlander/grade/Hybrid",priusplugin:"https://auth2.toyota.com/order/prius/#page=Start"};return"Miscellaneous"==e.offerType?(t=e.currentFilterId,i=A[e.currentFilterName].replace(/-/g,"")):(t=e.seriesList.series.id,i=A[e.seriesList.series.name].replace(/-/g,"")),/camryhybrid|avalonhybrid|highlanderhybrid|priusplugin/.test(t)&&(s=s[t]),S.extend(e,{modelCode:i,region:r,endDate:e.endDate,bltsData:n,queryname:t,language:"en"===P.lang?"english":"espanol",gstMap:a.getGstUrl(t),configMapping:s,tdaCode:"",featured:"",tilePos:"",offerDescription:"",zipCode:""}),(S.isEqual(r,"SET10")||S.isEqual(r,"GST"))&&S.extend(e,{setRegionModelCode:w.getSetRegionModelCodes()[e.seriesName],zipCodeSET:a.collection.get("zipcode")}),e},closeOfferDetailsSection:function(e){var t=this,i=t.$(e.currentTarget).closest(".offer-details-container"),a=i.attr("class").split(" ")[1].split("-")[0],r="View Details";e.preventDefault(),i.prev().find(".offer").removeClass(a+"-offer-hover").removeAttr("style"),i.prev().find(".local-indicator").hide(),i.prev().find(".show-dtls span").html(r),i.prev().find(".show-dtls").removeClass("show-dtls"),i.prev().find(".icon-arrow-up-tiny").removeClass("icon-arrow-up-tiny"),i.slideUp("slow",function(){i.prev().find(".panel-container").removeAttr("style"),i.remove(),I.trigger("pageLayout:changed")})},removePrevOfferStyles:function(e){var t=e.closest(".offer"),i="View Details";e.closest(".panel-container").removeAttr("style"),void 0!==t.attr("class")&&t.closest(".offer").removeClass(""+t.attr("class").split(" ")[2]),e.closest(".offer").next().hide(),e.find("span").html(i),e.removeClass("show-dtls"),e.find(".icon-arrow-up-tiny").removeClass("icon-arrow-up-tiny")},getSelectedOffer:function(e,t){var i={};return S.each(t,function(t){t.get("incentiveId").toString()===e.toString()&&(i=t.attributes)}),i},customDateFormat:function(e,t){if(isNaN(e))return e;var i,a,r,n,s,o,l,c,d,u,p,_,h,f,g,m,v,y,b,w,C,k=new Date(e);return a=((i=k.getFullYear())+"").slice(-2),s=(o=k.getMonth()+1)<10?"0"+o:o,n=(r=["January","February","March","April","May","June","July","August","September","October","November","December"][o-1]).substring(0,3),d=(u=k.getDate())<10?"0"+u:u,c=(l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][k.getDay()]).substring(0,3),C=u>=10&&20>=u?"th":1==(w=u%10)?"st":2==w?"nd":3==w?"rd":"th",t=t.replace("#YYYY#",i).replace("#YY#",a).replace("#MMMM#",r).replace("#MMM#",n).replace("#MM#",s).replace("#M#",o).replace("#DDDD#",l).replace("#DDD#",c).replace("#DD#",d).replace("#D#",u).replace("#th#",C),h=p=k.getHours(),0===h&&(h=24),h>12&&(h-=12),_=10>h?"0"+h:h,b=(y=12>p?"am":"pm").toUpperCase(),f=(g=k.getMinutes())<10?"0"+g:g,m=(v=k.getSeconds())<10?"0"+v:v,t.replace("#hhh#",p).replace("#hh#",_).replace("#h#",h).replace("#mm#",f).replace("#m#",g).replace("#ss#",m).replace("#s#",v).replace("#ampm#",y).replace("#AMPM#",b)},destroy:function(){var e=this;e.remove(),e.unbind()},getGstUrl:function(e){var t,i,a="",r={"4runner":"Crossovers|4Runner",avalon:"Cars|Avalon",camry:"Cars|Camry",corolla:"Cars|Corolla",fjcruiser:"Crossovers|FJ Cruiser",highlander:"Crossovers|Highlander",landcruiser:"Crossovers|Land Cruiser",matrix:"Cars|Matrix",prius:"Hybrids-EVs|Prius",rav4:"Crossovers|RAV4",rav4ev:"Crossovers|RAV4EV",sequoia:"Crossovers|Sequoia",sienna:"Cars|Sienna",tacoma:"Trucks|Tacoma",tundra:"Trucks|Tundra",yaris:"Cars|Yaris",venza:"Crossovers|Venza",priusc:"Hybrids-EVs|Prius <em>c</em>",priusv:"Hybrids-EVs|Prius <em>v</em>",priusplugin:"Hybrids-EVs|Prius Plug-In",camryhybrid:"Hybrids-EVs|Camry Hybrid",avalonhybrid:"Hybrids-EVs|Avalon Hybrid",highlanderhybrid:"Hybrids-EVs|Highlander Hybrid"};return t=r[e].split("|")[0],i=r[e].split("|")[1].replace(/ /g,"_"),/prius|priusc|priusv/.test(e)&&(i="priusc"===e?"Prius_c":"priusv"===e?"Prius_v":"3rd_Gen_Prius"),/tacoma|tundra/.test(e)&&(i="tacoma"===e?"Tacoma_Regular_Cab":"Tundra_Regular_Cab"),a={style:t,model:i}}});return M}),define("app/sit/local-specials",["sit","ritLocalSpecialR2"],function(e,t){var i=e.$,a=(e._,e.Backbone),r=e.Events;return a.View.extend({events:{"tap .cta-local-specials":"onLocalSpecialsClick"},initialize:function(e){var t=this;t.options=e,debuggerOn&&console.log("local-specials-initialize:"),t.render()},getLocalSpecials:function(){var i=this,a={el:i.options.$el,zipcode:i.options.inventory.get("zipcode"),series:i.options.inventory.picks.get("series"),seriesName:e.API.getCurrentSeries().code,year:e.API.getCurrentYear().title};/^camry/.test(a.series)&&2014==a.year&&(a.year=2014.5),r.on("localspecials:ready",i.showLocalSpecials,i),i.localSpecials&&i.localSpecials.undelegateEvents(),i.localSpecials=new t(a)},showLocalSpecials:function(){var e=this;r.off("localspecials:ready",e.showLocalSpecials,e)},onLocalSpecialsClick:function(e){i(e.currentTarget)},render:function(){var e=this;e.getLocalSpecials()},destroy:function(){var e=this;e.LocalSpecialsAnalytics.remove()}})}),define("app/jst/rit/details",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<div id="highlightDetails">\n<div class="info-column">\n<div class="page-header">\n<span class="small">Vehicle Details</span>\n</div><span class="series-year">'+(null==(__t=data.year)?"":__t)+'</span><span class="series-name">'+(null==(__t=data.seriesName)?"":__t)+'</span><span class="trim-name">\n',data.seriesName!==data.trimName&&(__p+=null==(__t=data.trimName.replace(new RegExp(data.seriesName,"i"),""))?"":__t),__p+='\n</span><span class="price">'+(null==(__t=data.displayMsrp)?"":__t)+'</span><span class="total-MSRP">'+(null==(__t=SIT.strings.totalmsrp)?"":__t)+(null==(__t=SIT._.linkDisclaimer("[msrp_total]"))?"":__t)+'</span><a class="btn btn-pill contact-dealer" data-flyout-form="INVENTORY_SEARCH" data-model-code="'+(null==(__t=data.seriesCode)?"":__t)+'" data-trim-id="'+(null==(__t=data.modelCode)?"":__t)+'" href="#">\n<i class="icon-arrow-right"></i>\n<span>'+(null==(__t=SIT.strings.contactdealer)?"":__t)+'</span>\n</a><a class="btn btn-circle tiny apply-for-financing" href="https://www.toyotafinancial.com/pub/w/#apply_for_credit/external?referrer=TYT" target="_blank">\n<i class="icon-arrow-right-tiny"></i>\n<span>'+(null==(__t=SIT.strings.applyforfinancing)?"":__t)+'</span>\n</a>\n</div><div class="car-column">\n<div id="threed-wrapper"></div>\n</div><div class="terior-column">\n<div class="nav-options-inverse">\n<h4>View</h4>\n<div class="nav-options" id="view-nav">\n<div class="indicator" style="top: 4px; left: 0px;"><img src="/apps/configurator/img/indicator-nav-options-inverse.png"></div>\n<ul id="teriorNav">\n<li class="is-on"><a href="#">'+(null==(__t=SIT.strings.exterior)?"":__t)+'</a></li>\n<li class=""><a href="#">'+(null==(__t=SIT.strings.interior)?"":__t)+'</a></li>\n</ul>\n</div>\n</div><div class="print-email-container">\n<a class="btn btn-gray large print-details" href="#">\n<i class="icon-print"></i>\n<span>'+(null==(__t=SIT.strings.printdetails)?"":__t)+'</span>\n</a>\n<br>\n<a href="#" class="btn btn-gray large email-details email tcom-exact-target">\n<i class="icon-email-circle"></i>\n<span>'+(null==(__t=SIT.strings.emaildetails)?"":__t)+'</span>\n</a>\n</div>\n<!-- <div class="tcom-exact-target" data-type="searchinventory" data-cta-title="Email Details" data-title="Email Details" data-callout="Send an email with my vehicle specifications" data-series-name="'+(null==(__t=data.seriesName)?"":__t)+'" data-trim="'+(null==(__t=data.trimName)?"":__t)+'" data-zip-code="'+(null==(__t=data.zipCode)?"":__t)+'" data-vin="'+(null==(__t=window.location.hash.replace("#!/details/",""))?"":__t)+'" data-offerType="" data-confirmation="An email with the details of this summary has been sent to:" data-error-details="Email services are down, please Print Offer or try again later." data-model-code="'+(null==(__t=data.seriesCode)?"":__t)+'" data-trim-id="'+(null==(__t=data.modelCode)?"":__t)+'" data-engine="'+(null==(__t=data.engine)?"":__t)+'" data-interior-color-name="'+(null==(__t=data.interiorcolor)?"":__t)+'" data-exterior-color-name="'+(null==(__t=data.exteriorcolor)?"":__t)+'" data-model-year="'+(null==(__t=data.year)?"":__t)+'" data-total-msrp="'+(null==(__t=data.msrp)?"":__t)+'" data-transmission="'+(null==(__t=data.transmission)?"":__t)+'" data-accessory-list="'+(null==(__t=data.accessoryList)?"":__t)+'" data-vehicle-image-url="'+(null==(__t=data.resultModel.jelly)?"":__t)+'" multivehicle-flag="false"></div> --></div>\n</div><div class="clearfix"></div><div id="summaryDetails">\n<table>\n<tbody>\n<tr class="odd-row"><td>'+(null==(__t=SIT.strings.modelyear)?"":__t)+"</td><td>"+(null==(__t=data.year)?"":__t)+"</td></tr>\n<tr><td>"+(null==(__t=SIT.strings.series)?"":__t)+"</td><td>"+(null==(__t=data.seriesName)?"":__t)+'</td></tr>\n<tr class="odd-row"><td>'+(null==(__t=SIT.strings.model)?"":__t)+"</td><td>"+(null==(__t=data.trimName)?"":__t)+"</td></tr>\n<tr><td>"+(null==(__t=SIT.strings.totalmsrp)?"":__t)+(null==(__t=SIT._.linkDisclaimer("[msrp_total]"))?"":__t)+"</td><td>"+(null==(__t=data.displayMsrp)?"":__t)+'</td></tr>\n<tr class="odd-row"><td>'+(null==(__t=SIT.strings.engine)?"":__t)+"</td><td>"+(null==(__t=SIT._.linkDisclaimer(data.engine))?"":__t)+"</td></tr>\n<tr><td>"+(null==(__t=SIT.strings.transmission)?"":__t)+"</td><td>"+(null==(__t=SIT._.linkDisclaimer(data.transmission))?"":__t)+'</td></tr>\n<tr class="odd-row"><td>'+(null==(__t=SIT.strings.color)?"":__t)+'</td><td>\n<div class="summary-color-print">\n<div class="print-color-name">Exterior: '+(null==(__t=data.exteriorcolor)?"":__t)+'</div>\n<div class="print-color-name">Interior: '+(null==(__t=data.interiorcolor)?"":__t)+'</div>\n</div><div id="summary-colors">\n<span>Exterior</span><span>Interior</span>\n<ul class="color-picker unstyled">\n<li>\n<a href="#" data-code="" data-msrp="" data-name="'+(null==(__t=data.exteriorcolor)?"":__t)+'" style="background-color:#'+(null==(__t=data.hex)?"":__t)+'"></a>\n<div data-tooltip="<strong>'+(null==(__t=data.exteriorcolor)?"":__t)+'</strong>" class="ext" data-original-title="'+(null==(__t=data.exteriorcolor)?"":__t)+'"></div>\n</li>\n<li>\n<a href="#" data-code="" data-msrp="" data-name="'+(null==(__t=data.interiorcolor)?"":__t)+'" style="background-image:url('+(null==(__t=data.swatch)?"":__t)+')"></a>\n<div data-tooltip="<strong>'+(null==(__t=data.interiorcolor)?"":__t)+'</strong>" class="ext" data-original-title="'+(null==(__t=data.interiorcolor)?"":__t)+'"></div>\n</li>\n</ul>\n</div>\n</td></tr>\n',_.each(data.packages,function(e,t){__p+=0===t?"\n<tr "+(null==(__t=t%2!==0?'class="odd-row"':"")?"":__t)+"><td>"+(null==(__t=SIT.strings.availableoptions)?"":__t)+"</td>\n":"\n<tr"+(null==(__t=t%2===0?'class="odd-row"':"")?"":__t)+"><td><!-- --></td>\n",__p+="\n<td><strong>"+(null==(__t=SIT._.linkDisclaimer(e.title))?"":__t),e.description&&(__p+=":"),__p+="</strong> "+(null==(__t=SIT._.linkDisclaimer(e.description))?"":__t)+"</td></tr>\n"}),__p+='</tbody>\n</table>\n</div><div id="descriptionDetails">\n',_.each(data.standardFeatures,function(e,t){var i=e[0].group,a=i.replace(/[^\w]/gi,"");__p+='<div class="accordion-group"><div class="accordion-heading chzn-container-single" data-title="'+(null==(__t=i)?"":__t)+'">\n<div class="accordian-header accordion-toggle chzn-single collapsed" data-toggle="collapse" data-target="#'+(null==(__t=a)?"":__t)+'" href="#'+(null==(__t=a)?"":__t)+'">\n<strong>'+(null==(__t=i)?"":__t)+'</strong>\n<div class="btn btn-circle smaller pull-right">\n<i class="icon-arrow-down"></i>\n<i class="icon-arrow-up"></i>\n</div>\n</div>\n</div><div id="'+(null==(__t=a)?"":__t)+'" class="accordion-body collapse">\n<div class="accordion-inner">\n<table>\n',_.each(e,function(e,t){__p+="\n<tr",t%2===0&&(__p+=' class="odd-row"'),__p+=">\n<td>"+(null==(__t=SIT._.linkDisclaimer(e.title))?"":__t)+"</td>\n</tr>\n"}),__p+="\n</table>\n</div>\n</div></div>"}),__p+='</div><div id="localSpecialsDetails">\n<h3>Local Offers</h3>\n<div class="local-specials" id="payments-local-specials">\n<section class="panel-container offers-main-section active-section">\n<div class="container">\n<div class="page-content">\n<div class="panel-set"></div>\n</div>\n</div>\n</section>\n</div>\n</div>';return __p}}),define("ritNavIndicator",["sit"],function(e){var t=e.$,i=e.Events,a=e.has,r=e.$body;t.fn.navIndicator=function(e,n){function s(s,o){function l(e){return b.call(u,t(e).index()),u}function c(){m.show(),setTimeout(function(){var e=p.find(".active").index();u.moveable&&-1!==e&&b(e)},300)}function d(e){if(u.moveable&&e.position()&&"number"==typeof e.position().left){var t=e.width()-42;m.stop().animate({left:e.position().left+"px"},200,function(){m.find("span").width(t+"px")})}}var u=this,p=t(u),_=p.find("li"),h=p.find("ul").parent(),f=h.parent().hasClass("nav-options-gray"),g=h.is(".items-12")||h.is(".items-11")||h.is(".items-10")||h.is(".items-9")||h.is(".items-8"),m=p.find(".indicator"),v=p.find("li.is-on").eq(0),y="click touchstart";u.moveable=!0,u.refreshIt=!0,u.halt=!1,i.on("HALT_NAV_INDICATOR",function(e){e.configurator?u.halt=!0:u.halt=!1}),v.length||(v=t(e));var b=function(e){var i=t("li",u).eq(e),a=i.position(),r=f?187:g?i.width():i.width()-42,n=i.height(),s={width:r+"px",height:n+"px"};i.siblings().removeClass("is-on"),u.moveable=!1,m.stop().css({top:a.top+"px",left:a.left+"px"}),setTimeout(function(){i.siblings().removeClass("is-on"),i.addClass("is-on"),u.moveable=!0,f?m.find("img").css(s):g?(m.find("span").css(s),m.css({width:i.width()-2+"px",height:n+25+"px"})):(m.find("span").width(r+"px"),m.find("span").height(n+"px"))},300)};if(n||0===n)return void b(n);v.length&&"none"!==p.parents(".panel").css("display")&&-1!==v.index()&&b(v.index()),1==_.length&&b(0);var w=p.hasClass("active-hover");return _.on(y,function(e,a){var n=t(this),s=n.index();w||e.preventDefault(),i.trigger("NAV_INDICATOR_CLICK",e),n.trigger("navIndicator:click",s),u.moveable=!1,n.attr("disabled")||n.hasClass("disabled")||(r.off("activate"),u.halt===!1&&-1!==s&&b(s))}),p.hasClass("active-hover")&&(u.moveable&&r.on("activate",c),a.touch||(p.on("mouseover","li",function(){var e=t(this);m.show(),u.moveable&&d(e)}),p.on("mouseout",function(){var e=p.find(".active");e.length?u.moveable&&d(e):(u.moveable&&d(p.find("li.is-on")),0===p.find("li.is-on").length&&m.hide())}))),v.length&&(v.find("a").addClass("current-tab"),m.show()),u.refreshIt&&t.fn.scrollspy&&(t('[data-spy="scroll"]').each(function(){t(this).scrollspy("refresh")}),u.refreshIt=!1),p.setItem=l,p}var o=[];return this.each(function(e,t){o.push(s.call(this,e,t))}),o[1]?o:o[0]?o[0]:this}}),define("app/jst/rit/email-your-toyota",[],function(){return function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div class="email-your-toyota default">\n<button class="btn-close">X</button><div class="email-input-form">\n<h3>Email Summary</h3>\n<div class="sub-title">Send an email with this Summary</div><div class="input-container">\n<span class="input-label">Your Name</span>\n<input type="text" id="your-name" name="your-name" placeholder="Your Name" />\n</div><div class="input-container">\n<span class="input-label">Your Email</span>\n<input type="text" id="your-email" name="your-email" placeholder="Your Email" />\n</div><div class="input-container checkboxed">\n<label for="send-to-self">\n<input type="checkbox" id="send-to-self" name="send-to-self" />\n<span class="input-label">Sending to myself</span>\n</label>\n</div><div class="input-container">\n<span class="input-label">Recipient\'s Email</span>\n<input type="text" id="recip-email" name="recip-email" placeholder="Recipient\'s Email" />\n</div><div class="input-container">\n<span class="input-label">Comments <span class="optional">(Optional)</span></span>\n<textarea type="text" id="comments" name="comments" placeholder="Comments"></textarea>\n</div><div class="small-notice">\n<span>Toyota will not use your email for any other purposes or share it with third parties. To view our full privacy policy, <a href="http://www.toyota.com/support/privacy.html">click here</a>.</span>\n</div><button class="send-email" title="Send Message"><span class="text">Send Message</span></button>\n</div>\n<div class="email-success-form">\n<h4>Confirmation</h4>\n<p>An email with the details of this summary has been sent to: <span class="send-to-email"></span></p>\n</div>\n</div>';return __p}}),define("app/views/rit/details",["sit","app/views/threed/threed","ritBootstrapPopover","app/sit/local-specials","app/jst/rit/details","app/views/rit/raq","ritNavIndicator","app/jst/rit/email-your-toyota"],function(e,t,i,a,r,n,s,o){var l,c,d,u=e.$,p=e._,_=e.Backbone,h=e.Events,f="",g={trim_engine:f},m=!0,v=Modernizr.touch?{"click .back-to-inventory":"onBackToInventoryClick","click #highlightDetails .print-details":"onDetailPrintClick","click .accordion-heading":"onAccordionClick","touchstart .nav-options a":"onTeriorClick","click .nav-options a":"onTeriorClick","click .print-details":"onPrintClick","click .email-details":"onEmailClick","click .contact-dealer":"onContactADealerClick","click .apply-for-financing":"onApplyForFinancingClick","click .local-specials .left-arrow":"onArrowClick","click .local-specials .right-arrow":"onArrowClick","click .offer-details a":"onViewDetailsClick","click .requestQuote":"onRAQClick","click .buildYours":"onBYTClick","click .searchInventory":"onSITClick","click .offer-details-container a.print":"onLocalOfferPrintClick","click .offer-buttons .apr-print":"onLocalOfferPrintClick","click .offer-buttons .lease-print":"onLocalOfferPrintClick","click .offer-buttons .cashback-print":"onLocalOfferPrintClick","click .offer-buttons .newother-print":"onLocalOfferPrintClick"}:{"click .back-to-inventory":"onBackToInventoryClick","click #highlightDetails .print-details":"onDetailPrintClick","click .accordion-heading":"onAccordionClick","click .nav-options a":"onTeriorClick","click .print-details":"onPrintClick","click .email-details":"onEmailClick","click .contact-dealer":"onContactADealerClick","click .apply-for-financing":"onApplyForFinancingClick","click .local-specials .left-arrow":"onArrowClick","click .local-specials .right-arrow":"onArrowClick","click .offer-details a":"onViewDetailsClick","click .requestQuote":"onRAQClick","click .buildYours":"onBYTClick","click .searchInventory":"onSITClick","click .offer-details-container a.print":"onLocalOfferPrintClick","click .offer-buttons .apr-print":"onLocalOfferPrintClick","click .offer-buttons .lease-print":"onLocalOfferPrintClick","click .offer-buttons .cashback-print":"onLocalOfferPrintClick","click .offer-buttons .newother-print":"onLocalOfferPrintClick"},y=_.View.extend({events:v,initialize:function(){var e=this;d=e,e.appView=e.options.appView,e.inventory=e.model,l=e.$("#details-content"),c=e.$(".car-column"),e.$email=u(".email-your-toyota"),e.$recip=u("#recip-email"),h.on("SIT:details:success",u.proxy(e.render,e)),h.on("SIT:details:fail",u.proxy(e.onApiError,e))},onApiError:function(){h.trigger("SIT:service:error")},onClick:function(e){},onBackToInventoryClick:function(e){console.log("onBackToInventoryClick:",e),this.appView.fireIS("117.22",{trim_engine:this.options.model.details.get("details").modelName}),m=!0},onDetailPrintClick:function(e){return e.preventDefault(),u("#inventoryHeader, #highlightDetails, #summaryDetails, #totalMSRPDisclaimer, #descriptionDetails").removeClass("not-printable").addClass("printable"),u(".offer-details-container").removeClass("printable").addClass("not-printable"),window.print(),!1},onLocalOfferPrintClick:function(e){e.preventDefault();var t=this,i=u(e.currentTarget),a={offer_description:i.data("incentiveId"),offer_type:i.data("type"),trim_engine:t.options.model.details.get("details").modelName.trim()};u("#inventoryHeader, #highlightDetails, #summaryDetails, #totalMSRPDisclaimer, #descriptionDetails").removeClass("printable").addClass("not-printable"),u(".offer-details-container").removeClass("not-printable").addClass("printable"),u("body").removeClass("local-specials-print-override"),this.appView.fireIS("117.41",a)},onArrowClick:function(e){this.appView.fireIS("117."+(u(e.target).hasClass("next")?34:35),{trim_engine:this.options.model.details.get("details").modelName.trim()})},onRAQClick:function(e){var t=this,i=u(e.currentTarget),a={offer_description:i.data("incentiveId"),offer_type:i.data("type"),trim_engine:t.options.model.details.get("details").modelName.trim()};t.appView.fireIS("117.38",a)},onBYTClick:function(e){var t=this,i=u(e.currentTarget),a={offer_description:i.data("incentiveId"),offer_type:i.data("type"),trim_engine:t.options.model.details.get("details").modelName.trim()};t.appView.fireIS("117.39",a)},onSITClick:function(e){var t=this,i=u(e.currentTarget),a={offer_description:i.data("incentiveId"),offer_type:i.data("type"),trim_engine:t.options.model.details.get("details").modelName.trim()
};this.appView.fireIS("117.40",a)},onViewDetailsClick:function(e){var t=this,i=u(e.target).parents(".offer"),a={offer_description:i.find(".offer-header").text().replace(/  +?/g,"").trim().replace(/(\r\n|\n|\r)/gm,"_").replace(/_+/g," "),offer_type:i.data("type"),trim_engine:t.options.model.details.get("details").modelName.trim()};t.appView.fireIS("117.37",a)},onAccordionClick:function(e){var t=this,i=u(e.currentTarget),a=g;a.trim_engine=a.trim_engine.trim(),a.label_title=u(i,"strong").text().trim(),a.Label_Title=a.label_title,t.appView.fireIS("117.33",a)},onApplyForFinancingClick:function(e){this.appView.fireIS("117.27",g)},onContactADealerClick:function(t){var i=this,a=i.inventory.details.attributes.details.resultModel;p.each(a.packages,function(e){e.title.length>0&&(e.title=" "+e.title.replace(/\[.*?\]/g,"").replace(/[ \t]+$/,""))}),p.each(a.accessoriesList,function(e){e.description.length>0&&(e.description=" "+e.description.replace(/\[.*?\]/g,"").replace(/[ \t]+$/,""))}),a=p.cloneDeep(session.apiWrapper.getDataForContactDealer(a),a),n.setConfigCookie(a),e.Events.once("modal:close",function(){p.defer(function(){h.trigger("inventory:loaded","details")})}),i.appView.fireIS("117.25",g),t.preventDefault()},onPrintClick:function(e){this.appView.fireIS("117.31",g)},onEmailClick:function(t){var i=this,a=e.API.getCurrentModelObj().attributes.description.value;i.appView.fireIS("117.32",g),console.log("details:onEmailClick",t),u(".email-input-form").css({display:"block"}),u(".email-success-form").css({display:"none"}),t.preventDefault(),i.$email.remove(),console.log("summary:onEmailClick",t),a=e.API.getCurrentYear().title+" "+a+" Configuration",a=a.replace(/(<([^>]+)>)/gi,"");var r=o({title:a});u("body").append(r),i.setEmailPosition(),u(window).on("resizing:complete.summary",i.setEmailPosition),u(".send-email",".email-your-toyota").click(i.onEmailSendClick),u(".btn-close",".email-your-toyota").click(i.onEmailCloseClick),u("#send-to-self").click(function(){u("#send-to-self").is(":checked")&&u("#recip-email").val(u("#your-email").val())}),setTimeout(function(){u(".summary-content").one("click",function(){console.log("summary: closing email-your-toyota"),u(".email-your-toyota").remove()})},500)},onEmailSendClick:function(){var t,i=this,a=e.API.getCurrentModelObj(),r=a.attributes.description.value,n=u("<span />",{html:r}).text(),s=e.API.getCurrentYear().title,o=u("<span />",{html:e.API.getCurrentSeries().title}).text(),l=TCOM.cookie("zipcode"),c=u("#your-email").val(),d=u("#recip-email").val(),p=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,_=!1;if(p.test(c)||(u("#your-email").addClass("invalid"),_=!0),p.test(d)||(u("#recip-email").addClass("invalid"),_=!0),!_){t=a.grade[0].images.images.url,console.groupEnd();var h={zipCode:l,senderName:u("#your-name").val(),senderEmail:c,recipientEmail:d,toMyself:u("#send-to-self").is(":checked")?1:0,senderComments:u("#comments").val(),model:o,trim:" "+a.grade[0].code,description:n,year:s,vehicleImageUrl:t,packageName:a.packages[0].title,exteriorColorName:session.getTrueFeaturesByType("exteriorcolor")[0].title,interiorColorName:session.getTrueFeaturesByType("interiorcolor")[0].title,engine:a.engine.title,disclaimerDetails:"\n			Manufacturer's Suggested Retail Price, excludes the Delivery, Processing and Handling Fee of $825 for Cars, $885 for Small/Light Trucks (Sienna, RAV4, Highlander Gas, Highlander HV, 4Runner, Tacoma and Venza), $1100 for Large Trucks (Tundra), and $925 for Large SUVs (Sequoia and Land Cruiser). (Historically, vehicle manufacturers and distributors have charged a separate fee for processing, handling and delivering vehicles to dealerships. Toyota's charge for these services is called the \"Delivery, Processing and Handling Fee\" and is based on the value of the processing, handling and delivery services Toyota provides as well as Toyota's overall pricing structure. Toyota may make a profit on the Delivery, Processing and Handling Fee.) Excludes taxes, license, title and available or regionally required equipment. The Delivery, Processing and Handling Fee in AL, AR, FL, GA, LA, MS, NC, OK, SC and TX will be higher. Actual dealer price will vary.\n		"};u.ajax({type:"POST",url:"/ToyotaSite/rest/sendConfigEmail",data:JSON.stringify(h),dataType:"json",success:i.onEmailSuccess,error:i.onEmailFailure,contentType:"application/json;charset=UTF-8"})}},onEmailSuccess:function(){u(".email-input-form").css({display:"none"}),u(".email-success-form").css({display:"block"}),u(".send-to-email").text(u("#recip-email").val())},onEmailFailure:function(){u(".email-input-form").css({display:"none"}),u(".email-success-form").css({display:"block"}),u(".send-to-email").text(u("#recip-email").val())},onEmailCloseClick:function(e){e.preventDefault(),u(".email-your-toyota").remove()},setEmailPosition:function(){console.log("summary:setEmailPosition");var e=d,t=u(".email-details").offset(),i=25,a=u(window).width(),r=e.$email.width(),n=t.left-.5*r-i,s=t.top+i,o=a-r-i;n=i>n?i:n,n=n>o?o:n,console.log("left"+n+", top"+s),u(".email-your-toyota").css({left:n+"px",top:s+"px"})},onTeriorClick:function(e){var t=this;e.preventDefault();var i=u(e.currentTarget).text().toLowerCase().replace(/^\s+|\s+$/i,"");return t.appView.fireIS("117."+("interior"===i?"29":"30"),g),t.threed.changeView(i),!1},applyColorChipToolTip:function(e){var t=this;p.each(t.$(".color-picker div"),function(e){u(e).popover({trigger:"hover",placement:"bottom",content:u(e).attr("data-tooltip")})})},updateDisclaimers:function(t){var i=e.$disclaimers,a=p.template("<li><%= disclaimer %></li>"),r=p.map(i.find("li").splice(0,6),function(e){return u(e).text()}),n=p.union(r,p.map(t,function(e){return e.description})),s=p.map(n,function(e){return a({disclaimer:e})}).join("");i.html(s)},show:function(){var e=this;e.$el.addClass("is-on")},hide:function(){var e=this;e.$el.removeClass("is-on"),l.find("#highlightDetails, #summaryDetails, #descriptionDetails, #localSpecialsDetails .panel-set").empty()},updateBackToInventoryHref:function(t){var i=this,t="#!/results/"+e.API.getCurrentQueryParams();i.$(".back-to-inventory").attr("href",t)},render:function(){var t=this,i=t.model.details.get("details"),n=[];i.resultModel.accessoriesList.length&&(p.each(i.resultModel.accessoriesList,function(e){e.description&&n.push(e.description)}),i.accessoryList=n.join(", ")),f=i.modelName,g={trim_engine:f},t.updateBackToInventoryHref(i.resultsUrl),l.html(r({data:i,SIT:e})),u("#view-nav").navIndicator(),t.applyColorChipToolTip(),l.show(),u.when(t.inventory.sessionReady).then(function(){e.API.initializeThreedSession()}),u.when(e.API.getThreedDeferred()).then(function(){e.API.setDetailPicks(t.inventory.details.get("picks")),t.initThreed(),t.detailsLocalSpecials=new a({inventory:t.inventory,$el:u("#localSpecialsDetails")})}),h.trigger("inventory:loaded","details"),m&&(t.appView.fireIS("117.4",{model_name:i.seriesName,model_trim:i.trimName}),m=!1),window.tconnect&&window.tconnect.rescan(function(){console.log("plugins ready")})},initThreed:function(){var e=this;return"rav4ev"===e.inventory.picks.get("series")?(c.html(u("<div />").css({height:"100%",width:"100%","background-position":"-165px 0","background-repeat":"no-repeat","background-image":"url(/content/gallery/360/"+data.modelYear+"/rav4ev/rav4_ev/"+data.exteriorKey+"/34.jpg)"})),void u(".nav-options-inverse").addClass("disabled")):(e.threed&&(e.threed.destroy(),e.threed=null),e.threed=new t(window.threedsession,e.options),void(debuggerOn&&console.log("self.threed: ",e.threed)))}});return y}),define("app/jst/rit/error-states/zip",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+='<div id="error-zip" class="error-state"><div class="title">\n<div class="btn btn-circle red"><i class="icon-bang"></i></div><h2>'+(null==(__t=SIT.strings.errors.oneMore)?"":__t)+'</h2>\n</div><div class="body">\n<div class="description">\n<span>\n'+(null==(__t=SIT.strings.errors.allWeNeed)?"":__t)+"<br>\n"+(null==(__t=SIT.strings.errors.itWillHelp)?"":__t)+"<br />\n"+(null==(__t=SIT.strings.errors.itWillHelpBr)?"":__t)+'\n</span>\n</div>\n<div class="zip-code-changer"></div>\n</div></div>';return __p}}),define("app/jst/rit/error-states/fail",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+='<div id="error-fail" class="error-state">\n<div class="title">\n<div class="btn btn-circle red"><i class="icon-bang"></i></div><h2>'+(null==(__t=SIT.strings.errors.apologies)?"":__t)+'</h2>\n</div>\n<div class="body">\n<div class="description">\n'+(null==(__t=SIT.strings.errors.technicalDifficulties)?"":__t)+"<br />\n"+(null==(__t=SIT.strings.errors.meantime)?"":__t)+'\n</div>\n<div id="options-row">\n<div class="option">\n<h3>'+(null==(__t=SIT.strings.errors.findDealer)?"":__t)+'</h3>\n<a class="btn btn-pill" href="/dealers/"><i class="icon-arrow-right"></i><span>'+(null==(__t=SIT.strings.errors.dealerLocator)?"":__t)+'</span></a>\n</div>\n<img class="stretched-options-divider" src="/common/img/indicators/options-divider-stretched.png" /><div class="option">\n<h3>'+(null==(__t=SIT.strings.errors.findDeals)?"":__t)+'</h3>\n<a class="btn btn-pill" href="/local-specials/"><i class="icon-arrow-right"></i><span>'+(null==(__t=SIT.strings.errors.localSpecials)?"":__t)+'</span></a>\n</div>\n<img class="stretched-options-divider" src="/common/img/indicators/options-divider-stretched.png" /><div class="option">\n<h3>'+(null==(__t=SIT.strings.errors.returnToHome)?"":__t)+'</h3>\n<a class="btn btn-pill" href="/"><i class="icon-arrow-right"></i><span>'+(null==(__t=SIT.strings.errors.home)?"":__t)+"</span></a>\n</div>\n</div>\n</div>\n</div>";return __p}}),define("app/jst/rit/error-states/oos",[],function(){return function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div id="error-OOS" class="error-state"><div class="title">\n<div class="btn btn-circle red"><i class="icon-bang"></i></div><h2>Vehicle Out of Stock</h2>\n</div>\n<div class="body">\n<div class="description">\n<span>\nWe could not find this vehicle in our inventory.<br />\nIt was either sold or leased to another happy<br />\nToyota Customer.\n</span></div><a class="btn btn-pill back-to-inventory" href="#!/landing"><i class="icon-arrow-right"></i><span>Back to Inventory</span></a></div>\n</div>';return __p}}),define("app/jst/rit/rit-errors/errorsEnglish",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj){if("dealers:interstitial"===type&&(__p+='<div class="error-state error-zipcode error-dealers-interstitial"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="interstitial-open-search-box row"></div><a class="btn btn-pill continue" href="#"><i class="icon-arrow-right"></i><span>Show Dealers</span></a></span></a></div></div></div>'),"zipcode"===type){__p+='<div class="error-state error-zipcode"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="zip-code-changer row"></div><a class="btn btn-pill continue" href="#"><i class="icon-arrow-right"></i><span>';try{__p+=null==(__t=buttonCaption)?"":__t}catch(error){__p+="Continue"}__p+="</span></a></span></a></div></div></div>"}if("region"===type){__p+='<div class="error-state error-region"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="zip-code-changer row"></div>';try{__p+='<a target="_new" class="btn btn-pill" href="'+(null==(__t=redirect_url)?"":__t)+'"><i class="icon-arrow-right"></i><span>';try{__p+=null==(__t=redirect_caption)?"":__t}catch(error){__p+="Continue"}__p+="</span></a>"}catch(error){}__p+="</div></div></div>"}if("general"===type){__p+='<div class="error-state error-general">';try{__p+='<div class="title"><div class="btn btn-circle red"><i class="icon-bang"></i></div><h2>'+(null==(__t=title)?"":__t)+"</h2></div>"}catch(error){}__p+='<div class="body"><div class="description">';try{__p+='<span class="row row1">'+(null==(__t=message)?"":__t)+"</span>"}catch(error){}__p+="</div></div></div>"}}return __p}}),define("app/jst/rit/rit-errors/errorsEspanol",[],function(){return function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj){if("dealers:interstitial"===type&&(__p+='<div class="error-state error-zipcode error-dealers-interstitial"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="interstitial-open-search-box row"></div><a class="btn btn-pill continue" href="#"><i class="icon-arrow-right"></i><span>Mostrar Dealers</span></a></span></a></div></div></div>'),"zipcode"===type){__p+='<div class="error-state error-zipcode"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="zip-code-changer row"></div><a class="btn btn-pill continue" href="#"><i class="icon-arrow-right"></i><span>';try{__p+=null==(__t=buttonCaption)?"":__t}catch(error){__p+="Continuar"}__p+="</span></a></span></a></div></div></div>"}if("region"===type){__p+='<div class="error-state error-region"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="zip-code-changer row"></div>';try{__p+='<a target="_new" class="btn btn-pill" href="'+(null==(__t=redirect_url)?"":__t)+'"><i class="icon-arrow-right"></i><span>';try{__p+=null==(__t=redirect_caption)?"":__t}catch(error){__p+="Continuar"}__p+="</span></a>"}catch(error){}__p+="</div></div></div>"}if("general"===type){__p+='<div class="error-state error-general">';try{__p+='<div class="title"><div class="btn btn-circle red"><i class="icon-bang"></i></div><h2>'+(null==(__t=title)?"":__t)+"</h2></div>"}catch(error){}__p+='<div class="body"><div class="description">';try{__p+='<span class="row row1">'+(null==(__t=message)?"":__t)+"</span>"}catch(error){}__p+="</div></div></div>"}}return __p}}),define("ritErrorView",["sit","ritZipcodeChanger","app/jst/rit/rit-errors/errorsEnglish","app/jst/rit/rit-errors/errorsEspanol","ritLoading"],function(e,t,i,a,r){var n=(e.$,e._,e.Events),s=e.Util,o=e.Backbone,l=s.i18n,c=o.View.extend({events:{"click .error-zipcode .btn":"onZipcodeContinueClick","click .error-state .btn, .error-region .btn":"captureContinueClick"},initialize:function(){console.log("Error:initialize");var e=this;e.hookLoad(),e.render()},hookLoad:function(){var e=this;e.unhookLoad(),n.on("region:loading",e.onRegionLoading,e),n.on("region:loaded",e.onRegionLoaded,e)},unhookLoad:function(){var e=this;n.off("region:loading",e.onRegionLoading,e),n.off("region:loaded",e.onRegionLoaded,e)},onRegionLoading:function(){console.log("error:onRegionLoading");var e=this;e.$(".error-state").mask()},onRegionLoaded:function(){console.log("error:onRegionLoaded");var e=this;e.unhookLoad(),e.$(".error-state").unmask()},onZipcodeContinueClick:function(e){var t=this;e.preventDefault(),n.trigger("error:zipcode:continue:click"),t.zipcodeChanger.calculate(!0)},captureContinueClick:function(e){this.zipcodeChanger.locked!==!1&&e.preventDefault()},render:function(){var e=this,r=e.options;e.zipcodeChanger=new t({noBlur:r.noBlur,intercept:"zipcode"===r.type,triggerDealerSearch:r.triggerDealerSearch}),"en"===l.lang?e.$el.html(i(r)):e.$el.html(a(r)),"dealers:interstitial"===r.type||e.$(".zip-code-changer").html(e.zipcodeChanger.el)}});return c}),define("app/views/rit/errors",["sit","ritZipcodeChanger","app/jst/rit/error-states/zip","app/jst/rit/error-states/fail","app/jst/rit/error-states/oos","ritErrorView"],function(e,t,i,a,r,n){var s,o=(e.RIT,e.$),l=e._,c=e.Backbone,d=e.Events,u=(e.Config,e.Analytics),p=null,_={SET:-1!==l.indexOf(window.location.toString().split("/"),"espanol")?"http://www.comprauntoyota.com/":"http://southeast.buyatoyota.com/",SETBuild:"www.toyota.com"===window.location.hostname||"origin.www.toyota.com"===window.location.hostname?"http://southeast.buyatoyota.com/":"http://uat.setbuyatoyota.com/",PR:"http://www.toyotapr.com/",HI:"http://www.toyotahawaii.com/"},h=c.View.extend({events:{"tap .error-state .description a.btn":"onGstContinueBtnClicked","click .back-to-inventory":"onBackToInventoryClick"},initialize:function(){var t=this;p=t,t.appView=t.options.appView,t.router=t.options.router,d.on("zipcode:edit",t.onZipEdit,t),d.on("SIT:api:fail",function(){debuggerOn&&console.error("api:fail"),t.showServiceError()}),d.on("SIT:zipcode:fail",function(e){debuggerOn&&console.error("zipcode:fail"),t.showZipCodeError(e)}),d.on("SIT:region:fail",function(e){debuggerOn&&console.error("region:fail"),t.showRegionError(e)}),d.on("SIT:service:fail",function(e){debuggerOn&&console.error("service:fail"),t.showServiceError()}),d.on("SIT:error:oos",function(e){debuggerOn&&console.error("error:oos"),t.showOOSError()}),e.$window.on("SIT:api:fail",o.proxy(t.showServiceError,t)),d.on("SERVICE_ERROR",function(){debuggerOn&&console.error("service:error"),t.showServiceError()}),d.on("ZIPCODE_ERROR",function(){debuggerOn&&console.error("zipcode:error"),t.showZipCodeError()}),d.on("REGION_ERROR",function(e){debuggerOn&&console.error("region:error"),t.showRegionError(e)}),d.on("REGION_SUCCESS",function(){})},onBackToInventoryClick:function(t){console.log("onBackToInventoryClick:",t),this.appView.fireIS("117.131",{cta_name:"Back_To_Inventory",model_name:e.API.getCurrentSeries().title}),firstLoad=!0},onZipEdit:l.debounce(function(t){var i=this,a=i.model.get("currentView");switch(a){case"landing":i.appView.fireIS("117.8");break;case"results":i.appView.fireIS("OOS"===s?"117.132":"117.106",{model_name:e.API.getCurrentSeries().title});break;case"details":i.appView.fireIS("117.23")}},500,!0),onZipBlur:function(t){var i=p,a=i.model.get("currentView");switch(a){case"results":i.appView.fireIS("OOS"===s?"117.133":"117.107",{model_name:e.API.getCurrentSeries().title})}},onZipChange:function(){var t=p,i=t.model.get("currentView");switch(i){case"landing":u.setPageName(t.isVisible()?"T:Inventory:Error":"T:Inventory:Landing"),t.appView.fireIS("117."+(t.isVisible()?"52":"9"));break;case"results":t.appView.fireIS("OOS"===s?"117.133":"117.107",{model_name:e.API.getCurrentSeries().title});break;case"details":t.appView.fireIS("117.24")}window.location.reload(),t.hide()},showErrorMessage:function(e){var t=this;new n({el:t.$el,type:e.type,message:e.message,redirect_url:e.redirect_url}),t.show(),d.trigger("inventory:loaded","error")},showOOSError:function(t){s="OOS";var i=this;i.render(r()),i.show(),d.trigger("inventory:loaded","error"),i.appView.fireIS("117.130",{model_name:e.API.getCurrentSeries().title})},showServiceError:function(e){var t=this;t.render(a()),t.show(),d.trigger("inventory:loaded","error")},showZipCodeError:l.debounce(function(e){console.debug("showZipCodeError:",e);var a=this;a.render(i()),a.$el.find(".zip-code-changer").html((new t).el),a.show(),d.trigger("inventory:loaded","error")},500,!0),showRegionError:function(e){debuggerOn&&console.log("Landing:showRegionError:",e);var t=this,i="",a=t.model.get("currentView");if(e&&e.redirectUrl&&(e.redirect_url=e.redirectUrl),e&&e.redirectURL&&(e.redirect_url=e.redirectURL),50===e.regionCode?i=_.SET+t.getSetUrl():e&&e.redirect_url?(i+=e.redirect_url,i+=60===e.region_code?"Advanced/Pages/View/":"",i+="?zip="+o.cookie("zipcode")+"&siteid=Tcom_Search_Inventory:BAT_Home"):i+="?",new n({el:t.$el,type:"region",message:"View local inventory for",redirect_url:i}),t.show(),"results"===a){var r=o.cookie("zipcode");t.appView.analytics.setPageName("T:Inventory:TDA_Redirect"),t.appView.fireIS("117.110",{device_type:t.appView.analytics.deviceType,tda_code:r,zip_code:r})}d.trigger("inventory:loaded","error")},getSetUrl:function(){var e={avalonhybrid:"avalon-hybrid",camryhybrid:"camry-hybrid",highlanderhybrid:"highlander-hybrid",priusc:"prius-c",priusv:"prius-v",fjcruiser:"fj-cruiser",landcruiser:"land-cruiser","prius-plug-in":"prius"},t=window.location.toString().split("#!"),i=t[1]||"",a=i.split("/"),r=a[3]&&a[3].toLowerCase()||"",n=e[r]||r;return n+"?originating_zip_code="+o.cookie("zipcode")},getGstUrl:function(){var e,t={"4runner":"Crossovers|4Runner",avalon:"Cars|Avalon",camry:"Cars|Camry",corolla:"Cars|Corolla",fjcruiser:"Crossovers|FJ Cruiser",highlander:"Crossovers|Highlander",landcruiser:"Crossovers|Land Cruiser",matrix:"Cars|Matrix",prius:"Hybrids-EVs|Prius",rav4:"Crossovers|RAV4",sequoia:"Crossovers|Sequoia",sienna:"Cars|Sienna",tacoma:"Trucks|Tacoma",tundra:"Trucks|Tundra",yaris:"Cars|Yaris",venza:"Crossovers|Venza",priusc:"Hybrids-EVs|Prius c",priusv:"Hybrids-EVs|Prius v",camryhybrid:"Hybrids-EVs|Camry Hybrid",avalonhybrid:"Hybrids-EVs|Avalon Hybrid",highlanderhybrid:"Hybrids-EVs|Highlander Hybrid","prius-plug-in":"Prius-Plug-in|Prius Plug-in",rav4ev:"RAV4-EV|RAV4 EV"},i=window.location.toString(),a=i.split("/")[l.indexOf(i.split("/"),"results")+2],r="Advanced/Pages/",n=t[a]&&t[a].split("|")[1];return n?(e=encodeURIComponent(t[a].split("|")[1]),r+=/prius-plug-in|rav4ev/.test(a)?"VehicleLandingPage.aspx?style=Hybrids-EVs&model=3rd_Gen_Prius&":"View/Model/"+e+"/Records/20/SortBy/0/?",r+="zip="+o.cookie("zipcode")):void 0},onGstContinueBtnClicked:function(){var e=this;e.appView.analytics.setPageName("T:Inventory:TDA_Redirect"),e.appView.fireIS("117.112",{device_type:e.appView.analytics.deviceType,tda_code:o.cookie("zipcode"),zip_code:o.cookie("zipcode")})},isVisible:function(){return this.$el.hasClass("is-on")},show:function(){var e=this;e.appView.landing.hide(),e.appView.results.hide(),e.appView.details.hide(),e.$el.addClass("is-on"),d.trigger("inventory:loaded","error"),d.on("zipcode:changed",e.onZipChange,e),d.on("zipcode:blur",e.onZipBlur,e)},hide:function(){var e=this;e.$el.removeClass("is-on"),d.off("zipcode:changed",e.onZipChange,e),d.off("zipcode:blur",e.onZipBlur,e)},render:function(e){var t=this;t.$el.html(e)}});return h}),define("sitAppView",["sit","ritZipcodeChanger","app/views/rit/landing","app/views/rit/results","app/views/rit/details","app/views/rit/errors","ritLoading"],function(e,t,i,a,r,n,s){var o=e.$,l=e._,c=e.Backbone,d=e.Events,u=e.$document,p=e.$body,_=p.children(".load-layer"),h=e.Analytics,f=c.View.extend({debugging:{timeToInteract:timetoInteract},initialize:function(e){var s=this;window.TCOM.getGlobal(),d.on("inventory:loading",s.onInventoryLoading,s),d.on("inventory:loaded",s.onInventoryLoaded,s),s.inventory=e.inventory,s.inventory.on("change:currentView",o.proxy(s.switchPage,s)),s.inventory.on("change:disclaimers",o.proxy(s.updateDisclaimers,s)),s.inventory.on("change:zipcode",function(){l.delay(s.updateRegionDisclaimer,800)}),s.analytics=h,s.analytics.getTags("inventorysearch"),o("#header-zip-code").html((new t).el),s.initializeDisclaimers(),s.landing=new i({el:o("#landing"),appView:s,router:e.router}),s.results=new a({el:o("#results"),model:e.inventory,appView:s,router:e.router}),s.details=new r({el:o("#details"),model:e.inventory,appView:s,router:e.router}),s.errors=new n({el:o("#sit-errors"),model:e.inventory,appView:s,router:e.router}),s.hookAppErrorTags()},onInventoryLoading:function(){_.show().mask(),p.removeClass("load-relative").addClass("modal-open")},onInventoryLoaded:function(){var e=this;if(l.defer(function(){_.hide().unmask(),p.removeClass("modal-open")}),debuggerOn&&!l.isEmpty(e.debugging)){var t=(new Date).valueOf();l.each(e.debugging,function(e,i){console.timeEnd(i),o("#debuggerBox").append("<p>"+i+": "+(t-e)+"ms</p>")}),e.debugging={}}},hookAppErrorTags:function(){var e=this;d.on("SIT:service:fail",function(){e.fireIS("117.6",{inventory_error_type:"SERVICE_ERROR"})}),d.on("SIT:zipcode:fail",function(){e.fireIS("117.6",{inventory_error_type:"ZIPCODE_ERROR"})})},fireIS:function(){var t=this,i=arguments[0]||"117.X",a=arguments[1]||{},r=t.analytics,n=(t.inventory.filters,o.cookie("zipcode"));a=l.extend({current_pagename:r.currentPageName(),tda_code:e.tdaCode,device_type:r.deviceType,zip_code:n},a),r.fire("inventorysearch",i,a)},switchPage:function(e){var t=this;o("#sit-errors #error-zip").is(":visible")===!1?(t.errors.hide(),t.landing.hide(),t.results.hide(),t.details.hide(),d.trigger("inventory:loading"),t[t.inventory.get("currentView")].show(),u.scrollTop(0),"landing"===t.inventory.get("currentView")&&_.hide()):d.trigger("inventory:loaded","error")},updateHeader:function(e){var t=o(".page-header.header");e.title&&t.find("h1").text(e.title),e.subTitle&&t.find(".page-header-sub").text(e.subTitle)},initializeDisclaimers:function(){var t=this;e.$disclaimers.find("li").addClass("default"),require(["organisms/disclaimers/js/disclaimers"],function(e){t.disclaimers=new e({el:"#tcom-disclaimers"})})},resetDisclaimers:function(){e.$disclaimers.find("li").not(".default").remove(),e.appDisclaimers={}},updateDisclaimers:function(){var t=this,i=t.inventory.get("disclaimers"),a=e.$disclaimers.find("li:lt(8)").length,r="";t.resetDisclaimers(),l.each(i,function(t,i){var n=t.code?t.code.toLowerCase():"*",s=t.attributes.description.value,o=i+a+1;s=s.replace(/(\w)\s*®/gi,"$1<sup>®</sup>"),e.appDisclaimers[n]=o,e.API.isGST()&&"msrp"===n&&(s=e.strings[e.i18n.lang].gstMSRP),r+='<li class="tcom-disclaimers-item" data-code="'+n+'">'+o+". "+s+"</li>"}),e.$disclaimers.append(r),t.updateRegionDisclaimer()},updateRegionDisclaimer:function(){var t=e.$disclaimers.find("li:eq(0)");e.API.isGST()?t.text(e.strings.gstMSRP):t.text(e.strings.nationalMSRP)}});return f}),define("app/models/picks",["sit"],function(e){var t=(e.RIT,e._),i=e.$,a=(e.Config,e.Backbone),r=e.Events,n="grade",s={year:"",series:"",grade:"",model:"",bed:"",cab:"",engine:"",drive:"",transmission:"",exteriorcolor:[],interiorcolor:[],accessory:[],priceMin:-1,priceMax:-1,featurePicks:[],colorPicks:[],routerPicks:{}},o=a.Model.extend({validPicks:["model","bed","cab","engine","drive","transmission","exteriorcolor","interiorcolor","accessory"],defaults:t.clone(s),initialize:function(e){var a=this;a.inventory=e.inventory,t.bindAll(a,"setPick"),a.on("change:series",i.proxy(a.updateGradeType,a))},setPick:function(i){var a=this,s=e.API.getFeatureByCodePrefix(i);if(s){if(s.type===n){a.resetPicks();e.API.getGradeByCode(s.code);return"grade-subgrade"===n?(a.set(n,s.code),r.trigger("SIT:change:grade"),!0):"grade-subgrade"!==n?(a.set(n,s.code),r.trigger("SIT:change:grade"),!0):!1}return t.contains(["model","exteriorcolor","interiorcolor","accessory"],s.type)?(a.set(s.type,a.get(s.type)?a.get(s.type).concat([s.code]):[s.code]),!0):(a.set(s.type,s.code),!0)}},removePick:function(i){var a=this,n=e.API.getFeatureByCodePrefix(i),s=a.get("featurePicks"),o=a.get("colorPicks"),l=[];return"exteriorcolor"===n.type||"interiorcolor"===n.type?(s.length&&(l=l.filter("."+s.join(",."))),o=t.without(o,i),l=o.length?l.filter("."+o.join(",.")):l,l=a.filterResultsByMsrp(l),l.length>0?(a.set("colorPicks",o),a.set(n.type,t.without(a.get(n.type),n.code)),r.trigger("SIT:change:picks"),!0):!1):(s=t.without(s,i),l=s.length?l.filter("."+s.join(",.")):l,o.length&&(l=l.filter("."+o.join(",."))),l=a.filterResultsByMsrp(l),l.length>0?(a.set("featurePicks",s),a.set(n.type,"accessory"===n.type?t.without(a.get("accessory"),n.code):""),r.trigger("SIT:change:picks"),!0):!1)},parsePicks:function(a){var s=this;return a?s.set("routerPicks",a):a=s.get("routerPicks"),t.isObject(a)&&a.year&&a.series?((s.get("series")!==a.series||s.get("year")!==a.year)&&(s.resetPicks(),s.set("year",a.year),s.set("series",a.series),s.unset("grade"),s.unset("grade-subgrade"),r.trigger("SIT:change:series")),void i.when(s.inventory.sessionReady).then(function(){s.updateGradeType();var o=!1;if(a.grade&&"undefined"!==a.grade&&s.get(n)!==a.grade){s.resetPicks();var l=e.API.getGradeByCode(a.grade);"grade-subgrade"===n?(l&&e.API.setPick(l.id,null,!0),s.set(n,a.grade),o=!0):"grade-subgrade"!==n&&(e.API.setPick(a.grade,n,!0),s.set(n,a.grade),o=!0)}if(!s.get(n)){s.resetPicks();var c=e.API.getDefaultGrade();if(!c||!c.code)return void r.trigger("SIT:error:oos");if("grade-subgrade"===n)c&&e.API.setPick(c.id,null,!0),s.set(n,c.code),o=!0;else{if("grade-subgrade"===n)return;e.API.setPick(c.code,n,!0),s.set(n,c.code),o=!0}}var d=s.allPicks(),u=[];t.each(s.validPicks,function(i){var r=a[i];t.isArray(r)?t.each(r,function(t){t&&(e.API.setPick(t,i,!0),u.push(e.API.getCodePrefix(t,i)))}):r&&(e.API.setPick(r,i,!0),u.push(e.API.getCodePrefix(r,i)))});var p=t.filter(d,function(e){return t.indexOf(u,e)});p.length&&t.each(p,function(e){s.removePick(e)});var _=t.filter(u,function(e){return t.indexOf(d,e)});if(_.length&&t.each(_,function(e){s.setPick(e)}),r.trigger("SIT:change:picks"),a.sort&&e.API.setSortOrder(a.sort),a.page&&e.API.setPageNumber(a.page),a.msrp){var h=a.msrp.split("-");e.API.setRangeConstraint(h[0],h[1],!0)}a.msrp?i.when(e.API.getFiltersDeferred(),e.API.getSetRangeDeferred()).then(function(t,i){e.API.triggerResults(!0)}):i.when(e.API.getFiltersDeferred()).then(function(t){e.API.triggerResults(!0)})})):(r.trigger("SIT:show:landing"),!1)},resetPicks:function(i){var a=this,r=["series","year","routerPicks"];i&&t.isArray(i)?r=t.union(r,i):i&&(r=t.union(r,[i]));var n=t.omit(t.clone(s),r);a.set(n,{silent:!0}),e.API.setCurrentPicks(a.attributes)},resetAllPicks:function(i){var a=this,r=[],n=t.omit(t.clone(s),r);a.set(n,{silent:!0}),e.API.setCurrentPicks(a.attributes)},allPicks:function(){var e=this;return e.get("featurePicks").concat(e.get("colorPicks"))},setPriceMin:function(e){var t=this,i=t.get("priceMin");if(e=parseInt(e,10),i===e)return!1;e||0===e?e>=t.inventory.filters.get("minMsrp")&&e<=t.inventory.filters.get("maxMsrp")&&e<=t.get("priceMax")&&t.set("priceMin",e):t.set("priceMin",-1);var a=t.filterResultsByMsrp();return a&&0!==a.length?!0:(t.set("priceMin",i),!1)},setPriceMax:function(e){var t=this,i=t.get("priceMax");if(e=parseInt(e,10),i===e)return!1;e||0===e?e<=t.inventory.filters.get("maxMsrp")&&e>=t.inventory.filters.get("minMsrp")&&e>=t.get("priceMin")&&t.set("priceMax",e):t.set("priceMax",-1);var a=t.filterResultsByMsrp();return a&&0!==a.length?!0:(t.set("priceMax",i),!1)},filterResultsByMsrp:function(e){var t=this,a=t.get("priceMax"),r=t.get("priceMin"),n=t.get("featurePicks"),s=t.get("colorPicks");return e||(e=[],n.length&&(e=e.filter("."+n.join(",."))),s.length&&(e=e.filter("."+s.join(",.")))),a>=0&&r>=0&&(e=e.filter(function(){var e=i(this).data("msrp");return e&&a>=e&&e>=r?!0:!1})),e},updateGradeType:function(){var e=this,t=e.get("series");n="tacoma"===t?"cab":"corolla"===t||"sienna"===t?"grade-subgrade":"grade"},unsetNonSeriesPicks:function(){var e=this;t.each(["model","cab","bed","engine","drive","transmission","exteriorcolor","interiorcolor","accessory","price","page","sort"],function(t){e.unset(t)})}});return o}),define("app/models/grades",["sit"],function(e){var t=(e.RIT,e._),i=(e.$,e.Config,e.Backbone),a=e.Events,r=i.Model.extend({defaults:{grades:[]},initialize:function(e){var t=this;t.inventory=e.inventory},reset:function(){},load:function(){var i=this;a.trigger("SIT:grades:load");var r=e.API.getGrades();r=t.map(r,function(e){return"rav4ev"===e.code&&(e.series="RAV4 EV",e.title="FWD"),e}),i.set("grades",r),a.trigger("SIT:grades:success")}});return r}),define("app/models/filters",["sit"],function(e){var t=(e.RIT,e._),i=e.$,a=(e.Config,e.Backbone),r=e.Events,n=a.Model.extend({defaults:{filters:[]},initialize:function(e){var t=this;t.inventory=e.inventory,r.on("SIT:filters:changed",i.proxy(t.onFiltersChanged,t)),r.on("SIT:grade:picked",t.onGradePicked,t)},onGradePicked:function(a){debuggerOn&&console.log("onGradePicked:",a);var n=this;n.inventory.picks.resetPicks(),n.reset(),n.load(),n.inventory.picks.set("sort","asc"),i("#results-sort-vehicles").val("asc").trigger("liszt:updated").trigger("chosen:updated"),i.when(e.API.getFiltersDeferred(),e.API.getResultsDeferred(),e.API.getFacetCountsDeferred()).then(function(){t.defer(function(){r.trigger("inventory:loaded","results")})})},onFiltersChanged:function(){},
getActiveFilters:function(){var e={};return i("#filters .accordion-body").each(function(){var a=i("input:checked",this);e[i(this).data("type")]=t.map(a,function(e){return i(e).val().split("_")[1]}).join("")}),e},getFilterPath:function(){var e=[];return i("#filters .accordion-group").each(function(){var a=i("input:checked",this);e.push(t.map(a,function(e){return i(e).val().split("_")[1]}).join(""))}),e.join("/")},reset:function(){e.API.resetFilters()},load:function(){var t=this;r.trigger("SIT:filters:load"),i.when(e.API.getFilters()).then(function(e){t.onSuccess(e)})},onSuccess:function(e){var t=this;t.set("filters",e,{silent:!1}),r.trigger("SIT:filters:success")},onFail:function(){r.trigger("SIT:filters:fail")}});return n}),define("app/models/results",["sit"],function(e){var t=(e._,e.$,e.Backbone),i=e.Events,a=(e.RIT,t.Model.extend({defaults:{results:[],sort:"asc",page:1},initialize:function(e){var t=this;t.inventory=e.inventory},load:function(t){var a=this;i.trigger("SIT:results:load");var r=e.API.getResults();return r&&r.success===!0?a.onSuccess(r):a.onFail(r),r},onSuccess:function(e){var t=this;t.set("results",e.results),t.set("sort","asc"),i.trigger("SIT:results:success")},onFail:function(){i.trigger("SIT:results:fail")},setSort:function(e){}}));return a}),define("app/models/details",["sit"],function(e){var t=e._,i=e.$,a=e.Backbone,r=e.Events,n=(e.RIT,a.Model.extend({defaults:{details:{},picks:{},resultsUrl:""},initialize:function(e){var t=this;t.inventory=e.inventory},load:function(a){var n=this;return r.trigger("SIT:details:load"),t.isObject(a)&&a.year&&a.series?((n.inventory.picks.get("series")!==a.series||n.inventory.picks.get("year")!==a.year)&&(n.inventory.picks.resetPicks(),n.inventory.picks.set("year",a.year),n.inventory.picks.set("series",a.series),r.trigger("SIT:change:series")),n.set("picks",a),void i.when(n.inventory.sessionReady).then(function(){i.when(e.API.getDetails(a)).then(function(e){n.onSuccess(e,a)})})):(r.trigger("SIT:show:landing"),!1)},onSuccess:function(e,t){var i=this;i.set("details",e),r.trigger("SIT:details:success")},onFail:function(){r.trigger("SIT:details:fail")}}));return n}),define("app/models/inventory",["sit","app/promises","app/models/picks","app/models/grades","app/models/filters","app/models/results","app/models/details"],function(e,t,i,a,r,n,s){var o=(e.RIT,e._),l=e.$,c=(e.Config,e.Backbone),d=e.Events,u=!0,p=0,_=c.Model.extend({sessionReady:l.Deferred(),threedReady:l.Deferred(),defaults:{zipcode:"",region:"",dealers:null,currentView:""},initialize:function(){var t=this;t.set(t.defaults,{silent:!0}),t.picks=new i({inventory:t}),t.grades=new a({inventory:t}),t.filters=new r({inventory:t}),t.results=new n({inventory:t}),t.details=new s({inventory:t}),t.on("change:currentView",function(e){u="results"===e.changed.currentView}),t.once("change:region",function(){"pending"!==t.sessionReady.state()&&(t.sessionReady=l.Deferred()),t.picks.get("year")&&t.picks.get("series")&&t.get("region")&&o.isArray(t.get("dealers"))&&e.API.initializeSession(o.extend({},t.picks.attributes,{region:t.get("region"),dealers:t.get("dealers")}))}),t.on("change:dealers",function(){console.log("change dealers"),"pending"!==t.sessionReady.state()&&(t.sessionReady=l.Deferred()),t.picks.get("year")&&t.picks.get("series")&&t.get("region")&&o.isArray(t.get("dealers"))&&(debuggerOn&&console.log("dealers:",t.get("dealers")),e.API.initializeSession(o.extend({},t.picks.attributes,{region:t.get("region"),dealers:t.get("dealers")})))}),d.on("SIT:change:series",function(){"pending"!==t.sessionReady.state()&&(t.sessionReady=l.Deferred()),t.picks.get("year")&&t.picks.get("series")&&t.get("region")&&o.isArray(t.get("dealers"))&&e.API.initializeSession(o.extend({},t.picks.attributes,{region:t.get("region"),dealers:t.get("dealers")}))}),d.on("SIT:api:session:ready",function(){debuggerOn&&console.debug("new session ready"),t.picks.set("year",e.API.getCurrentYear().code),t.picks.set("series",e.API.getCurrentSeries().code),p>0&&"details"===t.get("currentView")&&c.history.loadUrl(c.history.fragment),t.set("disclaimers",e.API.getDisclaimers()),t.sessionReady.resolve(),t.grades.reset(),console.warn("_sessionCount:",p),p>0&&"results"===t.get("currentView")&&(e.API.setDefaultGrade(),t.picks.parsePicks(),e.API.removeRangeConstraint(),t.results.load(),e.API.triggerResults(),t.filters.reset(),t.filters.load(),d.trigger("SIT:pick:changed"),console.warn("doing it:",p),l.when(e.API.getResultsDeferred()).then(function(){o.defer(function(){d.trigger("inventory:loaded","results")})})),d.trigger("SIT:session:picks:ready"),u=!1,p++}),d.on("SIT:threed:session:ready",function(){t.threedReady.resolve()}),d.on("SIT:change:grade",function(){d.trigger("inventory:loading"),o.defer(function(){t.grades.load();t.results.load();t.picks.resetPicks([e.API.getGradeType()]),t.filters.reset(),t.filters.load()})}),d.on("SIT:change:picks",function(){t.filters.load(),t.grades.load()}),d.on("SIT:filter:changed",function(i){debuggerOn&&console.log("SIT:filter:changed:",i);var a;i.id&&(debuggerOn&&console.time("pick:time:"+i.id),d.trigger("inventory:loading"),a=e.API.getFeatureByID(i.id),i.isChecked?e.API.setPick(i.id):e.API.removePick(i.id),t.picks.unsetNonSeriesPicks(),o.each(e.API.getCurrentUserPicks(),function(e,i){/model|cab|bed|engine|drive|transmission|exteriorcolor|interiorcolor|accessory/.test(i)?t.picks.set(i,o.pluck(e,"code"),{silent:!0}):t.picks.set(i,o.first(e).code,{silent:!0})}),e.API.isAGrade(a)||(l.when(e.API.getFiltersDeferred()).then(function(){debuggerOn&&console.time("Update Facets"),d.trigger("SIT:update:filters"),debuggerOn&&console.timeEnd("Update Facets")}),t.whenResultsAndCountDeferred()),d.trigger("SIT:pick:changed"),debuggerOn&&console.timeEnd("pick:time:"+i.id))}),d.on("SIT:sort:changed",function(t){e.API.setSortOrder(t.sort),e.API.triggerResults()})},whenResultsAndCountDeferred:function(){l.when(e.API.getResultsDeferred()).then(function(){console.warn("results")}),l.when(e.API.getFacetCountsDeferred()).then(function(){console.warn("counts")}),l.when(e.API.getRangeDeferred()).then(function(){console.warn("range")}),l.when(e.API.getResultsDeferred(),e.API.getFacetCountsDeferred(),e.API.getRangeDeferred()).then(function(){o.defer(function(){console.warn("should be done"),d.trigger("inventory:loaded","results")})})}});return _}),require(["sit","app/api/api-wrapper","app/promises","app/router","sitAppView","app/models/inventory"],function(e,t,i,a,r,n){var s=e.$,o=e._,l=e.Backbone,c=e.Events;window.SIT=e;var d=(new Date).valueOf(),u=new t;e.API=u;var p=new n,_=new a({inventory:p}),h=new r({inventory:p,router:_});e.appView=h,c.on("SIT:region:ready",function(t){c.trigger("inventory:loading"),debuggerOn&&console.log("region:ready",t.regionCode);var a=t.success&&t.regionCode?t.regionCode+"0":"NATIONAL";s.when(i.dealers()).then(function(t){var i=t&&t.tdaCode||"N/A",r=t&&t.dealerCodes||[];e.tdaCode=i,p.set("region",a),p.set({dealers:r},{silent:!1})})}),c.on("SIT:dealers:ready",function(e){if(debuggerOn&&console.log("dealers:ready",e),e&&o.isArray(e.dealerCodes)){var t=p.get("dealers");o.isArray(t)&&(t=t.join("")),t!==e.dealerCodes.join("")}}),c.on("SIT:dealers:fail",function(){debuggerOn&&console.log("dealers:fail"),p.set("dealers",[]),i.dealers().resolve()}),c.on("router:navigate",function(e,t){t=t||{},_.navigate(e,t)}),window.TCOM?i.initialize({inventory:p}):s(document).on("TCOM:ready",function(){i.initialize({inventory:p})}),e.API.isEspanol()&&i.initialize({inventory:p}),isAPIReady===!0?l.history.start():c.on("SIT:api:ready",function(){l.history.start()}),c.on("SIT:api:session:ready",function(){"landing"!==p.get("currentView")&&h.results.updateSeriesHeaders();var e,t;debuggerOn&&(s("#debuggerBox").show(),e=(new Date).valueOf()-timetoInteract,t=(new Date).valueOf()-d,s("#debuggerBox").html(s("#debuggerBox").html()+"<br> Time to interact: "+e))}),window.tcom.pubsub.subscribe("tcom.geolocation.zipcode.change",function(e,t){c.trigger("zipcode:changed",t.zipcode)}),u.initAPI({apiWrapper:u,router:_,inventory:p,appView:h})}),define("js/main",function(){});