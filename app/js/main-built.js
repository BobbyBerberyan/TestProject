define("lodash-mixins",[],function(){function a(a){var c=/\s*\[[\w\-]+\]/gi,d=/\]\s*\,\s*\[/g,e={msrp:1,epa_2014:2,epa_2015:2,epa_2016:2,features_options_interactive:3,msrp_total:8};return{stripDisclaimer:function(a){return a.replace(/\[.*?\]/g,"")},makeStrong:function(a){return"<strong>"+a+"</strong>"},mod:function(a,b){return a-b*Math.floor(a/b)},crush:function(b){return a.flatten(a.map(b,a.values))},randomRange:function(a,b){return Math.round(Math.random()*(b-a)+a)},formatNumber:function(a){return String(a).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},toDollarAmount:function(a){return parseInt(String(a).replace(/\$|\,|\.00/gi,""),10)||0},formatPrice:function(a,b){var c=this.toDollarAmount(a);return 0!==c||b?this.toDollar(c):""},toNumber:function(a){var b=String(a).replace(/^\D+|\,/g,""),c=parseInt(b,10);return!isNaN(c)&&c||0},toDollar:function(a){return"$"+this.formatNumber(a)},parseDisclaimer:function(a){return this.linkDisclaimer(a)},linkDisclaimer:function(b){if(!session||"string"!=typeof b)return b;var f=b.search(c)>-1;return f&&(b=b.replace(d,"]<sup>,</sup> ["),a.each(b.match(c),function(a){var c=$.trim(a);c=c.substring(c.indexOf("[")+1,c.length-1).toLowerCase(),index=e[c]||SIT.appDisclaimers&&SIT.appDisclaimers[c]||parseInt(window.SIT.$disclaimers.find('[data-disclaimer="'+c+'"]').attr("id"),10)||0,"number"==typeof index&&index>=0&&(b=b.replace(a,'<sup data-code="'+c+'" data-disclaimer="'+c+'">'+index+"</sup>"))})),b},validateZipCode:function(a){return/^[0-9]{5}$/.test(a)},cloneDeep:function(a,c){if("object"!=typeof a)return a;if(b.isString(a))return a.splice();if(b.isDate(a))return new Date(a.getTime());if(b.isFunction(a.clone))return a.clone();var d=b.isArray(a)?a.slice():b.extend({},a);if(!b.isUndefined(c)&&c>0)for(var e in d)d[e]=b.deepClone(d[e],c-1);return d}}}var b=window.TCOM._;b.mixin(a(b))}),define("app/sit/i18n",[],function(){return{en:{title:"New Toyota Inventory Search",subTitle:"Finding a Toyota in stock near you has never been easier.",noResults:"We were unable to locate your exact vehicle match. Here are some other recommendations.",totalMSRPDisclaimer:"Total MSRP (includes optional equipment plus delivery [DPH]) Delivery [DPH]",filters:{cab:"Cabs",bed:"Beds",drive:"Drive",engine:"Engines",transmission:"Transmissions",exteriorcolor:"Exterior",interiorcolor:"Interior",packages:"Packages &amp; Options",accessory:"Accessories",accessories:"Accessories",price:"Price"},modelyear:"ModelYear",series:"Series",model:"Model",totalmsrp:"Total MSRP",engine:"Engine",transmission:"Transmission",color:"Color",exterior:"Exterior",interior:"Interior",availableoptions:"Available Options",detailFeatures:{exteriorFeatures:"Exterior",interiorFeatures:"Interior",safetyFeatures:"Safety/Convenience"},contactdealer:"Contact a Dealer",calculatepayment:"Calculate Payment",applyforfinancing:"Apply for Financing",printdetails:"Print Details",emaildetails:"Email Details",errors:{apologies:"Our Apologies",technicalDifficulties:"We are having some technical difficulties.",meantime:"Please try again later. In the meantime, you can:",findDealer:"Find a dealer near you.",dealerLocator:"Dealer Locator",findDeals:"Find great deals in your area.",localSpecials:"Local Specials",returnToHome:"Return to the homepage.",home:"Home",oneMore:"One More Thing...",allWeNeed:"Okay, now all we need is your ZIP Code.",itWillHelp:"It will help us find the Toyota you're looking",itWillHelpBr:"for in your area."},nationalMSRP:"1. Manufacturer's Suggested Retail Price, excludes the Delivery, Processing and Handling Fee of $825 for Cars, $885 for Small/Light Trucks (Sienna, RAV4, Highlander Gas, Highlander HV, 4Runner, Tacoma and Venza), $1100 for Large Trucks (Tundra), and $925 for Large SUVs (Sequoia and Land Cruiser). (Historically, vehicle manufacturers and distributors have charged a separate fee for processing, handling and delivering vehicles to dealerships. Toyota's charge for these services is called the \"Delivery, Processing and Handling Fee\" and is based on the value of the processing, handling and delivery services Toyota provides as well as Toyota's overall pricing structure. Toyota may make a profit on the Delivery, Processing and Handling Fee.) Excludes taxes, license, title and available or regionally required equipment. The Delivery, Processing and Handling Fee in AL, AR, FL, GA, LA, MS, NC, OK, SC and TX will be higher. Actual dealer price will vary.",gstMSRP:"1. Manufacturer's Suggested Retail Price, excludes the Delivery, Processing and Handling Fee of $890 for Cars, $950 for Small/Medium Trucks (Sienna, RAV4, Highlander Gas, Highlander HV, 4Runner, Tacoma and Venza), $1,195 for Large Trucks (Tundra), and $1,095 for Large SUVs (Land Cruiser and Sequoia). (Historically, vehicle manufacturers and distributors have charged a separate fee for processing, handling and delivering vehicles to dealerships. Toyota's charge for these services is called the \"Delivery, Processing and Handling Fee\" and is based on the value of the processing, handling and delivery services Toyota provides as well as Toyota's overall pricing structure. Toyota may make a profit on the Delivery, Processing and Handling Fee.) Excludes taxes, license, title and available or regionally required equipment. The MSRP price is only valid in TX, OK, AR, MS, and OK. Actual dealer price will vary."},es:{title:"Búsqueda en el inventario de nuevos Toyota",subTitle:"Encontrar un Toyota disponible en tu área nunca ha sido más fácil.",noResults:"No pudimos ubicar el vehículo exacto de tu búsqueda. Aquí tienes algunas otras recomendaciones.",totalMSRPDisclaimer:"Total MSRP (includes optional equipment plus delivery [DPH]) Delivery [DPH]",filters:{cab:"Cabs",bed:"Beds",drive:"Drives",engine:"Engines",transmission:"Transmissions",exteriorcolor:"Exterior",interiorcolor:"Interior",packages:"Packages &amp; Options",accessory:"Accessories",accessories:"Accessories",price:"Price"},modelyear:"ModelYear",series:"Series",model:"Model",totalmsrp:"Total MSRP",engine:"Engine",transmission:"Transmission",color:"Color",exterior:"Exterior",interior:"Interior",availableoptions:"Available Options",detailFeatures:{exteriorFeatures:"Exterior",interiorFeatures:"Interior",safetyFeatures:"Safety/Convenience"},contactdealer:"Contact a Dealer",calculatepayment:"Calculate Payment",applyforfinancing:"Apply for Financing",printdetails:"Print Details",emaildetails:"Email Details",errors:{apologies:"Our Apologies",technicalDifficulties:"We are having some technical difficulties.",meantime:"Please try again later. In the meantime, you can:",findDealer:"Find a dealer near you.",dealerLocator:"Dealer Locator",findDeals:"Find great deals in your area.",localSpecials:"Local Specials",returnToHome:"Return to the homepage.",home:"Home",oneMore:"Algo más...",allWeNeed:"Solo necesitamos tu código postal.",itWillHelp:"Nos ayudará a encontrar el Toyota que buscas",itWillHelpBr:"en tu área."},nationalMSRP:"1. Manufacturer's Suggested Retail Price, excludes the Delivery, Processing and Handling Fee of $825 for Cars, $885 for Small/Light Trucks (Sienna, RAV4, Highlander Gas, Highlander HV, 4Runner, Tacoma and Venza), $1100 for Large Trucks (Tundra), and $925 for Large SUVs (Sequoia and Land Cruiser). (Historically, vehicle manufacturers and distributors have charged a separate fee for processing, handling and delivering vehicles to dealerships. Toyota's charge for these services is called the \"Delivery, Processing and Handling Fee\" and is based on the value of the processing, handling and delivery services Toyota provides as well as Toyota's overall pricing structure. Toyota may make a profit on the Delivery, Processing and Handling Fee.) Excludes taxes, license, title and available or regionally required equipment. The Delivery, Processing and Handling Fee in AL, AR, FL, GA, LA, MS, NC, OK, SC and TX will be higher. Actual dealer price will vary.",gstMSRP:"1. Manufacturer's Suggested Retail Price, excludes the Delivery, Processing and Handling Fee of $890 for Cars, $950 for Small/Medium Trucks (Sienna, RAV4, Highlander Gas, Highlander HV, 4Runner, Tacoma and Venza), $1,195 for Large Trucks (Tundra), and $1,095 for Large SUVs (Land Cruiser and Sequoia). (Historically, vehicle manufacturers and distributors have charged a separate fee for processing, handling and delivering vehicles to dealerships. Toyota's charge for these services is called the \"Delivery, Processing and Handling Fee\" and is based on the value of the processing, handling and delivery services Toyota provides as well as Toyota's overall pricing structure. Toyota may make a profit on the Delivery, Processing and Handling Fee.) Excludes taxes, license, title and available or regionally required equipment. The MSRP price is only valid in TX, OK, AR, MS, and OK. Actual dealer price will vary."}}}),define("app/sit/config",[],function(){return{categories:[{id:"cars-minivan",name:"Cars & Minivan"},{id:"trucks",name:"Trucks"},{id:"crossovers-suvs",name:"Crossovers & SUVs"},{id:"hybrids-evs",name:"Hybrids & EVs"}],resultsPerPage:25,c3iSeriesMapping:{priusv:"prius",priusc:"prius",avalonhybrid:"avalon",camryhybrid:"camry",highlanderhybrid:"highlander",rav4ev:"rav4",fjcruiser:"fj"},regionRedirectURLs:{HI:"http://www.toyota-hawaii.com/Distributor/Toyota/Dealerships/Default.aspx",PR:"http://www.toyotapr.com/concesionarios",GST:"http://www.gulfstates.buyatoyota.com/",SET:"http://southeast.buyatoyota.com",SET_ESP:"http://www.comprauntoyota.com"},general_service_error:"Sorry, something went wrong. Please try again later.",results_empty_error:"No vehicles match your criteria. Try adjusting your filters and searching again.",series_fail_error:"Unable to retrieve inventory from server, please refresh the page to try again.",geo_location_errors:["An unknown error has occurred retrieving your current location. Please manually input your zip code in the form field provided.","You have denied touch.toyota.com access to your current location. Please manually input your zip code in the form field provided.","Your position is currently unavailable. Please manually input your zip code in the form field provided.","Your position is currently unavailable. [timeout] Please manually input your zip code in the form field provided."],general_geo_error:"Geolocation is not available at this time. Please try again later.",browser_geo_error:"Geolocation is not supported by this browser.",out_of_stock_errror:"Sorry, this trim is currently out of stock.",get_cache_info:"/configws/cacheInfo?brand=toyota&format=json&lang=en",get_disclaimers_path:"/configws/static/modelTrims?brand=toyota&format=json&lang=en&region=10011&zzc={{cacheStamp}}&modelCode={{trimId}}&return=all",get_series_path:"/ToyotaSite/rest/lscs/getDocument?templatePath=templatedata/TComVehiclesData/Series/data/CombinedSeries.xml",get_zip_code_path:"/toyotaSite/dealerLocator/locateDealers.do?",verify_zip_code_path:"/ToyotaSite/rest/dealerLocator/getRegionCode?brandId=1&zipCode=",get_inventory_base_path:"/ToyotaSite/rest/inventory/getInventory?facet=true&",get_inventory_detail_base_path:"/ToyotaSite/rest/inventory/getInventoryDetail",results_per_page:5}}),define("sit",["lodash-mixins","app/sit/i18n","app/sit/config"],function(a,b,c){var d=window.TCOM,e=d.Util,f=d.Analytics,g=d.Geolocation,h=e.i18n,i=d.$,j={$:d.$,_:d._,Backbone:window.Backbone,i18n:h,lang:h.lang,Util:e,Events:window.Backbone.Events,Geolocation:g,Analytics:f,$document:i(document),$window:i(window),$html:i("html"),$body:i("body"),cookie:d.cookie,$app:i("#sit-wrapper"),$disclaimers:i("#tcom-disclaimers .tcom-disclaimers-list"),mq:e.mq,getCurrentQuery:function(){return this.mq("phone")&&"phone"||this.mq("smallTablet")&&"smallTablet"||this.mq("tablet")&&"tablet"||this.mq("desktop")&&"desktop"||!1},blanksrc:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",Config:c};return j.$dom={document:j.$document,window:j.$window,html:j.$html,body:j.$body,app:j.$app},j.strings=b[j.lang],j.firstLoad=!0,j.touchsite="tmob"===d.Util.site,j.CurrentQuery=j.getCurrentQuery(),j.ltie9=j.$dom.html.hasClass("lt-ie9")?!0:!1,j.ltie9&&(j.mq=function(a){return"desktop"===a?!0:!1}),Modernizr.iconFonts=!0,j}),define("app/api/controller",["sit"],function(a){var b=a.$,c=(a._,a.RIT,a.Backbone,a.Events,function(a){var c,d,e=shaParam||b.cookie("efcsha");return debuggerOn&&console.log("controller options:",a),c=new efcinvapi.InventorySearchController,""!==e&&null!==e&&(b.cookie("efcsha",e),c.setSha(e)),c.setServerURL(a.server),c.setBrand(a.brand),c.setRegion(a.region),c.setLanguage(a.language),c.setYearCode(a.year),c.setSeriesCode(a.series),a.dealers&&a.dealers.length&&c.setDealerCodes(a.dealers),d=c.createSession(),{instance:c,promise:d}});return c}),define("app/api/api-wrapper",["sit","app/api/controller"],function(a,b){var c,d=a.$,e=a._,f=(a.RIT,a.Backbone),g=a.Events,h=null,i={},j={},k={},l={},m={},n="grade",o=[],p={},q="",r={},s={},t=null,u=2e4,v=0,w=null,x=null,y=null,z=0,A=1,B=0,C="asc",D=null,E=null,F=null,G=[],H=a.Config,I=null,J=null,K=null,L=null,M=null,N=null,O=null,P=null,Q=null,R=null,S=null,T=f.Model.extend({initialize:function(){var a=this,b=a.isTouchSite();debuggerOn&&console.log("api-wrapper:constructor"),c=a,z=b?H.results_per_page:H.resultsPerPage,g.on("SIT:pick:picked",c.onPickPicked),g.on("SIT:pick:removed",c.onPickRemoved)},initAPI:function(a){var b=this,c=0;b.options=a,g.on("SIT:region:ready",function(a){t&&clearTimeout(t),a&&a.regionCode&&50!==a.regionCode&&(t=setTimeout(function(){isAPIReady===!1&&g.trigger("SIT:api:fail")},u))}),isAPIError===!0&&g.trigger("SIT:api:fail"),isAPIReady===!0?b.onAPIReady():c=setInterval(function(){isAPIReady===!0&&(clearInterval(c),b.onAPIReady()),isAPIError===!0&&(clearInterval(c),g.trigger("SIT:api:fail"))},100)},onAPIReady:function(){g.trigger("SIT:api:ready")},getSessionLanguage:function(){return"EN"},initializeSession:e.debounce(function(a){c._initializeSession(a)},100),_initializeSession:function(a){var b=c;sitInstance=new efcsolrapi.SolrInventorySearchController,J=a,sitInstance.setServerURL(b.getSessionURL()),sitInstance.setBrand("TOY"),sitInstance.setRegion(a.region),sitInstance.setLanguage(b.getSessionLanguage()),sitInstance.setCompressQuery(!0),sitInstance.setYearCode(a.year),sitInstance.setSeriesCode(a.series),a.dealers.length>0&&sitInstance.setDealerCodes(a.dealers),sitInstance.createSession().done(b.onConfigSessionComplete).fail(b.onConfigSessionFailure)},initializeThreedSession:function(){var a=this,b=new efcthreedapi.ThreedController;S=new d.Deferred,b.setServerURL(a.getSessionURL()),b.setBrand("TOY"),b.setRegion(J.region),b.setLanguage(a.getSessionLanguage()),b.setYearCode(J.year),b.setSeriesCode(J.series),b.createSession().done(a.onThreedSessionComplete).fail(a.onThreedSessionFailure)},getSessionURL:function(){return window.location.protocol+"//"+window.location.hostname+":"+window.location.port+"/search-inventory-ws/config"},onConfigSessionComplete:function(a){console.debug("onConfigSessionComplete:",a);var b=c;debuggerOn&&(console.timeEnd("SESSION TIME"),d("#debuggerBox").html(d("#debuggerBox").html()+"<br> API Content Init: "+((new Date).valueOf()-v))),window.session=a,h=a,h.apiWrapper=c,c.options.apiWrapper=c,d.when(b.runPostInitAssociations()).then(function(){console.debug("session and init complete."),s=h.getContent(),g.trigger("SIT:api:session:ready")},c.onPromiseFail)},onConfigSessionFailure:function(){console.error("onConfigSessionFailure:",arguments),g.trigger("SIT:error:oos")},onThreedSessionComplete:function(a){console.debug("onThreedSessionComplete:",a),window.threedsession=a,debuggerOn&&(d("#debuggerBox").show(),threedInitEnd=(new Date).valueOf()-threedInit,console.log("Threed Session Ready: "+threedInitEnd),d("#debuggerBox").html(d("#debuggerBox").html()+"<br> Threed Session Ready: "+threedInitEnd)),g.trigger("SIT:threed:session:ready"),S.resolve()},onThreedSessionFailure:function(){console.error("onThreedSessionFailure:",arguments)},runPostInitAssociations:function(){var a=this,b=new d.Deferred;return a.removeRangeConstraint(),d.when(h.getTrueFeaturesByType("series"),h.getTrueFeaturesByType("year")).then(function(f,g){console.log("arguments:",arguments),console.debug("series:",f," year:",g),m=e.first(f)||{},l=e.first(g),m.code=J.series,a.isAVirtualSeries(m.code)&&(m.title=a.getVirtualSeriesTitleByCode(m.code)),i={},n="tacoma"===m.code?"cab":"corolla"===m.code||"sienna"===m.code?"grade-subgrade":"grade",d.when(a.getGradeData()).then(function(){console.debug("grades ready:",o),b.resolve()},c.onPromiseFail)},c.onPromiseFail),b},getGradeData:function(){var a=this,b=new d.Deferred;return"grade-subgrade"===n?h.getFeaturesByTypeByModelObject(["model"]).then(function(c){o=e.chain(c.model).uniq(function(a){return a.grade.code+"-"+a.subgrade.code}).map(function(b){var d=b.grade,e=b.subgrade,f=a.getSubgradeCount(c.model,b.grade,b.subgrade);return{code:d.code+""+e.code,prefix:"GRDSUB_"+d.code+e.code,altprefix:"GRD_"+d.code+"-SGR_"+e.code,title:(d.title+" "+e.title).replace(/^\s+|\s+$/g,""),id:d.id+"-"+e.id,type:"grade-subgrade",typeName:"Subgrade",grade:d,subgrade:e,count:f}}).value(),b.resolve()},c.onPromiseFail):h.getFeaturesByTypeByModelObject([n]).then(function(c){o=e.chain(c[n]).map(function(b){return{code:b.code,prefix:a.getCodePrefix(b.code,b.type),altprefix:a.getCodePrefix(b.code,b.type),title:b.title,id:b.id,type:b.type,typeName:"Subgrade",count:b.count}}).value(),b.resolve()},c.onPromiseFail),b},getSubgradeCount:function(a,b,c){return e.chain(a).filter(function(a){return a.grade.code===b.code&&a.subgrade.code===c.code}).map(function(a){return a.count}).reduce(function(a,b){return a+b},0).value()},getImagePaths:function(b,c,d,e,f){try{var g=window.threedsession;if(void 0!==g&&g.getImagePaths){var h=g.getImagePaths(b,c,d,e,f);return h}return debuggerOn&&console.log("getImagePaths not defined!",g),[a.blanksrc]}catch(i){return debuggerOn&&console.log("_session.getImagePaths: Path Not Found!",i),[a.blanksrc]}},getGrades:function(){var a=this.getDefaultGrade();return e.each(o,function(b){b.isPicked=a.id===b.id,b.series=m.title}),o},getArrayOrValue:function(a){return a.length>0?e.first(a):a},getModelTitle:function(a){var b=this;return/rav4ev|fjcruiser|landcruiser|prius|priusc|priusv/gi.test(a.series.code)?a.attributes.description.value:b.getArrayOrValue(a.series).title+" "+(a.grade&&b.getArrayOrValue(a.grade).title||"")+" "+(a.subgrade&&b.getArrayOrValue(a.subgrade).title||"")+("tacoma"===a.series.code&&b.getArrayOrValue(a.cab).title||"")},parseMatch:function(b,c){var d=this,f=e.findWhere(a.UnfilteredSeriesList,{modelCode:m.code,modelYear:parseInt(l.code,10)}),g=n.split("-")[0];if(f&&(l.title=f.displayYear),!b||!b.features||!b.features.length)return!1;var j=e.find(b.features,function(a){return a.indexOf("MDL_")>=0?!0:!1});if(!j)return!1;var k=d.getModelByCode(j.replace("MDL_",""));if(k){c&&(k.cab&&b.features.push(h.getCodePrefix(k.cab[0]||k.cab)),k.bed&&b.features.push(h.getCodePrefix(k.bed[0]||k.bed)),k.engine&&b.features.push(h.getCodePrefix(k.engine[0]||k.engine)),k.drive&&b.features.push(h.getCodePrefix(k.drive[0]||k.drive)),k.transmission&&b.features.push(h.getCodePrefix(k.transmission[0]||k.transmission)));var o=k.accessories.concat(k.exteriorcolor).concat(k.interiorcolor).concat([k.bed,k.engine,k.cab,k.drive,k.transmission]),q={base_msrp:k.attributes.msrp.value,trim_id:k.code,delivery:k.attributes.destinationfee.value,title:d.getModelTitle(k),seriesCode:k.series.code,seriesName:k.series.code,grade:k[g][0]?k[g][0].title:k[g].title+(k.subgrade?" "+k.subgrade.title:""),displayYear:l.title,displayName:k.attributes.description.value,year:l.code,image:k.images.anchorimage&&k.images.anchorimage.url||"",engine:k.engine.title,transmission:k.transmission.title,msrp:b.msrp,displayMsrp:e.formatPrice(b.msrp),totalMsrp:e.formatPrice(b.msrp),details:"",model:{},accessories:[],packages:[],accessoriesList:[],msrps:{packageMsrps:e.chain(k.packages).pluck("price").map(function(a){return e.toNumber(a)}).reduce(function(a,b){return a+b},0).toDollarAmount().value(),accessoryMsrps:e.map(k.packages,function(a){return{name:a.title,accessoryCode:a.code,msrp:a.attributes.msrp&&e.toDollarAmount(a.attributes.msrp.value)}})}},r={model:k.code,exteriorcolor:"",interiorcolor:"",packages:[]};return e.each(b.features,function(b){var c;c=i[b]?i[b]:d.getFeatureByCodePrefix(b),c&&(modelFeature=e.find(o,function(a){return a.code===c.code}),modelFeature&&(c=modelFeature),"accessory"===c.type?(q.packages.push(c),q.accessoriesList.push({accessoryCode:c.code,amount:(c.attributes.msrp.value||"0.0").replace("$",""),description:c.title,source:"port"}),r.packages.push(c.code),window.convertCamryHalfYear&&"14.5MY"===c.title&&(q.displayYear="2014.5")):"exteriorcolor"===c.type?(q.exteriorcolor=c.title,q.exteriorcolorcode=c.code,q.hex="#"+(c.attributes.hexvalue.value||"00FF00"),r.exteriorcolor=c.code,c.images&&c.images.carjellyimage&&c.images.carjellyimage.url?q.jelly=0===c.images.carjellyimage.url.indexOf("/config")?"/search-inventory-ws"+c.images.carjellyimage.url:c.images.carjellyimage.url:k.images&&k.images.anchorimage&&k.images.anchorimage.url?q.jelly=0===k.images.anchorimage.url.indexOf("/config")?"/search-inventory-ws"+k.images.anchorimage.url:k.images.anchorimage.url:q.jelly=a.blanksrc):"interiorcolor"===c.type?(q.interiorcolor=c.title,q.interiorcolorcode=c.code,q.swatch=c.images&&c.images.onswatchimage&&c.images.onswatchimage.url?c.images.onswatchimage.url:a.blanksrc,r.interiorcolor=c.code):"model"===c.type?(q.model.code=k.code,q.model.prefix=b,q.model.id=k.id):"year"===c.type&&c.title.toString()!==c.code.toString()?q[c.type]=c.code:q[c.type]=c.title||"")}),q.details="/details/"+l.code+"/"+m.code+"/"+p.code+"/"+r.model+"/"+r.exteriorcolor+"/"+r.interiorcolor+"/"+r.packages.join("-"),q.contentId=l.code+r.model+r.exteriorcolor+r.interiorcolor+r.packages.join(""),q.zipCode=I,q}},getResults:function(){var a=this,b="tundra"===m.code?!0:!1;return F=[],E?(e.isArray(E)&&E.length&&e.each(E,function(c,d){var e=a.parseMatch(c,b);e&&F.push(e)}),{success:!0,results:F}):void 0},resetFilters:function(){var a=this,b=new d.Deferred,e="tundra"===m.code,f=["accessory","exteriorcolor","interiorcolor"],g=["cab","bed","engine","drive","transmission"],h=e?g.concat(f):["model"].concat(f);return d.when(a.getFeatureFilters(h)).then(function(c){r=c,a.updateCurrentPrefixes(),b.resolve()},c.onPromiseFail),b},getFilters:function(){var b=this,f=[],g=new d.Deferred,h=b.getDefaultGrade();return L=new d.Deferred,D=b.getUserPickIds(),b.removeNonGradePicks(),d.when(b.resetFilters()).then(function(){b.setBackUserPicks(),e.each(r,function(b,c){var d="model"===c?"<span>"+l.title+"</span> "+h.title:a.strings.filters[c];f.push({title:d,type:c,filters:b})}),g.resolve(f),L.resolve(f)},c.onPromiseFail),g},updateCurrentPrefixes:function(){K=e.chain(r).map(function(a){return e.pluck(a,"prefix")}).flatten().value()},getFeatureFilters:function(a){var b=this,f=new d.Deferred;return h.getFeaturesByTypeByModelObject(a).then(function(a){var c=a.accessories_sorted,d=e.chain(a).map(function(a,d){var f=null;switch(d){case"accessories":return f=e.map(c.FIO,function(a){return b.getCustomFeature(a)}),["packages",f];case"accessories_sorted":return f=e.map([].concat(c.PIO,c.DIO,c.LIO),function(a){return b.getCustomFeature(a)}),["accessories",f];default:return f=e.map(a,function(a){return b.getCustomFeature(a)}),[d,f]}}).compact().object().value();f.resolve(d)},c.onPromiseFail),f},getAccessoriesFiltersData:function(a){},getCustomFeature:function(b){var c=this,d={};return d.id=b.id,d.code=b.code,d.count=b.count,d.type=b.type,d.title=b.title,d.prefix=c.getCodePrefix(b.code,b.type),d.isPicked=c.isPicked(b.id),d.isDisabled=!(b.count>0),"exteriorcolor"===b.type&&(d.hex="#"+(b.attributes.hexvalue&&b.attributes.hexvalue.value||"f0f")),"interiorcolor"===b.type&&(d.swatch=b.images&&b.images.onswatchimage&&b.images.onswatchimage.url?b.images.onswatchimage.url:a.blanksrc),d},getDetails:function(b){var f=this,k=["grade","model","bed","cab","engine","drive","transmission","exteriorcolor","interiorcolor","accessory"],l=new d.Deferred,o=b.model,p=f.getModelByCode(o);if(!p.id)return g.trigger("SIT:error:oos"),{success:!1};var q={};q.year=[f.getCodePrefix(b.year,"year")],q.series=[f.getCodePrefix(b.series,"series")],e.each(k,function(a){var c=b[a];if("accessory"===a)q[a]=[],e.each(c,function(b){q[a].push(f.getCodePrefix(b,"accessory"))});else if("grade"===a&&"grade-subgrade"===n){var d=i["GRDSUB_"+c];d&&(q.grade=["GRD_"+d.grade.code],q.subgrade=["SGR_"+d.subgrade.code])}else"grade"===a&&"tacoma"===m.code?q.cab=["CAB_"+c]:c&&(q[a]=[f.getCodePrefix(c,a)])});var r="tundra"===m.code?!0:!1;return h.getVehicleMatchPagination("EXACT",10,!0,q).then(function(c){var h=c.getResults();if(h&&h.length){var i=f.getExactPickMatch(b,h),k=i&&[i];if(!k)return void g.trigger("SIT:error:oos");var m=e.map(k,function(a){var b=e.filter(a.getPicks(),function(a){return-1===a.indexOf("msrp_")?!0:!1});return e.each(b,function(a){j[a]=!0}),{features:b,msrp:a.getMsrp()}}),n=s,o=f.parseMatch(m[0],r),q=p.year.code,s=p.year.title,t=p.series.code,u=p.series.title,v=p.grade[0]?p.grade[0].code:p.grade.code,w=p.attributes.description.value,x=m[0].msrp,y=f.getModelFeature(p,b.exteriorcolor,"exteriorcolor"),z=f.getModelFeature(p,b.interiorcolor,"interiorcolor"),A=[];e.each(b.accessory,function(a){var b=f.getModelFeature(p,a,"accessories");b&&b.title&&A.push({title:b.title,description:b.attributes.description.value})});var B=f.getStandardFeaturesFromPicks(b);o.displayYear&&(n=o.displayYear);var C={resultsUrl:"#!/results/"+q+"/"+t+"/"+v,year:n,seriesName:u,seriesCode:t,modelName:p.title,modelCode:p.code,trimName:w,msrp:x,displayMsrp:e.formatPrice(x),engine:e.isArray(p.engine)?p.engine[0].title:p.engine.title,transmission:e.isArray(p.transmission)?p.transmission[0].title:p.transmission.title,exteriorcolor:y.title,hex:y.attributes.hexvalue.value,interiorcolor:z.title,swatch:z.images&&z.images.onswatchimage&&z.images.onswatchimage.url?z.images.onswatchimage.url:a.blanksrc,packages:A,standardFeatures:B,zipcode:d.cookie("zipcode"),resultModel:o};return l.resolve(C),{success:!0,results:C}}return g.trigger("SIT:error:oos"),{success:!1}},c.onPromiseFail),l},getStandardFeaturesFromPicks:function(a){var b=h.getStandardFeaturesByCode(h.seriesCode,"series"),c=[];if(b&&b.standardFeatures){var d=e.findWhere(b.standardFeatures,{modelCode:a.model}).standardFeaturesArray;d=e.map(d,function(a){return a.group=a.group.replace(/^\s+|\s+$/g,""),a}),d=e.filter(d,function(a){return"S"===a.value&&("Exterior"===a.group||"Interior"===a.group||"Safety/Convenience"===a.group)}),c=e.groupBy(d,"group")}return c},setDetailPicks:function(a){var b=["grade","model","bed","cab","engine","drive","transmission","exteriorcolor","interiorcolor","accessory"];e.each(b,function(b){var c=a[b];"accessory"===b&&e.isArray(c)?e.each(c,function(a){h.setPick(a,b)}):c&&h.setPick(c,b)})},getDataForContactDealer:function(a){var b=this,c=(b.getImagePaths("exterior",1,!1,"380_214_PNG"),{isConfig:!0,accessoriesList:e.map(a.packages,function(a){return{code:a.code,msrp:e.toNumber(a.attributes.msrp.value),source:"factory",name:a.title,longDescription:a.attributes.description.value}}),driveName:a.drive&&a.drive.title||"",engine:a.engine,bedName:a.bed&&a.bed.title||"",cabName:a.cab&&a.cab.title||"",grade:a.grade+(a.subgrade?" "+a.subgrade.title:""),image:a.jelly,seriesName:a.seriesCode,deliveryFee:a.delivery,engineName:a.engine,exteriorColor:a.exteriorcolor,exteriorColorCode:a.exteriorcolorcode,exteriorColorName:a.exteriorcolor,displayName:a.title,totalMsrp:a.displayMsrp.replace("$",""),msrpTotal:a.displayMsrp.replace("$",""),interiorColor:a.interiorcolor,exterior_color_name:a.exteriorcolor,exterior_color_code:a.exteriorcolorcode,interior_color_name:a.interiorcolor,interior_color_code:a.interiorcolorcode,modelCode:a.trim_id,modelYear:a.displayYear,year:a.year,trimId:a.trim_id,modelId:"n/a",modelSeries:"n/a",msrp:a.base_msrp,name:a.title,seriesCode:a.seriesCode,tdaCode:"N/A",transmission:a.transmission,transmissionName:a.transmission,modelDisplayYear:a.displayYear,packages:a.packages,msrps:{base:a.base_msrp,packageMsrps:e.chain(k.packages).pluck("price").map(function(a){return e.toNumber(a)}).reduce(function(a,b){return a+b},0).toDollarAmount().value(),accessoryMsrps:e.map(a.packages,function(a){return{name:a.title,accessoryCode:a.code,msrp:a.attributes.msrp&&e.toDollarAmount(a.attributes.msrp.value)}})}});return c},setPick:function(a,b,c){var d=this,f=null,i=null,j=null,k=null;return b?(f=h.getFeatureByCode(a,b),f&&(d.isAGrade(f)&&d.removeAllPicks(),d.setAPick(f),d.onAfterPick(f))):(i=a.split("-"),i.length>1?(d.removeAllPicks(),k=h.getTrueFeaturesByType("subgrade")[0],k&&h.removePick(k.code,"subgrade"),e.each(i,function(a){f=h.getFeatureByID(a),f&&(d.setAPick(f),d.onAfterPick(f))})):(f=h.getFeatureByID(a),f&&(d.isAGrade(f)&&d.removeAllPicks(),d.setAPick(f),d.onAfterPick(f)))),c||g.trigger("SIT:pick:picked",j||f),!0},isAColor:function(a){return/color/.test(a.type)},setAPick:function(a){h.setPick(a.code,a.type)},onAfterPick:function(a){var b=this;b.isAGrade(a)&&(p=a)},removePick:function(a,b){if(debuggerOn&&console.log("removePick:",a,b),a&&!b){var c=h.getFeatureByID(a);if(!c.id)return!1;a=c.code,b=c.type}return console.log("Removing Pick:",c.code,c.type),h.removePick(c.code,c.type),g.trigger("SIT:pick:removed"),!0},resetUserPicks:function(){var a=c.getUserPickIds();e.each(a,function(a){var b=h.getFeatureByID(a);b.type!==n&&"grade"!==b.type&&"subgrade"!==b.type&&h.removePickID(a)})},getColorPicks:function(){var a=e.isArray(k.exteriorcolor)?e.pluck(k.exteriorcolor,"prefix"):[],b=e.isArray(k.interiorcolor)?e.pluck(k.interiorcolor,"prefix"):[];return a.concat(b)},getDisclaimers:function(){return h.getDisclaimers()},getDisclaimerCodes:function(){return h.getDisclaimerCodes()},isOptionById:function(a){return"option"===a.substr(0,6)},isPackage:function(a){return a.isPackage===!0&&a.isALaCarte===!1},isOption:function(a){return a.isPackage===!1&&a.isALaCarte===!1},isAccessory:function(a){return a.isPackage===!1&&a.isALaCarte===!0},session:function(){return h},getFeatureByCodePrefix:function(a){if(i[a])return i[a];if(a){var b=h.getFeatureByCodePrefix(a);return b&&b.title?(i[a]=b,b):b?b:null}return null},getCodePrefix:function(a,b){return h.getCodePrefix({code:a,type:b})},setCurrentPicks:function(a){k=a},getCurrentYear:function(){return l},getCurrentSeries:function(){return m},getCurrentGrade:function(){return p},getCurrentGradePrefix:function(){return q},getModelByCode:function(a){return e.find(s.model,function(b){return b.code===a})},getModelFeature:function(a,b,c){if(c="accessory"===c?"accessories":c,a&&b&&c&&a[c]){var d=e.find(a[c],function(a){return a.code===b});return d?d:h.getFeatureByCode(b,c)}return h.getFeatureByCode(b,c)},getGradeByCode:function(a){var b=null;return e.isArray(o)&&o.length&&(b=e.find(o,function(b){return b.code===a})),b},getDefaultGrade:function(){var a,b,c=this;return"grade-subgrade"===n?(a=e.first(session.getTrueFeaturesByType("grade")),b=e.first(session.getTrueFeaturesByType("subgrade")),a&&b?c.findGradeById(a.id+"-"+b.id):e.first(o)):(a=e.first(session.getTrueFeaturesByType(n)),a?c.findGradeById(a.id):e.first(o))},findGradeById:function(a){return e.find(o,function(b){return b.id===a})},getGradeType:function(){return n},isGST:function(){return 60===w?!0:!1},setRegionCode:function(a){w=a},getTDACode:function(){return k},onPickPicked:function(a,b){debuggerOn&&console.log("onPickPicked");var e=c,f="asc"===C;M=new d.Deferred,e.isAGrade(a)&&e.removeRangeConstraint(),debuggerOn&&console.time("First Page of Results"),h.getVehicleMatchPagination("EXACT",A*z,f).then(function(c){x=c,y=x.getResults(),debuggerOn&&console.timeEnd("First Page of Results"),debuggerOn&&console.time("Results Total Count"),B=x.getMatchCount(),debuggerOn&&console.timeEnd("Results Total Count"),b||(A=1),debuggerOn&&console.time("Results Parse"),e.parseMatches("first-page"),debuggerOn&&console.timeEnd("Results Parse"),
a&&e.isAGrade(a)&&g.trigger("SIT:grade:picked",a)},c.onPromiseFail)},onPickRemoved:function(){debuggerOn&&console.log("onPickRemoved");var a=c,b="asc"===C;M=new d.Deferred,debuggerOn&&console.time("First Page of Results"),h.getVehicleMatchPagination("EXACT",A*z,b).then(function(b){x=b,y=x.getResults(),debuggerOn&&console.timeEnd("First Page of Results"),debuggerOn&&console.time("Results Total Count"),B=h.getFacetCount(session.getUserPicks(!0)),debuggerOn&&console.timeEnd("Results Total Count"),A=1,debuggerOn&&console.time("Results Parse"),a.parseMatches("first-page"),debuggerOn&&console.timeEnd("Results Parse")},c.onPromiseFail)},parseMatches:function(a,b){var d=c,f=B>A*z,h=null;E=e.map(y,function(a){var b=e.filter(a.getPicks(),function(a){return-1===a.indexOf("msrp_")?!0:!1});return e.each(b,function(a){j[a]=!0}),{features:b,msrp:a.getMsrp()}}),h=d.getResults().results,(0===h.length||0===B||h.length<z)&&(f=!1),b||g.trigger("SIT:results",{results:h,matchCount:B,pageType:a,showMoreButton:f}),G="first-page"===a?h:G.concat(h),M.resolve(h)},isPickable:function(a){return!0},isPicked:function(a){var b=this,c=(h.getFeatureByID(a),b.isAUserPick(a));return c},isAUserPick:function(a){return e.contains(D,a)},getNextPageOfResults:function(){var a=this;debuggerOn&&console.log("getNextPageOfResults"),A++,debuggerOn&&console.time("Next Page of Results"),x.getNextPage().then(function(b){y=b.getResults(),debuggerOn&&console.timeEnd("Next Page of Results"),debuggerOn&&console.time("Next Page Results Parse"),a.parseMatches("next-page"),debuggerOn&&console.timeEnd("Next Page Results Parse")},c.onPromiseFail)},removeNonGradePicks:function(){debuggerOn&&console.log("removeNonGradePicks:");var a=this,b=null,c=a.getUserPickIds();e.each(c,function(c){b=h.getFeatureByID(c),a.isAGrade(b)||h.removePick(b.code,b.type)}),A=1,C="asc"},removeAllPicks:function(){var a=this,b=null,c=a.getUserPickIds();e.each(c,function(a){b=h.getFeatureByID(a),h.removePick(b.code,b.type)}),A=1,C="asc"},isAGrade:function(a){return a?"grade"===a.type||"subgrade"===a.type||a.subgrade||"tacoma"===m.code&&"cab"===a.type:!1},getCurrentUserPicks:function(){var a=this;return e.chain(a.getUserPickIds()).map(function(a){return h.getFeatureByID(a)}).groupBy(function(a){return a.type}).value()},getQueryParamOrder:function(){var a=["exteriorcolor","interiorcolor","accessory","sort","page","msrp"];return"tundra"===m.code?a.unshift("cab","bed","engine","drive","transmission"):a.unshift("model"),a.unshift("year","series","grade"),a},getCurrentQueryParams:function(){var a=this,b=a.getCurrentUserPicks(),c=m.code,d=l.code,f=a.getQueryParamOrder();return e.chain(f).map(function(f){return"year"===f?d:"series"===f?c:"grade"===f&&"grade-subgrade"===n?a.getDefaultGrade().code:/model|cab|bed|engine|drive|transmission|exteriorcolor|interiorcolor|accessory/.test(f)&&b[f]?e.chain(b[f]).pluck("code").join("-").value():"sort"===f?C:"page"===f?A:"msrp"===f&&P?P.min+"-"+P.max:b[f]&&e.first(b[f]).code||""}).join("/").value()},getFeatureByID:function(a){var b=a.split("-");return b.length>1?e.find(o,function(a){return a.id}):h.getFeatureByID(b[0])},setSortOrder:function(a){C=a},getSortOrder:function(){return C},setPageNumber:function(a){A=parseInt(a,10)},getPageNumber:function(){return A},triggerResults:function(a){var b=this;g.trigger("inventory:loading"),b.onPickPicked(null,a)},setDefaultGrade:function(){var a=c,b="asc"===C;M=new d.Deferred,a.setPick(a.getDefaultGrade().id,null,!0),debuggerOn&&console.time("First Page of Results"),h.getVehicleMatchPagination("EXACT",A*z,b).then(function(b){x=b,y=x.getResults(),debuggerOn&&console.timeEnd("First Page of Results"),debuggerOn&&console.time("Results Total Count"),B=h.getFacetCount(session.getUserPicks(!0)),debuggerOn&&console.timeEnd("Results Total Count"),debuggerOn&&console.time("Results Parse Silent"),a.parseMatches(null,!0),debuggerOn&&console.timeEnd("Results Parse Silent")},c.onPromiseFail)},getResultsByPage:function(a){},getCurrentParsedResults:function(){return F},getCurrentResults:function(){return E},getTotalParsedResults:function(){return G},getExactPickMatch:function(a,b){return e.find(b,function(b){var c=e.chain(b.getPicks()).filter(function(a){return"ACY_"===a.substr(0,4)}).map(function(a){return a.replace(/ACY_/gi,"")}).value();return 0===e.difference(c,a.accessory).length})},getCurrentModelObj:function(){var a=h.getTrueFeaturesByType("model")[0].id,b=e.find(s.model,function(b){return a===b.id});return b},isTouchSite:function(){return/touch.toyota.com|\-touch.html/gi.test(window.location)},isEspanol:function(){return/\/espanol/gi.test(window.location)},setBackUserPicks:function(){var a=this;e.each(D,function(b){a.isAGrade(h.getFeatureByID(b))||a.setPick(b,null,!0)})},setCurrentZipCode:function(a){I=a},getCurrentZipCode:function(){return I},getUserPickIds:function(){return e.compact(h.getUserPicks())},getFacetCounts:function(){var a=new d.Deferred;return N=new d.Deferred,h.getFacetCount(K).then(function(b){a.resolve(b),N.resolve()},c.onPromiseFail),a},getFiltersDeferred:function(){return L},getResultsDeferred:function(){return M},getFacetCountsDeferred:function(){return N},getRangeDeferred:function(){return O},getMSRPRange:function(){var a=new d.Deferred;return O=new d.Deferred,debuggerOn&&console.time("getMSRPRange"),h.getMSRPRange().then(function(b){a.resolve(b),O.resolve(b),debuggerOn&&console.timeEnd("getMSRPRange")},c.onPromiseFail),a},setRangeConstraint:function(a,b,e){var f=this,g=new d.Deferred;return R=new d.Deferred,N=new d.Deferred,P={min:a,max:b},d.when(f.getMSRPRange()).then(function(d){d.min&&d.max||c.removeRangeConstraint(),Q={min:d.min,max:d.max},h.setRangeConstraint("msrp",a,b),g.resolve(),O.resolve(),R.resolve()},c.onPromiseFail),g},removeRangeConstraint:function(){P=null,h.removeRangeConstraint("msrp")},getCurrentMSRPRange:function(){return P},getPreviousMSRPRange:function(){return Q},getSetRangeDeferred:function(){return R},getFixedPicksThreed:function(){var a=new d.Deferred;return h.getFixedPicksThreed().then(function(b){a.resolve(b)},c.onPromiseFail),a},isAVirtualSeries:function(a){return/camryhybrid|avalonhybrid|highlanderhybrid/.test(a)},getVirtualSeriesTitleByCode:function(b){return e.findWhere(a.UnfilteredSeriesList,{modelCode:b,modelYear:parseInt(l.code,10)}).modelName},getCurrentPrefixes:function(){return K},onPromiseFail:function(){g.trigger("SIT:service:fail")},getThreedDeferred:function(){return S}});return T}),define("app/collections/series",["sit"],function(a){var b=(a.RIT,a._),c=(a.$,a.Config,a.Backbone),d=(a.Events,a.Util),e=c.Collection.extend({vehicleSort:["Yaris","Corolla","Camry","Avalon","Sienna","Tacoma","Tundra","RAV4","Venza","Highlander","FJ Cruiser","4Runner","Sequoia","Land Cruiser","Camry Hybrid","Avalon Hybrid","RAV4 EV","Highlander Hybrid","Prius","Prius c","Prius Plug-in","Prius v"],initialize:function(){},url:function(){return d.lscs_base+"TComVehiclesData/Series/data/CombinedSeries.xml"},parse:function(c){var d=this,e={},f=c.Root.Series;return window.Series=f,b.map(f,function(a){a.DriveTrain=a.DriveTrain.split(/[\s,]+/),a.Engine=a.Engine.split(/[\s,]+/),a.modelCategory=a.modelCategory.split(/[\s,]+/),a.price=b.toDollar(a.BaseMsrp),a.asShownAs=a.asShownAs?b.toDollar(a.asShownAs):null,a.imageModelName=d.getImageModelName(a),a.displayYear=a.displayYear||a.modelYear,a.multiYear="",e[a.modelCode]=e[a.modelCode]?e[a.modelCode]+1:1}),b.each(f,function(a){e[a.modelCode]>1&&(a.multiYear=a.displayYear+" "),"camryhybrid"===a.modelCode||"avalonhybrid"===a.modelCode||"highlanderhybrid"===a.modelCode?a.imgName=a.imageModelName+"-hybrid.png":"prius-plug-in"===a.modelCode?(a.modelCode="priusplugin",a.imgName="base.png"):a.imgName="base.png"}),a.UnfilteredSeriesList=f,a.SeriesList=b.filter(f,function(a){return a.inAppDisplay&&a.inAppDisplay.searchinventory}),a.SeriesList},getImageModelName:function(a){return a.LinkedSeries&&""!==a.LinkedSeries?a.LinkedSeries:a.modelCode},getSeriesList:function(){return this},getSeriesListByCategory:function(a){var c=this;return b.chain(this.models).filter(function(c){return b.contains(c.get("modelCategory"),a)}).sortBy(function(a){return b.indexOf(c.vehicleSort,a.get("modelName"))}).value()},getSeriesCategories:function(){return b.chain(this.pluck("modelCategory")).flatten().unique().value()}});return e}),define("app/promises",["sit","app/collections/series"],function(a,b){function c(a){a?(o=new h.Deferred,debuggerOn&&(s=(new Date).valueOf()),h.getJSON(w+a,function(b){u=!0;var c=d(b);c.valid&&c.response.success?(debuggerOn&&(t=(new Date).valueOf()-s,h("#debuggerBox").html(h("#debuggerBox").html()+"<br> DIS Lookup: "+t)),k.trigger("SIT:region:ready",b),o.resolve({regionCode:b.regionCode,zipcode:a})):c.response.success?(k.trigger("SIT:region:fail",c),o.reject({reason:"region",redirect_url:c.redirectURL,region_code:c.regionCode})):(k.trigger("SIT:service:fail"),o.reject({reason:"region",redirect_url:c.redirectURL,region_code:c.regionCode}))}).fail(function(){u=!0,k.trigger("SIT:region:fail",{}),o.reject({})})):(u=!0,k.trigger("SIT:region:fail"),o.reject())}function d(a){var b=50,c="toyotahawaii",d="toyotapr",f=[b],g=[c,d],h={valid:!0,response:a};return(i.contains(f,a.regionCode)||i.find(g,function(b){return new RegExp(b,"gi").test(a.redirectUrl)}))&&(h.valid=!1,h.regionCode=a.regionCode||0,h.redirectURL=e(a)),h}function e(a){var b=50,c=60,d=l.regionRedirectURLs;if(/hawaii.com/gi.test(a.redirectUrl))return d.HI;if(/pr.com/gi.test(a.redirectUrl))return d.PR;if(a.regionCode===c)return d.GST;if(a.regionCode===b){var e=-1!==i.indexOf(window.location.toString().split("/"),"espanol")?d.SET_ESP:d.SET,f={avalonhybrid:"avalon-hybrid",camryhybrid:"camry-hybrid",highlanderhybrid:"highlander-hybrid",priusc:"prius-c",priusv:"prius-v",fjcruiser:"fj-cruiser",landcruiser:"land-cruiser","prius-plug-in":"prius"},g=window.location.toString().split("#!"),j=g[1]||"",k=j.split("/"),m=k[3]&&k[3].toLowerCase()||"",n=f[m]||m;return e+"/"+n+"?originating_zip_code="+h.cookie("zipcode")}}function f(a){a?(p=new h.Deferred,h.getJSON(x+a,function(a){if(v=!0,a&&a.tdaGroups&&a.tdaGroups[0]&&a.tdaGroups[0].dealers&&a.tdaGroups[0].dealers.length){var b=i.pluck(a.tdaGroups[0].dealers,"dealerCode");console.debug("triggering dealers ready"),k.trigger("SIT:dealers:ready",{dealerCodes:b}),p.resolve({dealerCodes:b,tdaCode:a.tdaGroups[0].tdaCode})}else k.trigger("SIT:dealers:fail"),p.reject()}).fail(function(a){v=!0,k.trigger("SIT:dealers:fail",a),p.reject()})):(v=!0,k.trigger("SIT:dealers:fail"),p.reject())}function g(b){var d=m.on("sync",function(a,b,c){q.resolve(a)},this).fetch();d.fail(function(){q.reject()}),n.done(function(d){"pending"!==o.state()&&(o=h.Deferred()),"pending"!==p.state()&&(p=h.Deferred()),a.API.setCurrentZipCode(d),b.inventory.set("zipcode",d),c(d),f(d),i.delay(function(){u===!1&&"pending"===o.state()&&o.reject(),v===!1&&"pending"===p.state()&&p.reject()},2e4)}).fail(function(){a.touchsite&&window.location.hash.length>1,k.trigger("SIT:zipcode:fail"),k.trigger("inventory:loaded","error")}),r.done(function(b){j.setZip(b),k.trigger("SIT:refresh:count"),k.trigger("zipcode:changed",b),a.API.setCurrentZipCode(b)}),k.on("zipcode:changed",i.debounce(function(d,e){var g=d;k.trigger("SIT:refresh:count"),a.API.setCurrentZipCode(g),"pending"!==o.state()&&(o=h.Deferred()),"pending"!==p.state()&&(p=h.Deferred()),b.inventory.set("zipcode",g),c(g),f(g)},500,!0))}var h=a.$,i=a._,j=a.Geolocation,k=a.Events,l=a.Config,m=new b,n=j.getZip(),o=new h.Deferred,p=new h.Deferred,q=new h.Deferred,r=new h.Deferred,s=0,t=0,u=!1,v=!1,w=(a.touchsite?"/toyotaSite":"/ToyotaSite")+"/rest/dealerLocator/getRegionCode?brandId=1&zipCode=",x=(a.touchsite?"/toyotaSite":"/ToyotaSite")+"/rest/dealerLocator/dealerPoolV2?zipCode=",y={initialize:g,zipCode:function(){return n},zipEntry:function(){return r},region:function(){return o},series:function(){return q},dealers:function(){return p},passed:function(){return i.every([q,n,p,o],function(a){return"pending"!==a.state()})},setZip:function(b){j.setZip(b),j.getZip().done(function(b){a.API.setCurrentZipCode(b),c(b),f(b)})}};return y}),define("app/router",["sit"],function(a){var b=a.$,c=a._,d=a.i18n,e=a.Backbone,f=a.Events,g=0,h=e.Router.extend({archived_series:["matrix"],initialize:function(a){var b=this;window.rt=this,b.appView=a.appView,b.inventory=a.inventory,b.inventoryDetail=a.inventoryDetail,f.on("SIT:pick:changed",b.setRouteByCurrentPicks,b)},routes:{"":"landing","!/landing":"landing","!/landing/:deepLink":"landing","!/results/:year/:series(/)(*query)":"results","!/details/:year/:series(/)(*query)":"details"},landing:function(b){console.log("landing route:",b),f.trigger("inventory:loading"),b&&(a.deepLink=decodeURIComponent(b)),g=0,this.inventory.picks.resetAllPicks(),this.inventory.set("currentView","landing")},results:function(e,h,i){var j=this,k=b("#sit-errors").is(":visible");if(!k){if(f.trigger("inventory:loading"),"details"===j.inventory.get("currentView")&&(a.API.resetUserPicks(),console.error("router:results:",arguments)),j.inventory.set("currentView","results"),j.inventory.details.set("resultsUrl",window.location.hash),c.isUndefined(i)&&g>0)return j.navigate("#!/landing",{trigger:!0}),void j.inventory.filters.reset();g++;var l=("string"==typeof i?decodeURIComponent(i).split("/"):[]).concat(["","","","","","","","","","","","",""]),m="tundra"===h?{grade:"",cab:"",bed:"",engine:"",drive:"",transmission:"",exteriorcolor:"",interiorcolor:"",accessory:"",sort:"",page:"",msrp:""}:{grade:"",model:"",exteriorcolor:"",interiorcolor:"",accessory:"",sort:"",page:"",msrp:""},n=c.extend(m,c.object(c.keys(m),l),{year:e,series:h});c.each(j.archived_series,function(a){if(h.indexOf(a)>=0){var b="en"==d.lang?"":"espanol/";return window.location.href="/apps/vehicle-archive/"+b+a+".html",!1}}),n.model=j.getSplitParam("model",n),n.exteriorcolor=j.getSplitParam("exteriorcolor",n),n.interiorcolor=j.getSplitParam("interiorcolor",n),n.accessory=j.getSplitParam("accessory",n),a.API.session()&&a.API.removeRangeConstraint(),j.inventory.picks.parsePicks(n),f.trigger("SIT:router:results")}},getSplitParam:function(a,b){return c.compact(b[a]?b[a].split("-"):c.compact[b[a]])},details:function(a,b,e){var h=this;f.trigger("inventory:loading"),g=0,this.inventory.set("currentView","details");var i=("string"==typeof e?decodeURIComponent(e).split("/"):[]).concat(["","","","","","","","","","","",""]),j={grade:"",model:"",exteriorcolor:"",interiorcolor:"",accessory:""},k=c.extend(j,c.object(c.keys(j),i),{year:a,series:b});return c.each(h.archived_series,function(a){if(b.indexOf(a)>=0){var c="en"==d.lang?"":"espanol/";return window.location.href="/apps/vehicle-archive/"+c+a+".html",!1}}),k.year&&k.series?k.model&&k.exteriorcolor&&k.interiorcolor?(k.accessory=c.compact(k.accessory?k.accessory.split("-"):c.compact[k.accessory]),void h.inventory.details.load(k)):(this.navigate("#!/results/"+k.year+"/"+k.series),!1):(this.navigate("#!/landing"),!1)},getPicksFromRoute:function(a){var b=("string"==typeof a?decodeURIComponent(a).split("/"):[]).concat(["","","","","","","","","","","",""]),d="tundra"===series?{details:"",year:"",series:"",grade:"",cab:"",bed:"",engine:"",drive:"",transmission:"",exteriorcolor:"",interiorcolor:"",accessory:"",sort:"",page:""}:{details:"",year:"",series:"",grade:"",model:"",exteriorcolor:"",interiorcolor:"",accessory:"",sort:"",page:""},e=c.extend(d,c.object(c.keys(d),b),{});return e},getRouteFromPicks:function(a){var b=this,d="tundra"===a.series?["year","series","grade","cab","bed","engine","drive","transmission","exteriorcolor","interiorcolor","accessory","sort","page","msrp"]:["year","series","grade","model","exteriorcolor","interiorcolor","accessory","sort","page","msrp"],e=[];c.each(d,function(b,d){var f="";c.isArray(a[b])?f=a[b].join("-"):"string"==typeof a[b]?f=a[b]:a[b]&&(f=""+a[b]),e.push(f)}),e=c.initial(e,function(a){return""===a});var f="#!/results/"+e.join("/");return b.inventory.details.set("resultsUrl",f),f},navigateToPicks:function(a,b){this.navigate(this.getRouteFromPicks(a),b)},setRouteByCurrentPicks:function(){var b=this,c=b.inventory.picks.attributes,d=a.API.getDefaultGrade();d&&d.code&&(c.grade=d.code),b.navigate("#!/results/"+a.API.getCurrentQueryParams(),{silent:!0})}});return h}),define("ritLoading",["sit"],function(a){var b=a.$,c=a._,d=(a.Events,{delay:0,masked:!0,fixed:!1});b.fn.loading=function(a){var e=c.clone(d),f=this;return"stop"===a||"hide"===a||a===!1?b(f).each(function(){b.unmaskElement(b(this))}):("small"===a?a={size:"small"}:"string"==typeof a&&(a={label:a}),c.extend(e,a),e.masked=!1,b(this).each(function(){if("number"==typeof e.delay&&e.delay>0){var a=b(this);a.data("_load_timeout",setTimeout(function(){b.maskElement(b(this),e)},delay))}else b.maskElement(b(this),e)})),f},b.fn.mask=function(a){var e=c.clone(d);"small"===a?a={size:"small"}:"string"==typeof a&&(a={label:a}),c.extend(e,a),b(this).each(function(){if("number"==typeof e.delay&&e.delay>0){var a=b(this);a.data("_load_timeout",setTimeout(function(){b.maskElement(b(this),e)},delay))}else b.maskElement(b(this),e)})},b.fn.unmask=function(){b(this).each(function(){b.unmaskElement(b(this))})},b.fn.isMasked=function(){return this.hasClass("masked")},b.maskElement=function(a,c){if(void 0!==a.data("_load_timeout")&&(clearTimeout(a.data("_load_timeout")),a.removeData("_load_timeout")),a.isMasked())return!1;"static"==a.css("position")&&a.addClass("load-relative"),c.masked&&a.height()>100&&a.addClass("masked");var d=c.masked?"loadmask":"load";d=c.fixed?"loadfixed":d;var e=b('<div class="'+d+'"></div>'),f=b('<i class="load-icon"></i>');if("small"==c.size)e.addClass("small");else if("number"==typeof c.size)if(!Modernizr.cssanimations&&c.size<=20)e.addClass("small");else{var g=-1*Math.floor(c.size/2);f.css({"background-size":c.size+"px",height:c.size+"px",width:c.size+"px",margin:g+"px 0 0 "+g+"px"})}else"string"==typeof c.size&&Modernizr.cssanimations&&f.css({"background-size":c.size,height:c.size,width:c.size});"number"==typeof c.top?f.css("top",c.top+"px"):"string"==typeof c.top&&f.css("top",c.top),"number"==typeof c.left?f.css("left",c.left+"px"):"string"==typeof c.left&&f.css("left",c.left),e.append(f).appendTo(a),"string"==typeof c.label&&a.append('<div class="load-msg">'+c.label+"</div>")},b.unmaskElement=function(a){void 0!==a.data("_load_timeout")&&(clearTimeout(a.data("_load_timeout")),a.removeData("_load_timeout")),a.removeClass("masked load-relative"),a.find(".load-msg,.load,.loadmask,.loadfixed").remove()}}),define("ritPlaceholder",["sit"],function(a){function b(){function a(a){var b={},d=/^jQuery\d+$/;return c.each(a.attributes,function(a,c){c.specified&&!d.test(c.name)&&(b[c.name]=c.value)}),b}function b(a,b){var d=this,e=c(d);if(d.value==e.attr("placeholder")&&e.hasClass("tcom-placeholder"))if(e.data("placeholder-password")){if(e=e.hide().next().show().attr("id",e.removeAttr("id").data("placeholder-id")),a===!0)return e[0].value=b;e.focus()}else d.value="",e.removeClass("tcom-placeholder"),d==document.activeElement&&d.select()}function d(){var d,e=this,f=c(e),g=this.id;if(""==e.value){if("password"==e.type){if(!f.data("placeholder-textinput")){try{d=f.clone().attr({type:"text"})}catch(h){d=c("<input>").attr(c.extend(a(this),{type:"text"}))}d.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":g}).bind("focus.placeholder",b),f.data({"placeholder-textinput":d,"placeholder-id":g}).before(d)}f=f.removeAttr("id").hide().prev().attr("id",g).show()}f.addClass("tcom-placeholder"),f[0].value=f.attr("placeholder")}else f.removeClass("tcom-placeholder")}var e,f,g="placeholder"in document.createElement("input"),h="placeholder"in document.createElement("textarea"),i=c.fn,j=c.valHooks;g&&h?(f=i.placeholder=function(){return this},f.input=f.textarea=!0):(f=i.placeholder=function(){var a=this;return a.filter((g?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":b,"blur.placeholder":d}).data("placeholder-enabled",!0).trigger("blur.placeholder"),a},f.input=g,f.textarea=h,e={get:function(a){var b=c(a);return b.data("placeholder-enabled")&&b.hasClass("tcom-placeholder")?"":a.value},set:function(a,e){var f=c(a);return f.data("placeholder-enabled")?(""==e?(a.value=e,a!=document.activeElement&&d.call(a)):f.hasClass("tcom-placeholder")?b.call(a,!0,e)||(a.value=e):a.value=e,f):a.value=e}},g||(j.input=e),h||(j.textarea=e),c(function(){c(document).delegate("form","submit.placeholder",function(){var a=c(".placeholder",this).each(b);setTimeout(function(){a.each(d)},10)})}),c(window).bind("beforeunload.placeholder",function(){c(".placeholder").each(function(){this.value=""})}))}var c=a.$;b()}),define("ritBootstrapTransition",["sit"],function(a){var b=a.$;b(function(){"use strict";b.support.transition=function(){var a=function(){var a,b=document.createElement("bootstrap"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(a in c)if(void 0!==b.style[a])return c[a]}();return a&&{end:a}}()})}),define("ritBootstrapTooltip",["sit","ritBootstrapTransition"],function(a){"use strict";var b=a.$,c=function(a,b){this.init("tooltip",a,b)};c.prototype={constructor:c,init:function(a,c,d){var e,f;this.type=a,this.$element=b(c),this.options=this.getOptions(d),this.enabled=!0,"click"==this.options.trigger||"touchstart"==this.options.trigger?this.$element.on(this.options.trigger+"."+this.type,this.options.selector,b.proxy(this.toggle,this)):"manual"!=this.options.trigger&&(e="hover"==this.options.trigger?"mouseenter":"focus",f="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(e+"."+this.type,this.options.selector,b.proxy(this.enter,this)),this.$element.on(f+"."+this.type,this.options.selector,b.proxy(this.leave,this))),this.options.selector?this._options=b.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(a){return a=b.extend({},b.fn[this.type].defaults,a,this.$element.data()),a.delay&&"number"==typeof a.delay&&(a.delay={show:a.delay,hide:a.delay}),a},enter:function(a){var c=b(a.currentTarget)[this.type](this._options).data(this.type);return c.options.delay&&c.options.delay.show?(clearTimeout(this.timeout),c.hoverState="in",void(this.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show))):c.show()},leave:function(a){var c=b(a.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),c.options.delay&&c.options.delay.hide?(c.hoverState="out",void(this.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide))):c.hide()},show:function(){var a,b,c,d,e,f,g;if(this.hasContent()&&this.enabled){switch(a=this.tip(),this.setContent(),this.options.animation&&a.addClass("fade"),f="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,b=/in/.test(f),a.remove().css({top:0,left:0,display:"block"}).appendTo(b?this.$element:document.body),c=this.getPosition(b),d=a[0].offsetWidth,e=a[0].offsetHeight,b?f.split(" ")[1]:f){case"bottom":g={top:c.top+c.height,left:c.left+c.width/2-d/2};break;case"top":g={top:c.top-e,left:c.left+c.width/2-d/2};break;case"left":g={top:c.top+c.height/2-e/2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.width}}a.css(g).addClass(f).addClass("in")}},setContent:function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},hide:function(){function a(){var a=setTimeout(function(){c.off(b.support.transition.end).remove()},500);c.one(b.support.transition.end,function(){clearTimeout(a),c.remove()})}var c=this.tip();return c.removeClass("in"),b.support.transition&&this.$tip.hasClass("fade")?a():c.remove(),this},fixTitle:function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(a){return b.extend({},a?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},tip:function(){return this.$tip=this.$tip||b(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}},b.fn.tooltip=function(a){return this.each(function(){var d=b(this),e=d.data("tooltip"),f="object"==typeof a&&a;e||d.data("tooltip",e=new c(this,f)),"string"==typeof a&&e[a]()})},b.fn.tooltip.Constructor=c,b.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!0}}),define("ritBootstrapPopover",["sit","ritBootstrapTooltip"],function(a){"use strict";var b=a.$,c="tmob"===a.Util.site,d=function(a,b){this.init("popover",a,b)};d.prototype=b.extend({},b.fn.tooltip.Constructor.prototype,{constructor:d,setContent:function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content > *")[this.options.html?"html":"text"](c),a.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-content")||("function"==typeof c.content?c.content.call(b[0]):c.content)},tip:function(){return this.$tip||(this.$tip=b(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}}),b.fn.popover=function(a){return this.each(function(){var c=b(this),e=c.data("popover"),f="object"==typeof a&&a;e||c.data("popover",e=new d(this,f)),"string"==typeof a&&e[a]()})},b.fn.popover.Constructor=d,b.fn.popover.defaults=b.extend({},b.fn.tooltip.defaults,{placement:"right",trigger:c?"touchstart":"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}),define("ritZipcodeChanger",["sit","ritLoading","ritPlaceholder","ritBootstrapPopover"],function(a,b,c,d){var e=a.$,f=a._,g=a.Util,h=g.i18n,i=a.Events,j=(a.cookie,a.Geolocation),k=a.Backbone,l=k.View.extend({events:{"click h4":"clicked","click input":"clicked","keypress input":"keypressed","input input":"onInputInput","focus input":"onInputFocus","keyup input":"keyup","click .enter":"onEnterClick"},placeholderText:"Enter ZIP Code",initialize:function(){var a,b=this,c=j.getZip();b.$el=a=e(b.el),b.title=b.getTitle(),b.locked=!1,e.fn.placeholder&&a.find("input[placeholder], textarea[placeholder]").placeholder(),e("body").hasClass("configurator")?b.elHtml=f.template('<p><%= title %></p><div class="h4-container"><h4><%= zipcode %></h4><input pattern="[0-9]*" class="zipcode-changer-input" type="text" value="<%= zipcode %>" placeholder="Enter ZIP Code"><div class="enter"></div></div>'):"dealers-seo-v2"==e("body").data("app-name")?b.elHtml=f.template('<p><%= title %></p><div class="h4-container"><h4><%= zipcode %></h4><input pattern="[0-9]*" class="zipcode-changer-input" type="text" value="<%= zipcode %>" placeholder="Enter ZIP Code or City & State or Dealer Name"><div class="enter"></div></div>'):"en"===h.lang?b.elHtml=f.template('<p><%= title %></p><div class="h4-container"><h4><%= zipcode %></h4><input pattern="[0-9]*" class="zipcode-changer-input" type="text" value="<%= zipcode %>" placeholder="Enter ZIP Code"><div class="enter"></div></div>'):b.elHtml=f.template('<p><%= title %></p><div class="h4-container"><h4><%= zipcode %></h4><input pattern="[0-9]*" class="zipcode-changer-input" type="text" value="<%= zipcode %>" placeholder="Cód. Postal"><div class="enter"></div></div>'),b.options.intercept?b.setElement(e("<div />",{"class":"zipcode-changer intercept"})):b.setElement(e("<div />",{"class":"zipcode-changer"+(e.cookie("zipcode")?" akzipcode":"")+(e.cookie("ugzipcode")?" ugzipcode":"")})),b.$el.loading("small"),b.promise=c,i.on("zipcode:changed",function(a){var c=b.$el,d=c.find("h4",b.$el),e=c.find(".zipcode-changer-input",b.$el),f=c.find(".enter",b.$el);d.text()!=a&&d.text(a),e.val()!=a&&e.val(a),d.show(),e.hide(),f.hide(),b.calculate()}),c.done(function(a){b.zipcode=a,b.render()}),c.fail(function(a){console.error("zipcode request fail: "+a),e("body").hasClass("configurator")?b.title="Please confirm your location":"en"===h.lang?b.title="Please confirm your location":b.title="Por favor pon tu código postal",b.zipcode="",b.render()})},getTitle:function(){return e("body").hasClass("configurator")?e.cookie("ugzipcode")?"Your Location":e.cookie("zipcode")?"Not your location?":"N/A":"en"===h.lang?e.cookie("ugzipcode")?"Your Location":e.cookie("zipcode")?"Not your location?":"N/A":"Tu ubicación"},render:function(){var a=this,b=a.$el,c={title:a.title,zipcode:a.options.intercept?"":a.zipcode},d=""+c.zipcode,f=a.elHtml(c);a.$el.html(e(f)),d.length||(b.find("input",a.$el).show(),b.find("h4",a.$el).hide(),a.$el.addClass("empty")),e("body").hasClass("configurator")?b.find("input").popover({placement:"top",content:"Please enter a valid zip code, like '90034'.",trigger:"manual",template:a.popoverTemplate()}):"en"===h.lang?b.find("input").popover({placement:"top",content:"Please enter a valid zip code, like '90034'.",trigger:"manual",template:a.popoverTemplate()}):b.find("input").popover({placement:"top",content:"Por favor pon tu código postal, así '90034'.",trigger:"manual",template:a.popoverTemplate()}),a.$el.loading("stop")},validate:function(a){var b=0;if(a=""+a,5===a.length&&-1===a.indexOf(" ")){for(;5>b;){var c=a.substr(b,b+1);if(" "==c||isNaN(c))return!1;b++}return e.get("/ToyotaSite/rest/dealerLocator/locateDealersByString?brandId=1&searchString="+a)}return!1},popoverTemplate:function(a){var b=this.options.popoverClass||"";return'<div class="popover bottom in form-error '+b+'" style="display: block;"><div class="arrow arrow-shadow"></div><div class="arrow form-error"></div><div class="arrow"></div><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>'},clicked:function(a){var b=this,c=b.$el,d=(e(a.currentTarget),c.find("input")),f=c.find(".enter"),g=c.find("h4");d.is(":visible")||(d.show().focus(),f.show(),g.hide(),i.trigger("zipcode:edit",a))},keyup:function(a){var b=e(a.currentTarget),c=b.val();c.length>=5&&b.val(c.substr(0,5))},keypressed:function(a){var b=this,c=a.keyCode||a.charCode,d=a.charCode;(a.shiftKey||a.ctrlKey||a.altKey)&&a.preventDefault();var f=0===d&&c>=37&&40>=c,g=8==c||9==c||127==c||f;return f||g?void 0:13==c&&5===e(a.currentTarget).val().length?(a.preventDefault(),b.calculate(!0),void b.hideKeyboard()):c>47&&58>c?void 0:(a.preventDefault(),!1)},hideKeyboard:function(){document.activeElement.blur()},onEnterClick:function(){this.calculate(!0)},onInputInput:function(a){var b=a.target;b.value},onInputFocus:function(a){var b=this,c=e(a.target);b.$el.removeClass("empty"),b.$el.removeClass("edit").addClass("edit"),c.attr({placeholder:""}),b.$el.on("blur","input",f.bind(b.onInputBlur,b))},onInputBlur:function(a){var b=this,c=e(a.target);if(b.$el.hasClass("edit")){console.log("blur",c);var d;if(d="en"===h.lang?b.placeholderText:"Cód. Postal",c.attr({placeholder:d}),b.$el.removeClass("edit"),""===c.val()&&b.$el.removeClass("empty").addClass("empty"),b.options.noBlur)return!1;b.calculate()}b.$el.off("blur","input",f.bind(b.onInputBlur,b))},calculate:function(a){var b=this,c=b.$el,d=c.find("input"),f=(c.find(".error"),
c.find(".enter")),g=(c.find(".success"),d.val());b.locked=!0,e.when(b.validate(g)).done(function(h){b.locked=!1,h&&1!==h.code&&1==h.success?(c.find("p").text(b.getTitle()),b.$el.removeClass("empty"),b.options.intercept||b.$el.removeClass("akzipcode ugzipcode").addClass((e.cookie("zipcode")?" akzipcode":"")+(e.cookie("ugzipcode")?" ugzipcode":"")),c.find("h4").text(d.val()).show(),d.hide(),f.hide(),j.getZip().done(function(c){(c!==g||1==a)&&(j.setZip(g),i.trigger("zipcode:changed",g),b.options.triggerDealerSearch&&i.trigger("zipform:updated",g))}).fail(function(){j.setZip(g)}),b.$el.removeClass("error"),d.popover("hide"),i.trigger("zipcode:blur")):(b.$el.addClass("error"),d.popover("show"),i.trigger("zipcode:validation:error"))}),window.setTimeout(function(){d.popover("hide")},3e3)}});return l}),define("app/jst/rit/landing-vehicle",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<div class="series-item'+(null==(__t=lastColumn)?"":__t)+' car-item" data-series-code="'+(null==(__t=modelCode)?"":__t)+'" data-series-name="'+(null==(__t=modelName)?"":__t)+'" data-series-year="'+(null==(__t=Math.floor(String(displayYear)))?"":__t)+'">	<div class="item-info-row">\n<div class="meta-row">\n<h3 class="item-title"><span>'+(null==(__t=multiYear)?"":__t)+(null==(__t=modelName)?"":__t)+'</span></h3>\n<div class="stats-row">\n<div class="stats-item">\n<span class="price">'+(null==(__t=price)?"":__t)+' starting msrp<a class="disclaimer" href="#" data-disclaimer="msrp" data-code="msrp">1</a></span>\n</div>\n',asShownAs&&(__p+='\n<div class="stats-item">\n<span class="msrp">'+(null==(__t=asShownAs)?"":__t)+" as shown</span>\n</div>\n"),__p+='\n</div>\n</div>\n<div class="car-row">\n<div class="jelly-small car-image" style="background-image:url(\'/content/common/img/jellies/small/'+(null==(__t=modelYear)?"":__t)+"/"+(null==(__t=imageModelName)?"":__t)+"/"+(null==(__t=imgName)?"":__t)+"');\"></div>\n</div>\n</div>\n</div>";return __p}}),define("app/jst/rit/landing-category",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<h2 class="caption'+(null==(__t=headerClear)?"":__t)+'">\n<span>Toyota '+(null==(__t=category)?"":__t)+"</span>\n</h2>\n"+(null==(__t=seriesList)?"":__t);return __p}}),define("app/views/rit/landing",["sit","app/promises","app/jst/rit/landing-vehicle","app/jst/rit/landing-category"],function(a,b,c,d){var e,f=(a.RIT,a.$),g=a._,h=a.Backbone,i=a.Events,j=a.Config,k=a.Analytics,l=5,m=h.View.extend({didFireLoadTag:!1,events:{"click .series-item":"onClickSeries"},initialize:function(){var c=this;c.appView=c.options.appView,c.router=c.options.router,e=c.$("#car-items"),i.on("SIT:region:ready",function(d){a.API.setRegionCode(d.regionCode),f.when(b.series()).then(function(a){c.collection=a,c.render()})})},onClickSeries:function(b){var c=this,d=f(b.currentTarget),e=f(b.target);debuggerOn&&(console.time("SESSION TIME"),console.time("seriesChange"),a.appView.debugging.seriesChange=(new Date).valueOf()),e.hasClass("disclaimer")||(i.trigger("inventory:loading"),c.router.navigate("#!/results/"+d.data("series-year")+"/"+d.data("series-code"),{trigger:!0}),c.appView.fireIS("117.7",{model_name:d.data("series-code")}))},show:function(){var b=this;b.$el.addClass("is-on"),k.setPageName("T:Inventory:Landing"),b.appView.resetDisclaimers(),b.appView.updateHeader({title:a.strings.title,subTitle:a.strings.subTitle}),i.on("inventory:loaded",function(){b.didFireLoadTag||(b.didFireLoadTag=!0,b.appView.fireIS("117.1"),i.off("inventory:loaded",this))})},hide:function(){var a=this;a.$el.removeClass("is-on")},render:function(){var h=this,k=c,m=d,n=0,o=a.API.isGST(),p=g.map(j.categories,function(a){var b=h.collection.getSeriesListByCategory(a.id),c=g.chain(b).filter(function(a){return!o||"priusplugin"!==a.get("modelCode")&&"rav4ev"!==a.get("modelCode")?!0:!1}).map(function(a){return a.set("lastColumn",++n%l===0?" last-column":""),k(a.toJSON())}).join("").value();return m({category:a.name,seriesList:c,headerClear:(n-b.length)%l===0||(n-b.length)%l===4?" header-clear":""})}).join("");e.html(p).show(),o?f(".caption:eq(3)").css({clear:"both"}):f(".caption:eq(3)").css({clear:""}),g.defer(function(){f("body").css({overflow:"auto"})}),f.when(b.series(),b.zipCode(),b.region()).then(function(){"landing"===h.appView.inventory.get("currentView")&&i.trigger("inventory:loaded","landing")})}});return m}),define("app/jst/rit/filter",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<div class="accordion-heading chzn-container-single">\n<div class="accordian-header accordion-toggle chzn-single" data-toggle="collapse" href="#'+(null==(__t=type)?"":__t)+'FilterBody">\n<strong>'+(null==(__t=title)?"":__t)+'</strong>\n<a href="#" class="btn btn-circle smaller pull-right">\n<i class="icon-arrow-down"></i>\n<i class="icon-arrow-up"></i>\n</a>\n</div>\n</div><div id="'+(null==(__t=type)?"":__t)+'FilterBody" class="accordion-body in collapse" data-type="'+(null==(__t=type)?"":__t)+'" style="height: auto">\n<div class="accordion-inner">\n'+(null==(__t=itemsHTML)?"":__t)+"\n</div>\n</div>";return __p}}),define("app/jst/rit/color-filter",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<div class="accordion-heading chzn-container-single">\n<div class="accordian-header accordion-toggle chzn-single" data-toggle="collapse" href="#'+(null==(__t=type)?"":__t)+'FilterBody">\n<strong>'+(null==(__t=title)?"":__t)+'</strong>\n<a href="#" class="btn btn-circle smaller pull-right">\n<i class="icon-arrow-down"></i>\n<i class="icon-arrow-up"></i>\n</a>\n</div>\n</div><div id="'+(null==(__t=type)?"":__t)+'FilterBody" class="accordion-body in collapse" style="height: auto">\n<ul class="interior-colors color-picker unstyled">\n<div class="accordion-inner">\n'+(null==(__t=itemsHTML)?"":__t)+"\n</div>\n</ul>\n</div>";return __p}}),define("app/jst/rit/checkbox",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<label class="checkbox',isPicked&&(__p+=" is-on"),isDisabled&&(__p+=" disabled"),__p+='">\n<input type="checkbox" class="" value="'+(null==(__t=prefix)?"":__t)+'" data-title="'+(null==(__t=title)?"":__t)+'" data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'" data-name="'+(null==(__t=name)?"":__t)+'"',isPicked&&(__p+=' checked="checked"'),__p+=">\n"+(null==(__t=SIT._.linkDisclaimer(title))?"":__t)+' <span class="count filter-count">('+(null==(__t=count)?"":__t)+")</span>\n</label>";return __p}}),define("app/jst/rit/color-chip",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<li class="',isPicked&&(__p+=" hangtag"),__p+='" data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'" data-title="'+(null==(__t=title)?"":__t)+'">\n<a href="#" data-msrp="0" data-name="'+(null==(__t=title)?"":__t)+'" style="background:'+(null==(__t=hex)?"":__t)+'"></a>\n<div class="color-chip" data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'" data-tooltip="',title&&(__p+="<strong>"+(null==(__t=title)?"":__t)+" </strong>"),__p+='" data-original-title="'+(null==(__t=title)?"":__t)+'"></div>\n</li>';return __p}}),define("ritBootstrapCollapse",["sit","ritBootstrapTransition"],function(a){"use strict";var b=a.$,c=function(a,c){this.$element=b(a),this.options=b.extend({},b.fn.collapse.defaults,c),this.options.parent&&(this.$parent=b(this.options.parent)),this.options.toggle&&this.toggle()};c.prototype={constructor:c,dimension:function(){var a=this.$element.hasClass("width");return a?"width":"height"},show:function(){var a,c,d,e;if(!this.transitioning){if(a=this.dimension(),c=b.camelCase(["scroll",a].join("-")),d=this.$parent&&this.$parent.find("> .accordion-group > .in"),d&&d.length){if(e=d.data("collapse"),e&&e.transitioning)return;d.collapse("hide"),e||d.data("collapse",null)}this.$element[a](0),this.transition("addClass",b.Event("show"),"shown"),b.support.transition&&this.$element[a](this.$element[0][c])}},hide:function(){var a;this.transitioning||(a=this.dimension(),this.reset(this.$element[a]()),this.transition("removeClass",b.Event("hide"),"hidden"),this.$element[a](0))},reset:function(a){var b=this.dimension();return this.$element.removeClass("collapse")[b](a||"auto")[0].offsetWidth,this.$element[null!==a?"addClass":"removeClass"]("collapse"),this},transition:function(a,c,d){var e=this,f=function(){"show"==c.type&&e.reset(),e.transitioning=0,e.$element.trigger(d)};this.$element.trigger(c),c.isDefaultPrevented()||(this.transitioning=1,this.$element[a]("in"),b.support.transition&&this.$element.hasClass("collapse")?this.$element.one(b.support.transition.end,f):f())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},b.fn.collapse=function(a){return this.each(function(){var d=b(this),e=d.data("collapse"),f="object"==typeof a&&a;e||d.data("collapse",e=new c(this,f)),"string"==typeof a&&e[a]()})},b.fn.collapse.defaults={toggle:!0},b.fn.collapse.Constructor=c,b(function(){b("body").on("click.collapse.data-api","[data-toggle=collapse]",function(a){var c,d=b(this),e=d.attr("data-target")||a.preventDefault()||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,""),f=b(e).data("collapse")?"toggle":d.data();d[b(e).hasClass("in")?"addClass":"removeClass"]("collapsed"),b(e).collapse(f)})})}),define("app/views/rit/results/filter",["sit","app/jst/rit/filter","app/jst/rit/color-filter","app/jst/rit/checkbox","app/jst/rit/color-chip","ritBootstrapCollapse"],function(a,b,c,d,e){var f=a.$,g=a._,h=a.Backbone,i=a.Events,j=h.View.extend({filterType:"model",events:{"click input[type=checkbox]":"onCheckboxClick","click .inline-disclaimer":"onInlineDisclaimerClick"},initialize:function(){var a=this;switch(a.filterType=a.options.type,a.filterType){case"exteriorcolor":case"interiorcolor":a.categoryTpl=c,a.itemTpl=e;break;default:a.categoryTpl=b,a.itemTpl=d}g.bind(a.render,a),a.model.on("change",a.render,a)},onInlineDisclaimerClick:function(a){f(a.currentTarget).parent().is(".disabled")&&a.stopImmediatePropagation()},onCheckboxClick:function(b){var c=f(b.currentTarget);c.parent().is(".disabled")||(debuggerOn&&(console.time("filterChange"),a.appView.debugging.filterChange=(new Date).valueOf()),c.parent().toggleClass("is-on"),i.trigger("SIT:filter:changed",{prefix:c.val(),isChecked:c.is(":checked"),id:c.data("id").toString(),originalEvent:b}))},render:function(){var a=this,b=g.findWhere(a.model.attributes.filters,{type:a.filterType});if(b){var c=g.map(b.filters,function(b){return a.itemTpl(b)}).join(""),d=a.categoryTpl({title:b.title,type:b.type,itemsHTML:c});a.$el.html(d),a.$el.find(".accordion-heading span").addClass("trim-year")}else a.$el.html("")}});return j}),define("app/jst/rit/color-swatch",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+="<li ",isPicked&&(__p+='class="hangtag"'),__p+=' data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'" data-title="'+(null==(__t=title)?"":__t)+'">\n<a href="#" data-msrp="0" data-name="'+(null==(__t=title)?"":__t)+'" style="background-image:url(\''+(null==(__t=swatch)?"":__t)+'\');"></a>\n<div class="color-chip" data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'" data-tooltip="',title&&(__p+="<strong>"+(null==(__t=title)?"":__t)+" </strong>"),__p+='" data-original-title="'+(null==(__t=title)?"":__t)+'"></div>\n</li>';return __p}}),define("app/views/rit/results/color-filter",["sit","app/views/rit/results/filter","app/jst/rit/color-filter","app/jst/rit/color-chip","app/jst/rit/color-swatch","ritBootstrapCollapse"],function(a,b,c,d,e){var f=(a.RIT,a.$),g=a._,h=(a.Backbone,a.Events),i=b.extend({filterType:"model",lastItems:"",events:{"click .color-picker li":"onColorPickerClick"},initialize:function(){var a=this;a.filterType=a.options.type,a.categoryTpl=c,a.itemTpl=d,g.bind(a.render,a),a.model.on("change",a.render,a)},onColorPickerClick:function(a){console.log("conColorPickerClick:",a);var b=f(a.currentTarget);b.find("div").is(".invalid")||(b.toggleClass("hangtag"),h.trigger("SIT:filter:changed",{prefix:b.data("prefix"),isChecked:b.hasClass("hangtag"),id:b.data("id").toString(),originalEvent:a}))},render:function(){var a=this,b=g.findWhere(a.model.attributes.filters,{type:a.filterType});if(a.destroyTooltips(),b){var c=g.map(b.filters,function(a){return a.prefix.indexOf("XCOL_")>-1?d(a):e(a)}).join(""),f=a.categoryTpl({title:b.title,type:b.type,itemsHTML:c});a.$el.html(f),a.$el.find(".accordion-heading span").addClass("trim-year"),a.applyTooltips()}else a.$el.html("")},destroyTooltips:function(){var a=this;g.each(a.$(".color-picker div"),function(a){f(a).popover("destroy")})},applyTooltips:function(){var a=this;Modernizr.touch||g.each(a.$(".color-picker div"),function(a){f(a).popover({trigger:"hover",placement:"bottom",content:f(a).attr("data-tooltip")})})}});return i}),define("app/jst/rit/results-controls",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<a class="btn btn-pill" id="results-start-over" href="#!/landing">\n<i class="icon-refresh"></i>\n<span>Start Over</span>\n</a><select id="results-sort-vehicles" data-placeholder="Sort Vehicles">\n',_.each(options,function(a){__p+='\n<option value="'+(null==(__t=a.value)?"":__t)+'"',a.checked&&(__p+=' selected="selected"'),__p+=">"+(null==(__t=a.text)?"":__t)+"</option>\n"}),__p+="\n</select>";return __p}}),define("app/views/rit/results/controls",["sit","app/jst/rit/results-controls"],function(a,b){var c,d=a.$,e=a._,f=a.Events,g=Modernizr.touch,h=a.Backbone;return Controls=h.View.extend({events:{"change #results-sort-vehicles":"onSortChange"},initialize:function(){var a=this;a.model.on("change",a.render,a)},updateState:function(b){var g=this,h=(a.API.getSortOrder(),g.model);c=d("#results-sort-vehicles"),g.resetDropDown(),h.get("sort")&&(c.find("option").attr("selected",!1),d(c).find('option[value="'+h.get("sort")+'"]').attr("selected","selected")),c.trigger("liszt:updated"),f.trigger("SIT:pick:changed"),d.when(a.API.getResultsDeferred(),a.API.getFacetCountsDeferred(),a.API.getRangeDeferred()).then(function(){e.defer(function(){console.warn("should be done"),f.trigger("inventory:loaded","results")})})},onSortChange:function(b){console.log("controls:onSortChange:",b);var c=this,d=b.currentTarget.value,e=c.model;e.set({sort:d},{silent:!0,tap:b}),e.trigger("change:sort",e,d),a.appView.fireIS("117.1"+("asc"===d?"2":"1")),f.trigger("SIT:sort:changed",{sort:d}),c.updateState()},resetDropDown:function(){console.log("Controls:resetDropDown",c),c.find("option:selected").removeAttr("selected"),c.trigger("liszt:updated")},optionsData:function(){var a=this,b=a.model&&a.model.get("sort")||"";return[{value:"asc",text:"Price: Low to High",checked:"asc"===b},{value:"desc",text:"Price: High to Low",checked:"desc"===b}]},onFacetChange:function(a,b){},render:function(e,f){var h=this,i=a.API.getSortOrder();h.$el.html(b({options:h.optionsData()})),c=d("#results-sort-vehicles"),g||c.chosen({disable_search:!0}),d("#results-sort-vehicles").val(i).trigger("liszt:updated").trigger("chosen:updated")}}),Controls}),define("app/jst/rit/grade-filter",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<div class="grades-mask"><ul class="unstyled clearfix">\n'+(null==(__t=gradesHTML)?"":__t)+"\n</ul></div>";return __p}}),define("app/jst/rit/grade-item",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<li class="',isPicked&&(__p+=" is-on"),__p+='">\n<div class="grade-item" data-grade-name="'+(null==(__t=code)?"":__t)+'" data-prefix="'+(null==(__t=prefix)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'">\n<div class="item-info-row">\n<div class="meta-row">\n<span class="series-name">'+(null==(__t=series)?"":__t)+'</span> <span class="grade-name">'+(null==(__t=title.replace(/ *\([^)]*\) */g,""))?"":__t)+'</span><span class="count grade-count">&nbsp;('+(null==(__t=count)?"":__t)+')</span>\n</div>\n</div>\n<div class="grade-hot-spot"></div>\n</div>\n</li>';return __p}}),define("app/views/rit/results/grade-filter",["sit","app/jst/rit/grade-filter","app/jst/rit/grade-item"],function(a,b,c){var d,e=a.$,f=a._,g=a.Backbone,h=a.Events,i=g.View.extend({events:{"click .grade-item":"onSelectGrade"},initialize:function(){var a=this;a.router=a.options.router,a.isTablet=Modernizr.touch,a.model.on("change:grades",a.onGrades,a)},onGrades:function(a,b,c){var d=this;d.render(a,b)},onSelectGrade:function(b){debuggerOn&&(console.time("gradeChange"),a.appView.debugging.gradeChange=(new Date).valueOf());var c=e(b.currentTarget);c.data(),c.parent().hasClass("is-on")||(d.removeClass("is-on"),c.parent().addClass("is-on"),h.trigger("inventory:loading"),h.trigger("SIT:filter:changed",{prefix:c.data("prefix"),isChecked:!0,id:c.data("id").toString()}))},render:function(){var a=this,e=a.model.get("grades"),g=f.map(e,function(a){return c(a)}).join(""),h=b({title:e.title,type:e.type,gradesHTML:g});a.$el.html(h),d=a.$("li")}});return i}),define("app/jst/rit/price-filter",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<div class="accordion-heading chzn-container-single">\n<div class="accordian-header accordion-toggle chzn-single" data-toggle="collapse" href="#priceFilterBody">\n<strong>Price</strong>\n<a href="#" class="btn btn-circle smaller pull-right">\n<i class="icon-arrow-down"></i>\n<i class="icon-arrow-up"></i>\n</a>\n</div>\n</div><div id="priceFilterBody" class="accordion-body in collapse" style="height: auto">\n<div class="accordion-inner">\n<div id="priceSlider" class="sliderContainer MainrangeSlider">\n<div class="sliderComponent">\n<div class="slider rangeSlider noUiSlider" style="position: relative;"></div>\n<div class="sliderValues">\n<span class="minValue pull-left">'+(null==(__t=min_msrp)?"":__t)+'</span>\n<span class="maxValue pull-right">'+(null==(__t=max_msrp)?"":__t)+"</span>\n</div></div>\n</div>\n</div>\n</div>";return __p}}),define("ritNoUiSlider",["sit"],function(a){var b=a.$;a._,a.Events,b.fn.noUiSlider=function(a,c){function d(a,b,c){"function"==typeof a&&a.call(b,c)}function e(a,b,c){var d=b.data("setup"),e=d.handles,f=d.settings,g=d.pos;if(a=0>a?0:a>100?100:a,2==f.handles)if(c.is(":first-child")){var h=parseFloat(e[1][0].style[g])-f.margin;a=a>h?h:a}else{var h=parseFloat(e[0][0].style[g])+f.margin;a=h>a?h:a}if(f.step){var j=i.from(f.range,f.step);a=Math.round(a/j)*j}return a}function f(a){try{return[a.clientX||a.originalEvent.clientX||a.originalEvent.touches[0].clientX,a.clientY||a.originalEvent.clientY||a.originalEvent.touches[0].clientY]}catch(b){return["x","y"]}}function g(a,b){return parseFloat(a[0].style[b])}var h=window.navigator.msPointerEnabled?2:"ontouchend"in document?3:1;window.debug&&console&&console.log(h);var i={to:function(a,b){return b=a[0]<0?b+Math.abs(a[0]):b-a[0],100*b/this._length(a)},from:function(a,b){return 100*b/this._length(a)},is:function(a,b){return b*this._length(a)/100+a[0]},_length:function(a){return a[0]>a[1]?a[0]-a[1]:a[1]-a[0]}},j={handles:2,serialization:{to:["",""],resolution:.01}};methods={create:function(){return this.each(function(){function c(a,b,c){a.css(k,b+"%").data("input").val(i.is(m.range,b).toFixed(t))}var k,l,m=b.extend(j,a),n="<a><div></div></a>",o=b(this).data("_isnS_",!0),p=[],q="",r=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},s=(m.serialization.resolution=m.serialization.resolution||.01).toString().split("."),t=1==s[0]?0:s[1].length;m.start=r(m.start)?[m.start,0]:m.start,b.each(m,function(a,b){r(b)?m[a]=parseFloat(b):"object"==typeof b&&r(b[0])&&(b[0]=parseFloat(b[0]),r(b[1])&&(b[1]=parseFloat(b[1])));var c=!1;switch(b="undefined"==typeof b?"x":b,a){case"range":case"start":c=2!=b.length||!r(b[0])||!r(b[1]);break;case"handles":c=1>b||b>2||!r(b);break;case"connect":c="lower"!=b&&"upper"!=b&&"boolean"!=typeof b;break;case"orientation":c="vertical"!=b&&"horizontal"!=b;break;case"margin":case"step":c="undefined"!=typeof b&&!r(b);break;case"serialization":c="object"!=typeof b||!r(b.resolution)||"object"==typeof b.to&&b.to.length<m.handles;break;case"slide":c="function"!=typeof b}c&&console&&console.error("Bad input for "+a+" on slider:",o)}),m.margin=m.margin?i.from(m.range,m.margin):0,(m.serialization.to instanceof b||"string"==typeof m.serialization.to||m.serialization.to===!1)&&(m.serialization.to=[m.serialization.to]),"vertical"==m.orientation?(q+="vertical",k="top",l=1):(q+="horizontal",k="left",l=0),q+=m.connect?"lower"==m.connect?" connect lower":" connect":"",o.addClass(q);for(var u=0;u<m.handles;u++){p[u]=o.append(n).children(":last");var v=i.to(m.range,m.start[u]);p[u].css(k,v+"%"),100==v&&p[u].is(":first-child")&&p[u].css("z-index",2);var w="MSPointerDown",x="MSPointerMove",y="MSPointerUp";window.PointerEvent&&(w="pointerdown",x="pointermove",y="pointerup");var z=".noUiSlider",A=(1===h?"mousedown":2===h?w:"touchstart")+z+"X",B=(1===h?"mousemove":2===h?x:"touchmove")+z,C=(1===h?"mouseup":2===h?y:"touchend")+z;p[u].find("div").on(A,function(a){if(b("body").bind("selectstart"+z,function(){return!1}),!o.hasClass("disabled")){b("body").addClass("TOUCH");var c=b(this).addClass("active").parent(),g=c.add(b(document)).add("body"),h=parseFloat(c[0].style[k]),j=f(a),n=j,q=!1;b(document).on(B,function(a){a.preventDefault();var b=f(a);if("x"!=b[0]){b[0]-=j[0],b[1]-=j[1];var g=[n[0]!=b[0],n[1]!=b[1]],r=h+100*b[l]/(l?o.height():o.width());r=e(r,o,c),g[l]&&r!=q&&(c.css(k,r+"%").data("input").val(i.is(m.range,r).toFixed(t)),d(m.slide,o.data("_n",!0)),q=r,c.css("z-index",2==p.length&&100==r&&c.is(":first-child")?2:1)),n=b}}).on(C,function(){g.off(z),b("body").removeClass("TOUCH"),o.find(".active").removeClass("active").end().data("_n")&&o.data("_n",!1).change()})}}).on("click",function(a){a.stopPropagation()})}(1==h||2==h||3==h)&&o.on("click",function(a){if(!o.hasClass("disabled")){var b=f(a),g=100*(b[l]-o.offset()[k])/(l?o.height():o.width()),h=p.length>1?b[l]<(p[0].offset()[k]+p[1].offset()[k])/2?p[0]:p[1]:p[0];c(h,e(g,o,h),o),d(m.slide,o),o.change()}});for(var u=0;u<p.length;u++){var D=i.is(m.range,g(p[u],k)).toFixed(t);"string"==typeof m.serialization.to[u]?p[u].data("input",o.append('<input type="hidden" name="'+m.serialization.to[u]+'">').find("input:last").val(D).change(function(a){a.stopPropagation()})):0==m.serialization.to[u]?p[u].data("input",{val:function(a){return"undefined"==typeof a?this.handle.data("noUiVal"):void this.handle.data("noUiVal",a)},handle:p[u]}):p[u].data("input",m.serialization.to[u].data("handleNR",u).val(D).change(function(){var a=[null,null];a[b(this).data("handleNR")]=b(this).val(),o.val(a)}))}b(this).data("setup",{settings:m,handles:p,pos:k,res:t})})},val:function(){if("undefined"!=typeof arguments[0]){var a="number"==typeof arguments[0]?[arguments[0]]:arguments[0];return this.each(function(){for(var c=b(this).data("setup"),d=0;d<c.handles.length;d++)if(null!=a[d]){var f=e(i.to(c.settings.range,a[d]),b(this),c.handles[d]);c.handles[d].css(c.pos,f+"%").data("input").val(i.is(c.settings.range,f).toFixed(c.res))}})}for(var c=b(this).data("setup").handles,d=[],f=0;f<c.length;f++)d.push(parseFloat(c[f].data("input").val()));return 1==d.length?d[0]:d},disabled:function(){return c?b(this).addClass("disabled"):b(this).removeClass("disabled")}};var k=b.fn.val;return b.fn.val=function(){return this.data("_isnS_")?methods.val.apply(this,arguments):k.apply(this,arguments)},"disabled"==a?methods.disabled.apply(this):methods.create.apply(this)}}),define("app/views/rit/results/price-filter",["sit","app/jst/rit/price-filter","ritNoUiSlider","ritBootstrapCollapse"],function(a,b,c,d){var e,f,g=a.$,h=a._,i=a.Backbone,j=a.Events,k=i.View.extend({events:{"mousedown .noUi-handle":"onNoUIHandleMouseDown"},initialize:function(){var c=this;this.lastMin=0,this.lastMax=1e7,this.priceFilterTpl=b,h.bind(c.render,c),j.on("SIT:api:session:ready SIT:grade:picked",function(){g.when(a.API.getMSRPRange()).then(function(a){c.render(a)})}),j.on("SIT:router:results",function(){a.API.session()&&g.when(a.API.getMSRPRange()).then(function(a){c.render(a)})})},onNoUIHandleMouseDown:function(a){e=g(a.currentTarget).hasClass("noUi-lowerHandle")?"lower":"upper"},render:function(c){var d=this,e=a.API.getCurrentMSRPRange(),i=c.min,k=c.max,l=e&&e.min&&"undefined"!==e.min&&e.min||c.min||c[0],m=e&&e.max&&"undefined"!==e.max&&e.max||c.max||c[1];l=Math.max(i,l),m=Math.min(k,m);var n=b({min_msrp:h.toDollar(l),max_msrp:h.toDollar(m)});d.lastMin=i,d.lastMax=k,d.$el.html(n),i!==k&&(f=g(".rangeSlider").empty().noUiSlider({range:[i,k],start:[l,m],slide:function(){var a=g(this),b=a.val();f.val(),d.$(".minValue").html(h.toDollar(parseInt(b[0]))),d.$(".maxValue").html(h.toDollar(parseInt(b[1])))}}),f.change(function(){var b=g(this).val();j.trigger("inventory:loading"),b[0]=parseInt(b[0],10),b[1]=parseInt(b[1],10),d.lastMin!=parseInt(b[0])&&(d.lastMin=parseInt(b[0]),a.appView.fireIS("117.20",{price_filter_tier:parseInt(b[0])+" - "+parseInt(b[1])})),d.lastMax!=parseInt(b[1])&&(d.lastMax=parseInt(b[1]),a.appView.fireIS("117.21",{price_filter_tier:parseInt(b[0])+" - "+parseInt(b[1])})),g.when(a.API.setRangeConstraint(b[0],b[1])).then(function(){j.trigger("SIT:pick:changed"),j.trigger("SIT:update:filters"),a.API.triggerResults(),g.when(a.API.getFacetCountsDeferred()).then(function(){h.defer(function(){j.trigger("inventory:loaded","results")})})})}))}});return k}),define("app/jst/rit/vehicle-result",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<div class="vehicle-result" data-index="'+(null==(__t=index)?"":__t)+'" data-engine="'+(null==(__t=engine)?"":__t)+'" data-display-name="'+(null==(__t=displayName)?"":__t)+'" data-msrp="'+(null==(__t=msrp)?"":__t)+'" data-path="'+(null==(__t=details)?"":__t)+'">\n<div class="vehicle-result-title-row clearfix">\n',jelly&&(__p+='\n<img class="vehicle-image" src="'+(null==(__t=jelly)?"":__t)+'" />\n'),__p+="\n<h3>"+(null==(__t=displayYear)?"":__t)+" "+(null==(__t=title.replace(/ *\([^)]*\) */g,""))?"":__t)+'</h3>\n<a class="btn btn-pill contact-a-dealer" data-index="'+(null==(__t=index)?"":__t)+'" data-flyout-form="INVENTORY_SEARCH" data-model-code="'+(null==(__t=seriesCode)?"":__t)+'" data-trim-id="'+(null==(__t=model.code)?"":__t)+'" href="#">\n<i class="icon-arrow-right"></i><span>Contact a Dealer</span>\n</a>\n</div>\n<div class="vehicle-result-description engine separator">\n<h4>Engine &amp; Transmission</h4>\n<span class="line-item">'+(null==(__t=SIT._.linkDisclaimer(engine))?"":__t)+'</span>\n<span class="line-item">'+(null==(__t=SIT._.linkDisclaimer(transmission))?"":__t)+'</span>\n</div>\n<div class="vehicle-result-description colors separator">\n<h4>Colors</h4>\n<ul class="exterior-colors color-picker unstyled">\n<li>\n<a href="#" data-code="'+(null==(__t=exteriorcolor)?"":__t)+'" data-msrp="0" data-name="'+(null==(__t=exteriorcolor)?"":__t)+'"\nstyle="background:'+(null==(__t=hex)?"":__t)+'"></a>\n<div data-tooltip="&lt;strong&gt;'+(null==(__t=exteriorcolor)?"":__t)+' &lt;/strong&gt;" class="ext" data-original-title="'+(null==(__t=exteriorcolor)?"":__t)+'"></div>\n</li>\n<li>\n<a href="#" data-code="'+(null==(__t=interiorcolor)?"":__t)+'" data-msrp="0" data-name="'+(null==(__t=interiorcolor)?"":__t)+'" style="background-image:url(\''+(null==(__t=swatch)?"":__t)+'\')"></a>\n<div data-tooltip="&lt;strong&gt;'+(null==(__t=interiorcolor)?"":__t)+' &lt;/strong&gt;" class="ext" data-original-title="'+(null==(__t=interiorcolor)?"":__t)+'"></div>\n</li>\n</ul>\n</div>\n<div class="vehicle-result-description package separator">\n<h4>Packages &amp; Options</h4>',packages.length||accessories.length?(__p+="<ul>",_.each(accessories,function(a){""!==a.title&&(__p+="<li>"+(null==(__t=SIT._.linkDisclaimer(a.title))?"":__t)+"</li>")}),_.each(packages,function(a){""!==a.title&&(__p+="<li>"+(null==(__t=SIT._.linkDisclaimer(a.title))?"":__t)+"</li>")}),__p+="</ul>"):__p+="N/A",__p+='</div>\n<div class="vehicle-result-description price">\n',"$0"!==displayMsrp&&(__p+="<h4>"+(null==(__t=displayMsrp)?"":__t)+'</h4><span class="starting-text">total msrp'+(null==(__t=SIT._.linkDisclaimer("[msrp_total]"))?"":__t)+"</span>"),__p+='\n<a class="btn btn-circle tiny view-details" href="#!'+(null==(__t=details)?"":__t)+'">\n<i class="icon-arrow-right-tiny"></i>\n<span>View Details</span>\n</a>\n</div>\n</div>';return __p}}),define("ritChosen",["sit"],function(a){var b=a.$;a.$,function(){var a;a=function(){function a(){this.options_index=0,this.parsed=[]}return a.prototype.add_node=function(a){return"OPTGROUP"===a.nodeName.toUpperCase()?this.add_group(a):this.add_option(a)},a.prototype.add_group=function(a){var b,c,d,e,f,g;for(b=this.parsed.length,this.parsed.push({array_index:b,group:!0,label:a.label,children:0,disabled:a.disabled}),f=a.childNodes,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(this.add_option(c,b,a.disabled));return g},a.prototype.add_option=function(a,b,c){return"OPTION"===a.nodeName.toUpperCase()?(""!==a.text?(null!=b&&(this.parsed[b].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:c===!0?c:a.disabled,group_array_index:b,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},a}(),a.select_to_array=function(b){var c,d,e,f,g;for(d=new a,g=b.childNodes,e=0,f=g.length;f>e;e++)c=g[e],d.add_node(c);return d.parsed},this.SelectParser=a}.call(this),function(){var a,b;b=this,a=function(){function a(a,b){this.form_field=a,this.options=null!=b?b:{},this.set_default_values(),this.is_multiple=this.form_field.multiple,this.set_default_text(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup()}return a.prototype.set_default_values=function(){var a=this;return this.click_test_action=function(b){return a.test_active_click(b)},this.activate_action=function(b){return a.activate_field(b)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!0,this.search_contains=this.options.search_contains||!1,this.numeric_keyboard=this.options.numeric_keyboard||!1,this.choices=0,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0},a.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options":this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option",this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||"No results match"},a.prototype.mouse_enter=function(){return this.mouse_on_container=!0},a.prototype.mouse_leave=function(){return this.mouse_on_container=!1},a.prototype.input_focus=function(a){var b=this;return this.active_field?void 0:setTimeout(function(){return b.container_mousedown()},50)},a.prototype.input_blur=function(a){var b=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return b.blur_test()},100))},a.prototype.result_add_option=function(a){var b,c;return a.disabled?"":(a.dom_id=this.container_id+"_o_"+a.array_index,
b=a.selected&&this.is_multiple?[]:["active-result"],a.selected&&b.push("result-selected"),null!=a.group_array_index&&b.push("group-option"),""!==a.classes&&b.push(a.classes),c=""!==a.style.cssText?' style="'+a.style+'"':"",'<li id="'+a.dom_id+'" class="'+b.join(" ")+'"'+c+">"+a.html+"</li>")},a.prototype.results_update_field=function(){return this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},a.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},a.prototype.results_search=function(a){return this.results_showing?this.winnow_results():this.results_show()},a.prototype.keyup_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),b){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(a.preventDefault(),this.results_showing)return this.result_select(a);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},a.prototype.generate_field_id=function(){var a;return a=this.generate_random_id(),this.form_field.id=a,a},a.prototype.generate_random_char=function(){var a,b,c;return a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=Math.floor(Math.random()*a.length),b=a.substring(c,c+1)},a}(),b.AbstractChosen=a}.call(this),function(){var a,c,d,e,f=Object.prototype.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=this,a=b,a.fn.extend({chosen:function(b){return this.each(function(d){var e;return e=a(this),e.hasClass("chzn-done")?void 0:e.data("chosen",new c(this,b))})}}),c=function(b){function c(){c.__super__.constructor.apply(this,arguments)}return g(c,b),c.prototype.setup=function(){return this.form_field_jq=a(this.form_field),this.current_value=this.form_field_jq.val(),this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},c.prototype.finish_setup=function(){var b=1e3,c=a(".chzn-container"),d=c.length;return c.each(function(c,e){a(e).css({"z-Index":b+(d-c)})}),this.form_field_jq.addClass("chzn-done")},c.prototype.set_up_html=function(){var b,c,e,f;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",this.f_width=this.form_field_jq.outerWidth(),b=a("<div />",{id:this.container_id,"class":"chzn-container"+(this.is_rtl?" chzn-rtl":""),style:"width: "+this.f_width+"px;"}),this.is_multiple?b.html(a(this.form_field).data("type")):b.html('<a href="javascript:void(0)" class="chzn-single chzn-default"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="'+(a(this.form_field).data("type")?a(this.form_field).data("type"):"text")+'" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(b),this.container=a("#"+this.container_id),this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single")),this.dropdown=this.container.find("div.chzn-drop").first(),c=this.container.height(),e=this.f_width-d(this.dropdown),this.dropdown.css({width:e+"px",top:c+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),f=e-d(this.search_container)-d(this.search_field),this.search_field.css({width:f+"px"})),this.results_build(),this.set_tab_index(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},c.prototype.register_observers=function(){var a=this;return this.container.mousedown(function(b){return a.container_mousedown(b)}),this.container.mouseup(function(b){return a.container_mouseup(b)}),this.container.mouseenter(function(b){return a.mouse_enter(b)}),this.container.mouseleave(function(b){return a.mouse_leave(b)}),this.search_results.mouseup(function(b){return a.search_results_mouseup(b)}),this.search_results.mouseover(function(b){return a.search_results_mouseover(b)}),this.search_results.mouseout(function(b){return a.search_results_mouseout(b)}),this.form_field_jq.bind("liszt:updated",function(b){return a.results_update_field(b)}),this.form_field_jq.bind("liszt:activate",function(b){return a.activate_field(b)}),this.form_field_jq.bind("liszt:open",function(b){return a.container_mousedown(b)}),this.search_field.blur(function(b){return a.input_blur(b)}),this.search_field.keyup(function(b){return a.keyup_checker(b)}),this.search_field.keydown(function(b){return a.keydown_checker(b)}),this.is_multiple?(this.search_choices.click(function(b){return a.choices_click(b)}),this.search_field.focus(function(b){return a.input_focus(b)})):this.container.click(function(a){return a.preventDefault()})},c.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},c.prototype.container_mousedown=function(b){var c;return this.is_disabled?void 0:(c=null!=b?a(b.target).hasClass("search-choice-close"):!1,b&&"mousedown"===b.type&&!this.results_showing&&b.stopPropagation(),this.pending_destroy_click||c?this.pending_destroy_click=!1:(this.active_field?this.is_multiple||!b||a(b.target)[0]!==this.selected_item[0]&&!a(b.target).parents("a.chzn-single").length||(b.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),a(document).click(this.click_test_action),this.results_show()),this.activate_field()))},c.prototype.container_mouseup=function(a){return"ABBR"!==a.target.nodeName||this.is_disabled?void 0:this.results_reset(a)},c.prototype.blur_test=function(a){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},c.prototype.close_field=function(){return a(document).unbind("click",this.click_test_action),this.is_multiple||(this.selected_item.attr("tabindex",this.search_field.attr("tabindex")),this.search_field.attr("tabindex",-1)),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},c.prototype.activate_field=function(){return this.is_multiple||this.active_field||(this.search_field.attr("tabindex",this.selected_item.attr("tabindex")),this.selected_item.attr("tabindex",-1)),this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.options.disable_search||this.search_field.focus(),this.search_field},c.prototype.test_active_click=function(b){return a(b.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},c.prototype.results_build=function(){var a,b,c,d,f;for(this.parsing=!0,this.results_data=e.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),a="",f=this.results_data,c=0,d=f.length;d>c;c++)b=f[c],b.group?a+=this.result_add_group(b):b.empty||(a+=this.result_add_option(b),b.selected&&this.is_multiple?this.choice_build(b):b.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(b.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(a),this.parsing=!1},c.prototype.result_add_group=function(b){return b.disabled?"":(b.dom_id=this.container_id+"_g_"+b.array_index,'<li id="'+b.dom_id+'" class="group-result">'+a("<div />").text(b.label).html()+"</li>")},c.prototype.result_do_highlight=function(a){var b,c,d,e,f;if(a.length){if(this.result_clear_highlight(),this.result_highlight=a,this.result_highlight.addClass("highlighted"),d=parseInt(this.search_results.css("maxHeight"),10),f=this.search_results.scrollTop(),e=d+f,c=this.result_highlight.position().top+this.search_results.scrollTop(),b=c+this.result_highlight.outerHeight(),b>=e)return this.search_results.scrollTop(b-d>0?b-d:0);if(f>c)return this.search_results.scrollTop(c)}},c.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},c.prototype.results_show=function(){var a;if(this.is_multiple){if(this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1}else this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected);return a=this.is_multiple?this.container.height():this.container.height()-1,this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.dropdown.css({top:a+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.form_field_jq.trigger("focusin"),this.winnow_results()},c.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this}),this.dropdown.css({left:"-9000px"}),this.form_field_jq.trigger("focusout"),this.results_showing=!1},c.prototype.set_tab_index=function(a){var b;return this.form_field_jq.attr("tabindex")?(b=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.is_multiple?this.search_field.attr("tabindex",b):(this.selected_item.attr("tabindex",b),this.search_field.attr("tabindex",-1))):void 0},c.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},c.prototype.search_results_mouseup=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c.length?(this.result_highlight=c,this.result_select(b)):void 0},c.prototype.search_results_mouseover=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c?this.result_do_highlight(c):void 0},c.prototype.search_results_mouseout=function(b){return a(b.target).hasClass("active-result")?this.result_clear_highlight():void 0},c.prototype.choices_click=function(b){return b.preventDefault(),!this.active_field||a(b.target).hasClass("search-choice")||this.results_showing?void 0:this.results_show()},c.prototype.choice_build=function(b){var c,d,e,f=this;return this.is_multiple&&this.max_selected_options<=this.choices?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(c=this.container_id+"_c_"+b.array_index,this.choices+=1,d=b.disabled?'<li class="search-choice search-choice-disabled" id="'+c+'"><span>'+b.html+"</span></li>":'<li class="search-choice" id="'+c+'"><span>'+b.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+b.array_index+'"></a></li>',this.search_container.before(d),e=a("#"+c).find("a").first(),e.click(function(a){return f.choice_destroy_link_click(a)}))},c.prototype.choice_destroy_link_click=function(b){return b.preventDefault(),this.is_disabled?b.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(a(b.target)))},c.prototype.choice_destroy=function(a){return this.result_deselect(a.attr("rel"))?(this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),a.parents("li").first().remove()):void 0},c.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},c.prototype.results_reset_cleanup=function(){return this.current_value=this.form_field_jq.val(),this.selected_item.find("abbr").remove()},c.prototype.result_select=function(a){var b,c,d,e;return this.result_highlight?(b=this.result_highlight,c=b.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(b):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=b,this.selected_item.removeClass("chzn-default")),b.addClass("result-selected"),e=c.substr(c.lastIndexOf("_")+1),d=this.results_data[e],d.selected=!0,this.form_field.options[d.options_index].selected=!0,this.is_multiple?this.choice_build(d):(this.selected_item.find("span").first().text(d.text),this.allow_single_deselect&&this.single_deselect_control_build()),a.metaKey&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field_jq.val()!==this.current_value)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[d.options_index].value}),this.current_value=this.form_field_jq.val(),this.search_field_scale()):void 0},c.prototype.result_activate=function(a){return a.addClass("active-result")},c.prototype.result_deactivate=function(a){return a.removeClass("active-result")},c.prototype.result_deselect=function(b){var c,d;return d=this.results_data[b],this.form_field.options[d.options_index].disabled?!1:(d.selected=!1,this.form_field.options[d.options_index].selected=!1,c=a("#"+this.container_id+"_o_"+b),c.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[d.options_index].value}),this.search_field_scale(),!0)},c.prototype.single_deselect_control_build=function(){return this.allow_single_deselect&&this.selected_item.find("abbr").length<1?this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'):void 0},c.prototype.winnow_results=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(this.no_results_clear(),j=0,k=this.search_field.val()===this.default_text?"":a("<div/>").text(a.trim(this.search_field.val())).html(),g=this.search_contains?"":"^",f=new RegExp(g+k.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),n=new RegExp(k.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),s=this.results_data,o=0,q=s.length;q>o;o++)if(c=s[o],!c.disabled&&!c.empty)if(c.group)a("#"+c.dom_id).css("display","none");else if(!this.is_multiple||!c.selected){if(b=!1,i=c.dom_id,h=a("#"+i),f.test(c.html))b=!0,j+=1;else if((c.html.indexOf(" ")>=0||0===c.html.indexOf("["))&&(e=c.html.replace(/\[|\]/g,"").split(" "),e.length))for(p=0,r=e.length;r>p;p++)d=e[p],f.test(d)&&(b=!0,j+=1);b?(k.length?(l=c.html.search(n),m=c.html.substr(0,l+k.length)+"</em>"+c.html.substr(l+k.length),m=m.substr(0,l)+"<em>"+m.substr(l)):m=c.html,h.html(m),this.result_activate(h),null!=c.group_array_index&&a("#"+this.results_data[c.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&i===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(h))}return 1>j&&k.length?this.no_results(k):this.winnow_results_set_highlight()},c.prototype.winnow_results_clear=function(){var b,c,d,e,f;for(this.search_field.val(""),c=this.search_results.find("li"),f=[],d=0,e=c.length;e>d;d++)b=c[d],b=a(b),b.hasClass("group-result")?f.push(b.css("display","auto")):this.is_multiple&&b.hasClass("result-selected")?f.push(void 0):f.push(this.result_activate(b));return f},c.prototype.winnow_results_set_highlight=function(){var a,b;return this.result_highlight||(b=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),a=b.length?b.first():this.search_results.find(".active-result").first(),null==a)?void 0:this.result_do_highlight(a)},c.prototype.no_results=function(b){var c;return c=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),c.find("span").first().html(b),this.search_results.append(c)},c.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},c.prototype.keydown_arrow=function(){var b,c;return this.result_highlight?this.results_showing&&(c=this.result_highlight.nextAll("li.active-result").first(),c&&this.result_do_highlight(c)):(b=this.search_results.find("li.active-result").first(),b&&this.result_do_highlight(a(b))),this.results_showing?void 0:this.results_show()},c.prototype.keyup_arrow=function(){var a;return this.results_showing||this.is_multiple?this.result_highlight?(a=this.result_highlight.prevAll("li.active-result"),a.length?this.result_do_highlight(a.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},c.prototype.keydown_backstroke=function(){var a;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(a=this.search_container.siblings("li.search-choice").last(),a.length&&!a.hasClass("search-choice-disabled")?(this.pending_backstroke=a,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},c.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},c.prototype.keydown_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),8!==b&&this.pending_backstroke&&this.clear_backstroke(),b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a),this.mouse_on_container=!1;break;case 13:a.preventDefault();break;case 38:a.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},c.prototype.search_field_scale=function(){var b,c,d,e,f,g,h,i,j;if(this.is_multiple){for(d=0,h=0,f="position:absolute; left: -1000px; top: -1000px; display:none;",g=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],i=0,j=g.length;j>i;i++)e=g[i],f+=e+":"+this.search_field.css(e)+";";return c=a("<div />",{style:f}),c.text(this.search_field.val()),a("body").append(c),h=c.width()+25,c.remove(),h>this.f_width-10&&(h=this.f_width-10),this.search_field.css({width:h+"px"}),b=this.container.height(),this.dropdown.css({top:b+"px"})}},c.prototype.generate_random_id=function(){var b;for(b="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();a("#"+b).length>0;)b+=this.generate_random_char();return b},c}(AbstractChosen),d=function(a){var b;return b=a.outerWidth()-a.width()},e.get_side_border_padding=d}.call(this)}),define("app/views/rit/raq",["sit"],function(a){var b=(a.$,a._),c=(a.Events,{getCookieValues:function(a){var c="";return a.accessories&&(c=a.accessories),a.msrps&&(c=a.msrps.accessoryMsrps),{accessoriesList:a.accessoriesList,deliveryFee:a.deliveryFee,description:"N/A",displayName:a.displayName.toString().replace(/(<([^>]+)>)/gi,""),bedName:a.bed||"N/A",cabName:a.cab||"N/A",driveName:a.drive||"N/A",engineName:a.engine,exteriorColor:a.exterior_color_name,exteriorColorCode:a.exteriorcolorcode||a.exterior_color_code,exteriorColorName:a.exteriorcolor||a.exterior_color_name,gradeName:a.grade.toString().replace(/(<([^>]+)>)/gi,""),id:a.trimId,interiorColor:a.interior_color_name||"N/A",interiorColorCode:a.interiorcolorcode||a.interior_color_code,interiorColorName:a.interiorcolor||a.interior_color_name,modelCode:a.seriesCode,modelId:a.trimId,modelSeries:"",modelYear:a.displayYear||a.year,year:a.displayYear||a.year,modelName:a.seriesName.toString().replace(/(<([^>]+)>)/gi,""),series:a.seriesCode,msrp:a.msrp&&a.msrp.toString().replace("$","").replace(",",""),msrps:a.msrps,name:a.seriesName,pakage:b.pluck(a.packages,"code"),packageName:b.pluck(a.packages,"title"),image:a.jelly||a.image,seriesName:a.seriesCode,tdaCode:"N/A",msrpTotal:a.totalMsrp.toString().replace("$","").replace(",",""),totalMsrp:a.totalMsrp.toString().replace("$","").replace(",",""),transmissionName:a.transmission}},setConfigCookie:function(b){a.configuredInventory=this.getCookieValues(b)}});return c}),define("app/views/rit/results",["sit","app/views/rit/results/filter","app/views/rit/results/color-filter","app/views/rit/results/controls","app/views/rit/results/grade-filter","app/views/rit/results/price-filter","app/jst/rit/vehicle-result","ritChosen","ritBootstrapPopover","app/views/rit/raq"],function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o=a.$,p=a._,q=a.Backbone,r=a.Events,s=(a.Config,a.touchsite,0),t=(window.location.toString(),{"click #vehicleResults .view-details":"onViewDetailsClick","click #results-start-over":"onStartOverClick","click .add-more-button .btn":"onAddMoreClick","click .contact-a-dealer":"onContactADealerClick","click #gradeFilter .grade-item":"onGradeClick"}),u=q.View.extend({events:t,initialize:function(){var a=this;a.appView=a.options.appView,a.router=a.options.router,p.bindAll(a,"render","generateMarkup"),r.on("SIT:showResults",a.render),r.on("SIT:results",a.onResults,a),r.on("SIT:update:filters",a.updateFilters,a),r.on("SIT:filter:changed",a.handleFilterChange,a),r.on("SIT:router:results",a.onRefreshCount,a),k=a.$("#results-content"),l=a.$("#results-controls"),a.filters=[{el:"#trimFilter",type:"model","class":b},{el:"#packageFilter",type:"packages","class":b},{el:"#accessoryFilter",type:"accessories","class":b},{el:"#exteriorColorFilter",type:"exteriorcolor","class":c},{el:"#interiorColorFilter",type:"interiorcolor","class":c},{el:"#cabFilter",type:"cab","class":b},{el:"#bedFilter",type:"bed","class":b},{el:"#driveFilter",type:"drive","class":b},{el:"#transmissionFilter",type:"transmission","class":b}],a.gradeFilter=new e({model:a.model.grades,el:a.$("#gradeFilter #grade-panels"),router:a.router}),a.priceFilter=new f({model:a.model.filters,el:a.$("#priceFilter")}),a.controls=new d({model:a.model.filters,el:l}),p.each(a.filters,function(b){b.obj=new b["class"]({model:b.model||a.model.filters,el:a.$(b.el),router:a.router,type:b.type})})},onRefreshCount:function(){s=0},handleFilterChange:function(a){var b=this,c=a.originalEvent&&o(a.originalEvent.delegateTarget),d=a.originalEvent&&o(a.originalEvent.currentTarget);c&&(c.is("#trimFilter")?b.appView.fireIS("117.16",{filter_name:d.data("title").trim()}):c.is("#accessoryFilter")?b.appView.fireIS("117.17",{"package":d.data("title").trim()}):c.is("#exteriorColorFilter")?b.appView.fireIS("117.18",{color:d.data("title").trim()}):c.is("#interiorColorFilter")&&b.appView.fireIS("117.19",{color:d.data("title").trim()}))},onViewDetailsClick:function(a){var b=this,c=o(a.target).closest(".view-details"),d=c.closest(".vehicle-result");return r.trigger("inventory:loading"),a.preventDefault(),b.appView.fireIS("117.15",{result_position:d.index()+1,trim_engine:[d.data("displayName"),d.data("engine")].join(" "),percentage_match:"N/A"}),b.router.navigate(c.attr("href"),{trigger:!0}),!1},onContactADealerClick:function(b){var c=this,d=o(b.target).parents(".vehicle-result"),e=a.API.getTotalParsedResults()[d.index()];p.each(e.packages,function(a){a.title.length>0&&(a.title=" "+a.title.replace(/\[.*?\]/g,"").replace(/[ \t]+$/,""))}),p.each(e.accessoriesList,function(a){a.description.length>0&&(a.description=" "+a.description.replace(/\[.*?\]/g,"").replace(/[ \t]+$/,""))}),e=p.cloneDeep(session.apiWrapper.getDataForContactDealer(e),e),j.setConfigCookie(e),c.appView.fireIS("117.14",{result_position:d.index()+1,trim_engine:[e.displayName,e.engine].join(" "),percentage_match:"N/A"})},onGradeClick:function(a,b){var c=o(a.currentTarget),d=c.data("grade-name").split("|")[0]||"N/A";b||this.appView.fireIS("117.13",{model_trim:d})},onStartOverClick:function(a){var b=this;b.model.filters.reset(),b.appView.fireIS("117.10")},showNoResults:function(){debuggerOn&&console.log("results:showNoResults");var b=this,c=(b.model.filters,o("#sit-errors"));b.controls.render(),o("#gradeFilter, #filters, #results_sort_vehicles_chzn").hide(),b.appView.errors.showErrorMessage({type:"region",message:"Please check with your local dealer<br/>to learn about offers in your area.",redirect_url:""}),o(".zipcode-changer",c).remove(),o("a span",c).html("Find a Dealer"),o("a",c).attr("href","/dealers/#!zipcode/"+a.API.getCurrentZipCode()),o("a",c).attr("target","_self")},onGstContinueBtnClicked:function(){var a=this,b=a.model.filters,c=b.get("zipCode");a.appView.analytics.setPageName("T:Inventory:TDA_Redirect"),a.appView.fireIS("117.112",{device_type:a.appView.analytics.deviceType,tda_code:c,zip_code:c})},updateSeriesHeaders:function(){var b=this,c=o("#series-title"),d=a.API.getCurrentSeries(),e=a.API.getCurrentYear(),f=d.title?d.title:"",g=e.title?e.title:"";c.text(g+" "+f),"es"===a.lang?b.appView.updateHeader({title:"Nueva búsqueda en el inventario Toyota "+f,subTitle:"Encontrar un Toyota "+f+" disponible en tu área nunca ha sido más fácil."}):b.appView.updateHeader({title:"New Toyota "+f+" Inventory Search",subTitle:"Finding a Toyota "+f+" in stock near you has never been easier."})},applyColorChipToolTip:function(a,b){},onAddMoreClick:function(b){var c=this;b.preventDefault(),a.API.getNextPageOfResults(),c.router.setRouteByCurrentPicks(),c.appView.fireIS("117.109")},show:function(){s=0},hide:function(){var a=this;a.$el.removeClass("is-on"),k.find("#gradeFilter ul, #vehicleResults, #filters #trimFilter, #filters #accessoryFilter, #filters #exteriorColorFilter, #filters #interiorColorFilter, #filters #cabFilter, #filters #bedFilter, #filters #engineFilter, #filters #driveFilter, #filters #transmissionFilter, #filters #priceFilter, #filters #results-controls").empty()},firePageLoad:function(){var b=this,c=b.model,d=(b.model.get("currentSeries"),p.contains(window.location.search.split("="),"byt")?"117.3":"117.2");b.appView.analytics.setPageName("T:Inventory:Results:"+a.API.getCurrentSeries().title+":General"),b.appView.fireIS(d,{model_name:a.API.getCurrentSeries().title,number_of_results:c.results.get("results").length})},render:function(){var a=this;a.model,a.$el.addClass("is-on"),a.applyColorChipToolTip(),n=a.$(".add-more-button")},generateMarkup:function(a){var b=this,c=(b.model,a.results),d=o("#filters"),e=o("#gradeFilter"),f=o("#results-controls"),h=p.map(c,function(a,b){return a.index=b,g(a)}).join("");b.model.results.set("page",1),k.addClass("is-on"),l.show(),d.show(),e.show(),m=o(h),o("#results-sort-vehicles, #results_sort_vehicles_chzn",f).css("visibility","visible"),b.applyColorChipToolTip(),0===s&&(b.firePageLoad(),b.render()),s++},onResults:function(a){debuggerOn&&console.error("onResults:",a);var b=this;return debuggerOn&&console.time("onResults"),0===a.matchCount?void b.showNoResults():(b.generateMarkup(a),"first-page"===a.pageType?b.ingestResults():b.appendResults(),b.render(),b.updateAddMoreButton(a.showMoreButton),debuggerOn&&console.timeEnd("onResults"),void(1===s&&(b.updateFilters(),p.defer(function(){r.trigger("inventory:loaded","results")}))))},updateAddMoreButton:function(a){a?n.show():n.hide()},ingestResults:function(){var a=this;a.$("#vehicleResults").html(m)},appendResults:function(){var a=this;m.appendTo(a.$("#vehicleResults"))},updateFilters:function(){var b=this,c=b.$("#filters input[type=checkbox], #filters .color-chip");o.when(a.API.getFacetCounts()).then(function(a){p.each(c,function(b){var c=o(b),d=c.is(".color-chip"),e=c.siblings(".count"),f=a[c.data("prefix")];0===f?d?c.addClass("invalid").parents("li").removeClass("hangtag"):(c.parent().addClass("disabled"),e.text("(0)")):d?c.removeClass("invalid"):(c.parent().removeClass("disabled"),e.text("("+f+")"))})})}});return u}),define("app/jst/rit/threed-image",[],function(){return function(obj){obj||(obj={});var __p="";with(_.escape,obj)__p+='<div class="preview_image_block"><div class="IMAGE_3DROTATOR"><div class="image_area"><div class="IMAGE_3D"><div class="threed_image_error" style="display: none;"></div></div></div><div class="cleardiv"></div></div></div>';return __p}}),define("app/views/threed/image",["sit","app/jst/rit/threed-image"],function(a,b){var c=a.$,d=(a._,a.RIT,a.Backbone),e=a.Events;return{body:a.$body},d.View.extend({el:"#threed-wrapper",events:{},cacheImgsDiv:null,clicking:!1,_tmpX:null,_tmpY:null,isTouchSupported:null,curLayers:[],lHolder:null,initialize:function(a){var c=this;c.threed=a,c.options=c.threed.options,debuggerOn&&console.log("threed options:",a.options),c.isTouchSupported="ontouchstart"in window,c.threed.$el.html(b()),c.threed.$dom.image3D=c.$el.find(".IMAGE_3D"),c.initImagePlacement(),c.bindEvents()},bindEvents:function(){var a=this;e.on("angle.changed.threed",a.onAngleChange,a),e.on("view.changed.threed",a.onViewChange,a),e.on("image.next.threed",a.onBtnImgPrevClick,a),e.on("image.prev.threed",a.onBtnImgNextClick,a),e.on("imgJSON.loaded.threed",a.onImgJSONLoaded,a),e.on("picks.changed.threed",a.onPicksChange,a),e.on("profile.changed.threed",a.onProfileChange,a)},unbindEvents:function(){var a=this;e.off("angle.changed.threed",a.onAngleChange,a),e.off("view.changed.threed",a.onViewChange,a),e.off("image.next.threed",a.onBtnImgPrevClick,a),e.off("image.prev.threed",a.onBtnImgNextClick,a),e.off("imgJSON.loaded.threed",a.onImgJSONLoaded,a),e.off("picks.changed.threed",a.onPicksChange,a),e.off("profile.changed.threed",a.onProfileChange,a)},onAngleChange:function(){var a=this;debuggerOn&&console.log("onAngleChange: ",a.threed.tempAngle);var b=a.threed.tempAngle;null!==b&&""!==b?(a.threed.curAngle=b,debuggerOn&&console.log("lAngle: ",b),a.placeAngledImage(a.threed.curView,a.threed.curAngle,a.threed.curMode,a.threed.curProfile)):debuggerOn&&console.log("something wrong with angle initilization")},onImgJSONLoaded:function(){var a=this;a.pI()},onPicksChange:function(){var a=this;a.initImagePlacement()},onProfileChange:function(){var a=this;a.initImagePlacement()},onViewChange:function(){var b=this,c=b.threed.tempView;null!==c&&""!==c?(b.threed.curView=c.toLowerCase(),b.threed.curAngle=1,a.touchsite||"exterior"!==b.threed.curView||(b.threed.curAngle=2),b.placeAngledImage(b.threed.curView,b.threed.curAngle,b.threed.curMode,b.threed.curProfile)):debuggerOn&&console.log("something wrong with view initiilization")},showNextView:function(){debuggerOn&&console.log("showNextView")},showPreviousView:function(){debuggerOn&&console.log("showPreviousView")},showPreviousImage:function(){debuggerOn&&console.log("showPreviousImage");var a=this;a.threed.curAngle>1?a.threed.curAngle--:a.threed.curAngle=a.threed.viewAnglesCount,a.pI()},showNextImage:function(){debuggerOn&&console.log("showNextImage");var a=this;a.threed.curAngle<a.threed.viewAnglesCount?a.threed.curAngle++:a.threed.curAngle=1,a.pI()},initImagePlacement:function(){var a,b,c=this;if(null!==c.threed.imageModelJSON){if(a=JSON.stringify(c.threed.imageModelJSON),b=c.threed.configVariableName.getImageViews(),!b)return debuggerOn&&console.log("No Views found!!"),
null;for(var d=0;d<b.length;d++)debuggerOn&&console.log(b[d].getName()),c.threed.threedViews.push(b[d].getName());c.threed.threedViews.sort(),(void 0===c.threed.curView||null===c.threed.curView)&&(c.threed.curView=c.threed.threedViews[0].toLowerCase(),c.threed.viewAnglesCount=b[0].getAngleCount()),c.pI()}},pI:function(){var a=this;null!==a.threed.imageModelJSON?a.placeAngledImage(a.threed.curView,a.threed.curAngle,a.threed.curMode,a.threed.curProfile):a.$el.html("<span style='color:red'><b>Image model JSON not found</b></span>")},placeAngledImage:function(b,d,e,f){var g,h=this,i=a.API;c.when(a.API.getFixedPicksThreed()).then(function(a){g=i.getImagePaths(b,d,e,f,a),void 0===g&&(h.$el.empty(),debuggerOn&&console.log("image path is undefined")),h.threed.$dom.image3D.children(".LAYER_HOLDER").remove();var j=h.threed.$dom.image3D.children("img");if(g&&1===g.length&&j.length)j.attr("src",g[0]).show();else if(g&&1===g.length)j=c(document.createElement("img")).attr("src",g[0]).addClass("image_class").appendTo(h.threed.$dom.image3D);else if(g&&g.length>1){j.hide(),h.curLayers=[],h.lHolder=c(document.createElement("div")).addClass("LAYER_HOLDER");for(var k=0;k<g.length;k++){var l=h.getShortSha(g[k]);h.curLayers.push(l);var m=c(document.createElement("div")).attr("data-layerid",l).addClass("layered_layer").css("z-index",k+1).appendTo(h.lHolder);c(document.createElement("img")).attr("src",g[k]).appendTo(m).error(h.hideBrokenImg)}h.lHolder.appendTo(h.threed.$dom.image3D)}var n="string"==typeof h.threed.curView?h.threed.curView.toLowerCase():"";h.$el.removeClass("view-exterior view-interior").addClass("view-"+n)})},hideBrokenImg:function(){this.nodeName&&(debuggerOn&&console.log("Missing Hero Image",this),c(this).hide())},getShortSha:function(a){var b,c=a.substr(a.lastIndexOf("/")+1),d=c.split(".");return 2==d.length&&(b=d[0]),b},destroy:function(){var a=this;a.unbindEvents(),a.remove()}})}),define("app/views/threed/threed",["sit","app/views/threed/image"],function(a,b){var c=a.$,d=a._,e=(a.RIT,a.Backbone),f=a.Events,g=(a.$window.width(),["380_214_PNG","680_383_PNG","864_477_PNG"]);return e.View.extend({el:"#threed-wrapper",curAngle:a.touchsite?1:2,curMode:!1,curProfile:null,tempAngle:null,tempView:null,imageSection:null,anglesSection:null,viewsSection:null,configVariableName:null,imageModelJSON:null,threedViews:[],viewAnglesCount:null,threedProfiles:[],imageWidth:null,imageHeight:null,$dom:a.$dom,setConfigVariables:function(a){var b=this;b.configVariableName=a,b.imageModelJSON=a.getImageModelJsonUsingSha(),debuggerOn&&console.log("self.imageModelJSON: ",b.imageModelJSON),c.isEmptyObject(b.imageModelJSON)?b.$el.html("<span style='color:red'><b>Image model JSON not found</b></span>"):b.loadThreedImage()},initialize:function(a,b){var c=this;c.options=b,debuggerOn&&console.log("init options:",c.options),c.setConfigVariables(a)},loadedIMGJSON:function(){debuggerOn&&console.log("onImgJSONLoaded"),f.trigger("imgJSON.loaded.threed")},refresh3DUI:function(){debuggerOn&&console.log("change picks triggered"),f.trigger("picks.changed.threed")},changeView:function(b){debuggerOn&&console.log("view: ",b);var c=this;null!==b&&""!==b&&b!==c.curView?(c.tempView=b,c.$dom.image3D.children("img").attr("src",a.blanksrc),c.$dom.image3D.children(".LAYER_HOLDER").remove(),f.trigger("view.changed.threed",{view:b})):debuggerOn&&console.log("no view argument / same view")},changeAngle:function(a){var b=this;null!==a&&""!==a&&a!=b.curAngle?(b.tempAngle=a,f.trigger("angle.changed.threed",{angle:a})):debuggerOn&&console.log("no angle argument / same angle")},showNextImage:function(){f.trigger("image.next.threed")},showPreviousImage:function(){f.trigger("image.prev.threed")},getAllViews:function(){debuggerOn&&console.log("returns all views");var a=this,b=a.configVariableName.getImageViews();return b?b:null},getAnglesForView:function(a){var b,c=this;return null!==a&&""!==a?(b=c.configVariableName.getImageViews(),b?(d.each(b,function(b){void 0!==b.getName()&&b.getName().toLowerCase()===a.toLowerCase()&&(c.viewAnglesCount=b.getAngleCount())}),c.viewAnglesCount):(debuggerOn&&console.log("No Views found!!"),null)):void(debuggerOn&&console.log("no view argument"))},setProfile:function(a){var b=this;"string"==typeof a&&a.length?b.curProfile=a:debuggerOn&&console.log("No profile is supplied")},getProfiles:function(){var a=this,b=[];return void 0!==a.threedProfiles&&a.threedProfiles.length>0?b=a.threedProfiles:void 0},loadThreedImage:function(){var c,e,f=this;if(null!==f.imageModelJSON&&(f.threedProfiles=[],c=f.imageModelJSON.profileMap,void 0!==c)){if(d.each(c,function(a,b,c){d.contains(g,b)&&f.threedProfiles.push({key:b,w:a.imageSize.w,h:a.imageSize.h})}),f.threedProfiles=d.sortBy(f.threedProfiles,"w"),f.threedProfiles.length&&a.touchsite)e=f.threedProfiles[0];else{if(!f.threedProfiles.length)return void(debuggerOn&&console.log("ERROR: No Threed Profiles found!"));e=f.threedProfiles[f.threedProfiles.length-1]}f.setProfile(e.key),f.imageWidth=e.w,f.imageHeight=e.h,f.$el.attr("data-profile",e.key),f.threedImage&&f.threedImage.destroy(),f.threedImage=new b(f,f.options),debuggerOn&&console.log("self.threedImage: ",f.threedImage)}},destroy:function(){var a=this;a.threedImage.destroy(),a.threedImage=null,a.off("*"),a.remove()}})}),define("ritLocalSpecialNoModels",["sit"],function(a){var b=(a.$,a._,a.Backbone,[{apr:{tiers:{tier:[{term:[{dollarsPerThousand:"16.67",duration:"60",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"},{dollarsPerThousand:"27.78",duration:"36",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"},{dollarsPerThousand:"20.83",duration:"48",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"}],level:"0"},{term:[{dollarsPerThousand:"27.78",duration:"36",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"},{dollarsPerThousand:"20.83",duration:"48",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"},{dollarsPerThousand:"16.67",duration:"60",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"0.0"}],level:"1"},{term:[{dollarsPerThousand:"29",duration:"36",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"2.9"},{dollarsPerThousand:"22",duration:"48",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"2.9"},{dollarsPerThousand:"17",duration:"60",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"2.9"}],level:"2"},{term:[{dollarsPerThousand:"30",duration:"36",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"5.9"},{dollarsPerThousand:"23",duration:"48",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"5.9"},{dollarsPerThousand:"19",duration:"60",extraCashAmount:"500",extraCashLabel:"Bonus Cash",rate:"5.9"}],level:"3"}]},monthlyPayment:"",downPayment:"0",subventionDollarAmount:null},tfsCalculator:!1,offerLabel:"Finance Specials",offerLabelNum:"1",seriesList:{series:{included:"",excluded:null,id:"",name:"",year:""}},offerId:"prius_apr_1412191947007",startDate:"2014-10-01",endDate:"2014-11-03",title:"",useForEmail:!1,description:"Get 0.0% APR for 60 months Plus $500 Bonus Cash on a new 2014 Prius.",offerImage:"",offerImageAlt:"",offerImageDisclaimer:"",offerCard:{cardTitle:"",cardImage:"",cardImageAlt:""},bullets:{bullet:[{text:"Get 0% APR for 36 months, 0% APR for 48 months or 0% APR for 60 months for Tier 1+ and Tier 1 credit customers who finance through TFS",link:""},{text:"Plus $500 TFS Bonus Cash",link:""},{text:"All new Toyotas come standard with ToyotaCare no cost maintenance plan with roadside assistance",link:"http://www.southerncalifornia.buyatoyota.com/en/landing/toyota-care"}]},disclaimers:{disclaimer:["0.0% Annual Percentage Rates (APR) for 36 months, 0.0% APR for 48 months, 0.0% APR for 60 months available to eligible customers who finance a new, unused, or unlicensed 2014 Prius from Toyota Motor Sales, USA, Inc. (TMS) and Toyota Financial Services (TFS). Offer valid 2014-10-01 through 2014-11-03. Specific vehicles are subject to availability.  You must take retail delivery from dealer stock. Special APR may not be combined with any other Customer Cash Rebates, Bonus Cash Rebates, or Lease Offers. Finance programs available on credit approval. Not all buyers will qualify for financing from Toyota Financial Services through participating dealers. Monthly payment for every $1,000 financed is 0.0% - 36 months = $27.78; 0.0% - 48 months = $20.83; 0.0% - 60 months = $16.67. See your Toyota dealer for actual pricing, annual percentage rate (APR), monthly payment, and other terms and special offers. Pricing and terms of any finance or lease transaction will be agreed upon by you and your dealer. Special offers are subject to change or termination at any time."]},additionalDisclaimers:"",restrictions:{restriction:[]},additionalRestrictions:"",states:{state:["CA"]},lang:"EN",offerType:"APR"},{cash:{cannotBeCombinedWith:{offerId:[""]},cashAmount:"500",maxAprTerm:null,maxLeaseTerm:null,requiresTfsFinancing:!1,stackableWithApr:!1,stackableWithLease:!1,subTypeLabels:"Cash Back"},tfsCalculator:!1,offerLabel:"Cash Back",offerLabelNum:"7",seriesList:{series:{included:"",excluded:null,id:"",year:"",name:""}},offerId:"corolla_cash_1413573148285",startDate:"2014-10-01",endDate:"2014-11-03",title:"2015 Corolla Cash Back Offer",useForEmail:!1,description:"Get $500 Factory Cash Back on the purchase on a New 2015 Corolla",offerImage:"",offerImageAlt:"",offerImageDisclaimer:"",offerCard:{cardTitle:"",cardImage:"",cardImageAlt:""},bullets:{bullet:[{text:"$500 Factory Cash Back",link:""},{text:"All new Toyotas come standard with ToyotaCare no cost maintenance plan with roadside assistance",link:"http://www.southerncalifornia.buyatoyota.com/en/landing/toyota-care"}]},disclaimers:{disclaimer:["Offer ends 2014-11-03, cannot be combined and is subject to availability. Cash back from Toyota Motor Sales USA, Inc. Varies by region. See participating dealer for details. Does Not include College Grad or Military Rebate. ToyotaCare covers normal factory scheduled service. Plan is 2 years or 25K miles, whichever comes first. The new vehicle cannot be part of a rental or commercial fleet, or a livery/taxi vehicle. See participating Toyota dealer for plan details. Valid only in the continental U.S. and Alaska. Roadside Assistance does not include parts and fluids. Does not include taxes, license, title fees, insurance and dealer charges."]},additionalDisclaimers:"",restrictions:{restriction:[]},additionalRestrictions:"",states:{state:[]},lang:"EN",offerType:"Cash"},{lease:{tiers:{tier:[{term:[{allowableMileage:"12000",capitalizedCost:"30144",dueAtSigningAmount:"1499",duration:"24",extraCashAmount:"",extraCashLabel:"",leaseEndPurchase:"",mileageOverageFee:".15",monthlyPayment:"339",rentChargeFactor:".00001",securityDeposit:"0"}],level:"0"}]},acquisitionFee:"650",dispositionFee:null,subventionDollarAmount:null,dealerCash:null,downPayment:null,vehicleSellingPrice:"32375",dueAtSigning:{acquisitionFee:"0",monthlyPayment:"0",securityDeposit:"0"},accessories:{accessory:[{content:"",code:null,msrp:null,requirement:""}]}},tfsCalculator:!1,offerLabel:"Lease Specials ",offerLabelNum:0,seriesList:{series:{included:"",excluded:null,id:"",year:"",name:""}},offerId:"avalon_lease_1412192682196",startDate:"2014-10-01",endDate:"2014-11-03",title:"",useForEmail:!1,description:"Get a 2014 Avalon for $339/month for 24 months (after $200 TFS lease cash applied)",offerImage:null,offerImageAlt:"",offerImageDisclaimer:"",offerCard:{cardTitle:"",cardImage:"",cardImageAlt:""},bullets:{bullet:[{text:"Lease example for model #3544 3.5L 6-Cyl",link:""},{text:"$339/month for 24 months (after $200 TFS lease cash applied)",link:""},{text:"$1,499 drive-off",link:""},{text:"All new Toyotas come standard with ToyotaCare no cost maintenance plan with roadside assistance",link:"http://www.southerncalifornia.buyatoyota.com/en/landing/toyota-care"}]},disclaimers:{disclaimer:["Lease example for a new  2014 Avalon model  #2014 Models 3544.  Security deposit waived. Plus tax and license. Individual dealer prices vary.  Lessee responsible for maintenance, excess wear and tear, and pays $0.15 per mile for all mileage over 12,000 miles per year.  Lessee to pay $ 339 a month for 24 months with $ 1499 drive-off. Payment may vary depending on model, equipment choice, and final transaction price. Lease cash, if advertised, is only valid in combination with lease program through TFS. Must be leased from new car dealer stock by 2014-11-03. Offers cannot be combined. See your Toyota Dealer for Details.ToyotaCare covers normal factory scheduled service. Plan is 2 years or 25K miles, whichever comes first. The new vehicle cannot be part of a rental or commercial fleet, or a livery/taxi vehicle. See participating Toyota dealer for plan details. Valid only in the continental U.S. and Alaska. Roadside Assistance does not include parts and fluids."]},additionalDisclaimers:"Lease cash valid in combination with program through Toyota Financial Services.",restrictions:{restriction:[]},additionalRestrictions:"",states:{state:["CA"]},lang:"EN",offerType:"Lease"},{miscellaneous:{subTypeLabels:"Service"},tfsCalculator:!1,startDate:"2014-10-01",endDate:"2014-11-03",cashAmount:null,seriesList:{series:[{id:"",year:"",name:""}]},offerId:"miscellaneous_1412128640551",title:"ToyotaCare No Cost Maintenance Plan",useForEmail:!1,offerLabel:"",offerLabelNum:null,description:"No cost maintenance plan with roadside assistance*",offerImage:"/img/Offers/ToyotaCare_240x122.jpg",offerImageAlt:"ToyotaCare",offerImageDisclaimer:"Restrictions apply",offerCard:{cardTitle:"ToyotaCare",cardImage:"/img/Offers/ToyotaCare_240x122.jpg",cardImageAlt:"ToyotaCare"},bullets:{bullet:[{text:"Maintenance: Toyota-trained technicians will help you fulfill maintenance obligations and help improve your Toyota's overall performance, while keeping a complete history of maintenance visits. Toyota will also deliver timely reminders before your scheduled maintenance. Scheduled factory maintenance covers:-Inspect and adjust all fluid levels-Replace engine oil and oil filter-Rotate tires-Multi-point vehicle inspection",link:""},{text:"24 Hour Roadside Assistance: ToyotaCare features 24-hour roadside assistance5 for those days when you need a tire changed or a door unlocked. It covers:-Batter jump starts-Tire service-Emergency fuel delivery-Lockout protection-Towing-Winching",link:""}]},disclaimers:{disclaimer:[]},additionalDisclaimers:"*Covers normal factory scheduled service. Plan is 2 years or 25K miles, whichever comes first. The new vehicle cannot be part of a rental or commercial fleet, or a livery/taxi vehicle. See participating Toyota dealer for plan details. Valid only in the continental U.S. and Alaska. Roadside assistance does not include parts and fluids, except emergency fuel delivery. Prius Plug-in Hybrid comes with an extra year of roadside assistance, for a total of three (3) years from date of first use.",restrictions:{restriction:[]},additionalRestrictions:"",states:{state:[]},lang:"EN",offerType:"Miscellaneous"}]);return{setNoModels:function(){return b}}}),define("ritLocalSpecialTrimModel",["sit"],function(a){var b=(a.$,a._),c=a.Events,d=a.Backbone,e=d.Model.extend({url:function(){var a=this.get("service");return a},initialize:function(a){console.log("LOG init")},onFetchSuccess:function(a){console.log("onFetchSuccess:",a)},onFetchFail:function(a){console.log("onFetchFail:",a),c.trigger("trimFetch:failed")},parse:function(a){var b,c=this,d=(this.get("year"),a.series),b=c.seriesListTrimNames(d);c.set("trimData",b)},seriesListTrimNames:function(a){var c,d,e=[],f=[];return b.each(a,function(a){"tundra"===a.series_code||"tacoma"===a.series_code?b.each(a.trims,function(a){e[0]=e[1]=e[2]="",b.each(a.series_trim_attributes,function(a){switch(a.type){case"grade":e[0]=a.name;break;case"bed":e[1]=a.name;break;case"cab":e[2]=a.name}}),d=e.join(" "),f[a.trim_id]=d}):b.each(a.trims,function(a){c=b.find(a.series_trim_attributes,function(a){return"grade"===a.type?a.name:void 0}),c&&(f[a.trim_id]=c.name)})}),f}});return e}),define("ritLocalSpecialIncentivesModel",["sit","ritLoading","ritLocalSpecialNoModels","ritLocalSpecialTrimModel"],function(a,b,c,d){var e=a._,f=a.$,g=a.Events,h=a.Backbone,i=a.i18n,j=a.cookie,k=a.Geolocation,l=a.Analytics,m=["matrix|2012","matrix|2013","matrix|2014","fjcruiser|2015","fjcruiser|2014","rav4ev|2015","rav4ev|2014"],n=h.Model.extend({defaults:{zipcode:"",zipChange:["0"],filteredData:{},serviceData:{},serviceDataRendered:0,selectedVehicles:{},clearFilters:0,filteredOffers:{offertypes:[]},renderedVehicles:[],serviceFailed:0,tdaCode:"",routerData:{},pageload:0,modelName:null,modelYear:null,clickable:!0,next:0,prev:0,currentPanel:0,start:0},$wrapper:f(".local-specials-wrapper"),modelNameMap:{"prius-plug-in":"priusplugin",priuspluginhybrid:"priusplugin"},url:function(){var a,b,c=this,d=(c.get("zipcode"),j("selectedDealer"),j("selectedTDA"));return d?(a="tdaCode="+d+"&",b="/specialOffers/allOffers?"+a+"zipCode="+c.get("zipcode")):b="/specialOffers/allOffers?zipCode="+c.get("zipcode")+(c.get("modelName")?"&series="+c.get("modelName"):""),b},parse:function(a){var b,d=this,f=c.setNoModels(),g=[];a.offerBundle&&(b=a.offerBundle.offers,e.each(b,function(a,b){e.each(a.bullets.bullet,function(a){if(a&&a.text){var b=a.text.match(/\s/);b||(a.text=unescape(decodeURIComponent(a.text))),a.link=unescape(decodeURIComponent(a.link))}})}),d.options&&d.options.dealType&&(g=e.filter(b,function(a){return a.offerType.toLowerCase()===d.get("dealType")}),a.offerBundle.offers=g,0===g.length&&(g=f,a.offerBundle.offers=g))),d.data=a},initialize:function(b,c){var d=this,h=k.getZip();d.gstZip=!1,d.options=b,d.mapModelNames(),d.on("change:serviceData",d.initTrimCollection,this),g.on("trimData:isSet trimFetch:failed",d.filterIncentives,this),h.done(function(a){d.set("zipcode",a),d.getLocalSpecialsData(!1)}),g.on("zipcode:changed",function(b){b===d.get("zipcode")&&a.incentives||(d.set("zipcode",b),window.location.href.indexOf("efc")>-1&&k.setZip(b),d.zipCodeChanged())}),g.on("tdaCode:isSet",d.getLocalSpecialsData,this),h.fail(function(){g.trigger("zipcode:failed"),l.fire("misc","102.23",{current_pagename:l.currentPageName(),zip_code:f.cookie("zipcode"),device_type:l.deviceType}),f(".filters").hide(),d.$wrapper&&d.$wrapper.length>0&&d.$wrapper.unmask(),require(["text!apps/localspecials/js/template/zip-promise-fail.html","text!apps/localspecials/js/template/espanol/zip-promise-fail.html","common/js/views/zipcode-changer"],function(a,b,c){d.zipCoder=new c,"en"==i.lang?f("#vehicleoffers").html(e.template(a)):f("#vehicleoffers").html(e.template(b)),f(".zip-promise-fail .zipcode-container").html(d.zipCoder.el)})})},zipCodeChanged:function(){var a=this;a.$wrapper.mask({top:"200px"}),a.resetModel(),a.getLocalSpecialsData(!0)},resetModel:function(){var a=this;a.attributes.selectedVehicles={},a.attributes.filteredOffers&&(a.attributes.filteredOffers.offertypes=[]),a.attributes.renderedVehicles=[]},getLocalSpecialsData:function(b){var c,d,h=this;h.fetch({success:function(){if(h.data&&h.data.success!==!1){if(b&&h.get("zipChange")&&(h.get("zipChange").pop(),h.get("zipChange").push("1")),0===h.data.totalOffers&&g.trigger("offers:noIncentives"),c=h.data.offerBundle,null!=c)if(d=h.data.offerBundle.offers[0],"undefined"==typeof d)g.trigger("responseBundle:empty");else{if(void 0!==d&&h.data.code&&"GST10"===h.data.code&&h.gstZip===!1)return h.gstZip=!0,h.getLocalSpecialsData(),!1;void 0===d||d.noIncentives?d&&"GST10"!==h.data.code&&(f(".filters").show(),g.trigger("offers:noIncentives")):(h.gstZip=!1,1==f(".zip-promise-fail").length&&l.fire("misc","102.24",{tda_code:h.data.code,current_pagename:"T:Local_Specials:Zip_Code_Entry",zip_code:f.cookie("zipcode"),device_type:l.deviceType}),f(".filters").show(),h.$wrapper.unmask(),e.isEqual(h.data,h.get("serviceData"))?g.trigger("offersview:render"):h.set("serviceData",h.data))}}else console.log("getLocalSpecialsData error"),g.trigger("offersview:servicefailed");a.incentives=h},error:function(){console.log("offersview:servicefailed"),g.trigger("offersview:servicefailed")}})},initTrimCollection:function(){var a,b,c,g,h=this,i=[],j=[],k=[],l=[],m=h.get("filteredYearTrims"),n=h.get("serviceData").offerBundle.offers;if(b=h.filterTrimAndYear(n),b.singleIncludedTrim===!0){if(a=e.union(b.yearList),m){if(e.each(a,function(a,b){var c=e.find(m,function(b,c){return c.toString()===a});c||l.push(a)}),!(l.length>=1))return void h.filterIncentives();a=l}e.each(a,function(a){c=new d({service:"/CLSREST/api/vehicle_data/series?brand=toyota&key=1rPU7baCdPhU2qHbflmG&depth=1&year="+a,year:a}),i.push(c),j.push(c.fetch())}),f.when.apply(f,j).done(function(){h.get("filteredYearTrims")&&(g=h.get("filteredYearTrims"),k=g),e.each(i,function(a){k[""+a.get("year")]=a.get("trimData")}),h.set("filteredYearTrims",k),h.filterIncentives()})}else h.filterIncentives()},filterTrimAndYear:function(a){var b,c,d,f=[],g=[];return e.each(a,function(a){"Miscellaneous"!==a.offerType,a.seriesList.series.included&&(d=a.seriesList.series.included.split(","),1===d.length&&(b=!0,c=d[0].split("-"),f.push(c[0]),a.trimId={id:c[1],year:c[0]}))}),g.incentives=a,g.yearList=f,g.singleIncludedTrim=b,g},filterIncentives:function(){var a,b,c,d,f,h,i,j,k,l,n=this,o=n.get("serviceData").offerBundle.offers,p=[],q=[],r=[],s=[],t=[],u=function(a){return Math.floor(a)},v=new Date,w=new Date(v.getFullYear(),v.getMonth(),v.getDate());if(window.location.href.indexOf("#!")>=0&&0===n.get("pageload")&&(g.trigger("offers:storeRouterInfo"),n.set("pageload",1)),!e.isEmpty(o)&&void 0!==o[0]){if(n.get("modelName")){var a=n.get("serviceData").offerBundle.offers;e.each(a,function(a,b){e.isArray(a.seriesList.series)?e.each(a.seriesList.series,function(b){i=b.id.split(", "),j=b.name.split(", "),k=e.indexOf(i,n.get("modelName")),n.get("modelYear")==b.year&&i[k]==n.get("modelName")&&(a.currentFilterId=i[k],a.currentFilterName=j[k],a.currentFilterYear=b.year,t.push(a))}):a.seriesList.series.id==n.get("modelName")&&a.seriesList.series.year==n.get("modelYear")&&t.push(a)}),n.set("vehicleIncentives",t)}if(n.set("tdaCode",n.get("serviceData").code),n.get("serviceData").containsErrors)g.trigger("offers:noIncentives");else{a=n.get("serviceData").offerBundle.offers,e(a.length).times(function(b){var c=a[b].offerType;if("Miscellaneous"!=c&&"Multiple_Vehicle"!=c)p.push(a[b].seriesList.series.id),void 0==a[b].seriesList.series.id;else if("Miscellaneous"==c||"Multiple_Vehicle"==c){e.each(a[b].seriesList.series,function(a){var b=a.id.split(", ");r.push(b)});var d=a[b].seriesList.series[0].id,f=d.split(", ");e.each(f,function(a){q.push(a)})}}),e(r.length).times(function(a){var b=r[a];s=void 0!=s?s.concat(b):b});var p=e.union(s,p,q);h={},e(p.length).times(function(a){void 0===h[p[a]]&&(h[p[a]]={})}),l=n.filterTrimAndYear(a),a=l.incentives,e.each(a,function(a,g){if(-1!=a.endDate.indexOf("-")&&n.formatDate(a),void 0!=a.cash&&void 0!=a.cash.cashAmount&&(a.cash.cashAmount=u(a.cash.cashAmount)),void 0!=a.apr&&void 0!=a.apr.tiers.tier[0].term[0].extraCashAmount&&e.each(a.apr.tiers.tier[0].term,function(b,c){a.apr.tiers.tier[0].term[c].extraCashAmount=u(b.extraCashAmount)}),void 0!=a.lease&&void 0!=a.lease.tiers.tier[0].term[0].extraCashAmount&&e.each(a.lease.tiers.tier[0].term,function(b,c){a.lease.tiers.tier[0].term[c].extraCashAmount=u(b.extraCashAmount),a.lease.tiers.tier[0].term[c].capitalizedCost=u(b.capitalizedCost),a.lease.tiers.tier[0].term[c].dueAtSigningAmount=u(b.dueAtSigningAmount),a.lease.tiers.tier[0].term[c].monthlyPayment=u(b.monthlyPayment),a.lease.tiers.tier[0].term[c].allowableMileage=u(b.allowableMileage)}),n.multipleToMisc(a),"Miscellaneous"!=a.offerType){if(a.isMultipleVehicle=!1,b=a.seriesList.series.id,c=a.seriesList.series.year,-1!==e.indexOf(m,b+"|"+c)||new Date(a.endDate)<w)return;d=a.offerType,f=a.offerId,n.addTrimData(a),void 0===h[b][c]&&(h[b][c]={}),void 0!==h[b][c]&&void 0===h[b][c].incentiveid&&(h[b][c][f]={},void 0===h[b][c][f].incentivetype&&(h[b][c][f][d]=a))}else"Miscellaneous"==a.offerType&&e.each(a.seriesList.series,function(g){b=g.id,b=b.split(", "),c=g.year,e.each(b,function(b){-1!==e.indexOf(m,b+"|"+c)||new Date(a.endDate)<w||(d=a.offerType,f=a.offerId,void 0===h[b][c]&&(h[b][c]={}),void 0!==h[b][c]&&void 0===h[b][c].incentiveid&&(h[b][c][f]={},void 0===h[b][c][f].incentivetype&&(h[b][c][f][d]=a)))})})}),n.set("filteredData",h),g.trigger("offers:filtered")}}},addTrimData:function(a){var b=this,c=b.get("filteredYearTrims");a.trimId?a.trimName=c[a.trimId.year][a.trimId.id]:a.trimName=""},formatDate:function(a){var b,c,d,f,g=[],h=[],i=["year","month","day"];c=a.endDate.split("-"),b=a.startDate.split("-"),e(3).times(function(a){h[i[a]]=c[a],g[i[a]]=b[a]}),f=h.month+"/"+h.day+"/"+h.year,d=g.month+"/"+g.day+"/"+g.year,a.endDate=f,a.startDate=d},multipleToMisc:function(a){var b,c,d;"Multiple_Vehicle"==a.offerType&&(a.offerType="Miscellaneous",a.isMultipleVehicle=!0,b=a.offerId.replace("_",""),c=b.split("_")[1],d=b.split("_")[0].replace("multiplevehicle","miscellaneous"),offerId=d+"_"+c,a.offerId=offerId,a.hasOwnProperty("multivehicle")&&(a.miscellaneous=a.multivehicle,delete a.multivehicle))},getIncentiveByID:function(a){var b=this,c=b.get("serviceData").offerBundle.offers[0];return e.findWhere(c,{offerId:a})},mapModelNames:function(){var a=this;a.modelNameMap[a.get("modelName")]&&a.set("modelName",a.modelNameMap[a.get("modelName")])},setDirection:function(a){var b=this;b.set("direction",a),b.trigger("animate")},setPanel:function(a){var b=this;b.set("currentPanel",a),b.trigger("goToPanel")}});return n}),define("ritPanelSetPageTurner",["sit"],function(a){var b=a.$,c=a._,d=a.Backbone,e=a.i18n,f=d.View.extend({events:{"click .page-turn-next":"handleArrowClicks","click .page-turn-prev":"handleArrowClicks"},initialize:function(){var a=this;a.render()},render:function(){var a=this,b=a.$el,d=parseInt(b.find(".panel").css("height"),10),f="en"==e.lang?{prev:"Previous",next:"Next"}:{prev:"anterior",next:"próximo"},g=c.template('<div class="page-turner"><a class="btn page-turn-prev is-on" href="#"><span class="page-turn-position"><i class="icon-arrow-left-big"></i><span class="btn btn-page-turn-prev"></span><span class="btn page-turn-base-prev"></span><span class="btn page-turn-tip-prev"><%= prev %></span></span></a><a class="btn page-turn-next is-on" href="#"><span class="page-turn-position"><i class="icon-arrow-right-big"></i><span class="btn page-turn-tip-next"><%= next %></span><span class="btn page-turn-base-next"></span><span class="btn btn-page-turn-next"></span></span></a></div>',f);a.$(".page-turner")&&a.$(".page-turner").remove(),b.append(g(f)),a.$(".page-turn-prev, .page-turn-next").css("height",d),a.$(".page-turn-position").css("top",d/2-30),a.$(".page-turner").css({width:a.model.get("width"),"margin-left":"-"+a.model.get("width")/2+"px"}),a.handleButtons(),a.hideShowArrows()},handleArrowClicks:function(a){var c,d=this;d.$(".page-turn-prev, .page-turn-next"),a.preventDefault(),d.model.playInterval&&(clearInterval(d.model.playInterval),d.model.playInterval=setInterval(function(){d.model.setDirection("next")},d.model.autoInterval)),d.model.get("clickable")&&(c=b(a.currentTarget).hasClass("page-turn-prev")?"prev":"next",d.model.setDirection(c)),d.hideShowArrows()},hideShowArrows:function(){var a=this,b=a.model.get("currentPanel");a.model.get("infinite")||(0===b?a.$(".page-turn-prev").hide():a.$(".page-turn-prev").show(),b+1===a.model.get("max")&&"next"===a.model.get("direction")?a.$(".page-turn-next").hide():a.$(".page-turn-next").show())},fadeButton:function(a){var b=this,c=b.PageTurners;b[a+"FadeTo"]=setTimeout(function(){c.arrows[a].removeClass("white"),c.buttons[a].fadeOut()},1e3)},handleButtons:function(){function a(a,b){var d=c.PageTurners,e={},f="prev"===b?"left":"right";clearTimeout(c[b+"FadeTo"]),d.arrows[b].addClass("white"),d.buttons[b].show(),d.tips[b].show(),d.base[b].show(),e["margin-"+f]=0,d.tips[b].stop().animate(e,200)}function b(a,b){var d=c.PageTurners,e={},f="prev"===b?"left":"right";clearTimeout(c[b+"FadeTo"]),e["margin-"+f]=-1*d.tips[b].outerWidth()+"px",d.tips[b].stop().animate(e,200,function(){c.fadeButton(b),d.tips[b].hide(),d.base[b].hide()})}var c=this;c.PageTurners={tips:{prev:c.$(".page-turn-tip-prev").hide(),next:c.$(".page-turn-tip-next").hide()},base:{prev:c.$(".page-turn-base-prev").hide(),next:c.$(".page-turn-base-next").hide()},buttons:{prev:c.$(".btn-page-turn-prev").hide(),next:c.$(".btn-page-turn-next").hide()},arrows:{prev:c.$(".icon-arrow-left-big"),next:c.$(".icon-arrow-right-big")}};var d=-1*c.PageTurners.buttons.prev.width();c.PageTurners.tips.next.css("margin-right",d),c.PageTurners.tips.prev.css("margin-left",d),c.$(".page-turn-prev").hover(function(b){a(b,"prev")},function(a){b(a,"prev")}),c.$(".page-turn-next").hover(function(b){a(b,"next")},function(a){b(a,"next")})}});return f}),define("ritPanelSetPageIndicator",["sit"],function(a){var b=a.$,c=a._,d=a.Backbone,e={"click .page-indicator":"handleClicks","click .indicator ul li":"handleNavClicks"};Modernizr.touch&&(e={"touchstart .page-indicator":"handleClicks","touchstart .indicator ul li":"handleNavClicks","click .page-indicator":"handleClicks","click .indicator ul li":"handleNavClicks"});var f=d.View.extend({events:e,initialize:function(){var a=this;a.model.on("change:currentPanel",function(){a.updateIndicator(a.model.get("currentPanel"))},a),a.render()},render:function(){var a=this,c='<ul class="page-indicator"></ul>';a.$el.append(c);for(var d=a.model.get("max");d>=1;d--)b("<li/>").appendTo(a.$el.find(".page-indicator"));a.$(".page-indicator li").first().addClass("page-indicator-is-on")},handleClicks:function(a,d){var e=this,f=b(a.currentTarget),g=c.indexOf(e.$(f.find(a.target.tagName)),a.target),h=e.$("li",f).eq(g).hasClass("page-indicator-is-on");e.model.playInterval&&(clearInterval(e.model.playInterval),e.model.playInterval=setInterval(function(){e.model.setDirection("next")},e.model.autoInterval)),-1===g||h||d&&d.silent||(console.log("!!!!: ",g),e.model.setPanel(g),e.model.set("currentPanel",g),0===e.model.get("currentPanel")?e.$(".page-turn-prev").hide():e.$(".page-turn-prev").show(),e.model.get("currentPanel")+1===e.model.get("max")?e.$(".page-turn-next").hide():e.$(".page-turn-next").show())},handleNavClicks:function(a,d){var e=this,f=b(a.currentTarget),g=c.indexOf(b("li",f.parent()),a.currentTarget),h=e.$("li",f).eq(g).hasClass("page-indicator-is-on");a.preventDefault(),e.model.playInterval&&(clearInterval(e.model.playInterval),e.model.playInterval=setInterval(function(){e.model.setDirection("next")},e.model.autoInterval)),-1===g||h||d&&d.silent||(console.log("!!!!: ",g),e.model.setPanel(g),e.model.set("currentPanel",g))},updateIndicator:function(a){var b=this;b.$(".page-indicator li").removeClass("page-indicator-is-on").eq(a).addClass("page-indicator-is-on"),b.$("#explore-nav li").eq(a).trigger("click",[{silent:!0}])}});return f}),define("ritJQPPEventsKey",["sit"],function(a){function b(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}}var c=a.$,d=(a._,a.Events,{}),e={},f=b(navigator.userAgent).browser;c.event.key=function(a,b){if(void 0===a)return d;void 0===b&&(b=a,a=f),d[a]||(d[a]={}),c.extend(d[a],b),e[a]||(e[a]={});for(var g in b)e[a][b[g]]=g},c.event.key({"\b":"8","	":"9","\r":"13",shift:"16",ctrl:"17",alt:"18","pause-break":"19",caps:"20",escape:"27","num-lock":"144","scroll-lock":"145",print:"44","page-up":"33","page-down":"34",end:"35",home:"36",left:"37",up:"38",right:"39",down:"40",insert:"45","delete":"46"," ":"32",0:"48",1:"49",2:"50",3:"51",4:"52",5:"53",6:"54",7:"55",8:"56",9:"57",a:"65",b:"66",c:"67",d:"68",e:"69",f:"70",g:"71",h:"72",i:"73",j:"74",k:"75",l:"76",m:"77",n:"78",o:"79",p:"80",q:"81",r:"82",s:"83",t:"84",u:"85",v:"86",w:"87",x:"88",y:"89",z:"90",num0:"96",num1:"97",num2:"98",
num3:"99",num4:"100",num5:"101",num6:"102",num7:"103",num8:"104",num9:"105","*":"106","+":"107","-":"109",".":"110","/":"111",";":"186","=":"187",",":"188","-":"189",".":"190","/":"191","`":"192","[":"219","\\":"220","]":"221","'":"222","left window key":"91","right window key":"92","select key":"93",f1:"112",f2:"113",f3:"114",f4:"115",f5:"116",f6:"117",f7:"118",f8:"119",f9:"120",f10:"121",f11:"122",f12:"123"}),jQuery.Event.prototype.keyName=function(){var a=this,b=/\w/,c=e[f][(a.keyCode||a.which)+""],d=String.fromCharCode(a.keyCode||a.which),g=a.charCode&&e[f][a.charCode+""],h=a.charCode&&String.fromCharCode(a.charCode);return h&&b.test(h)?h.toLowerCase():g&&b.test(g)?h.toLowerCase():d&&b.test(d)?d.toLowerCase():c&&b.test(c)?c.toLowerCase():"keypress"==a.type?a.keyCode?String.fromCharCode(a.keyCode):String.fromCharCode(a.which):!a.keyCode&&a.which?String.fromCharCode(a.which):e[f][a.keyCode+""]}}),define("ritPanelSet",["sit","ritPanelSetPageTurner","ritPanelSetPageIndicator","ritJQPPEventsKey"],function(a,b,c,d,e){var f=a.$,g=a._,h=a.Backbone,i=a.Events,j=a.touchsite,k=a.$document,l=a.$window,m=!0,n=a.i18n,o=Modernizr.touch?{"swipeleft .panel":"leftSwiper","swiperight .panel":"rightSwiper","touchstart .yt-container":"togglePausePlay",'touchstart a[data-toggle="tab"]':"handleTabNavs"}:{'click a[data-toggle="tab"]':"handleTabNavs","hover .yt-container":"togglePausePlay"},p=h.View.extend({events:o,initialize:function(a){var d=this;d.options=g.extend({el:d.$(".panel-container"),pageTurner:!1,pageIndicator:!1,pageIndicatorContainer:null,infinite:!0,autoInterval:0,resize:!1,minMax:!1,maxWidth:1500,minWidth:1024,keyNavigation:!0},a),d.model=d.options.state,d.resizeTimer,d.currentScrollPos=0,d.prevScrollPos=0,d.options.minMax&&(d.model.minMax=d.options.minMax,d.model.minWidth=d.options.minWidth,d.model.maxWidth=d.options.maxWidth),g.bindAll(d,"render"),d.options.keyNavigation&&(k.on("keydown",d.handleKeyStrokes).on("keyup",d.setAllowed),k.on("focus",d.setAllowed).on("scroll",d.handleScroll)),d.model.set("infinite",d.options.infinite),d.model.on("animate",function(){"next"===d.model.get("direction")?d.next():d.prev()}),d.model.on("goToPanel",function(){d.goToPanel()}),i.on("mlp:goToPanel",function(a,c,e){if(d.el.id===c.attr("id")){if(d.model.setPanel(a),d.model.set("currentPanel",a),d.model.set("direction","next"),d.goToPanel(),e)return;d.pageTurner=new b({el:d.el,model:d.options.state})}}),d.$panelSet=d.$(".panel-set"),d.$allPanels=d.$(".panel"),d.render(),d.options.pageIndicator&&d.$allPanels.length>1&&(d.pageIndicator=new c({el:d.options.pageIndicatorContainer?f(d.options.pageIndicatorContainer,this.el):this.el,model:d.options.state})),d.options.resize&&l.on("resize",d.onResize),d.options.autoInterval&&(d.model.autoInterval=d.options.autoInterval,d.model.playInterval=setInterval(function(){d.model.setDirection("next")},d.model.autoInterval));var e=d.options.start||d.model.get("start");e&&(d.model.set("currentPanel",e-1),d.model.setPanel(e-1))},render:function(){var a,c,d,e=this;f(".panel-container:first").addClass("active-section"),e.model.set("clickable",!0),e.$allPanels.each(function(a){var b=f(this),c=b.data(),d={};c.background&&(d["background-image"]="url("+c.background+")",d["background-position"]="center top"),c.color&&(d.color="#"+c.color),b.css(d),c.title&&b.find(".page-header h2").html(c.title),b.hasClass("panel-custom")&&c.customPanel&&("en"==n.lang?require(["common/js/views/panels/custom/"+c.customPanel+"/main"],function(a){new a({el:b})}):require(["common/js/views/panels/custom/espanol/"+c.customPanel+"/main"],function(a){new a({el:b})}),e.customPanelDisclaimers(b),e.$(".nav-tabs, .explore-tabs, .pill-tab").parent().navIndicator()),e.absolutize(b)}),e.$allPanels.first().show(),d=e.$allPanels.length,e.model.set("max",d),a=e.$allPanels.outerWidth(),c=(d-1)*a===0?a:(d-1)*a,d>1&&e.options.pageTurner&&(e.pageTurner=new b({el:e.el,model:e.options.state})),e.$panelSet.css({width:c+"px",left:"-"+a+"px"})},absolutize:function(a){var b=this,c=b.$el.outerWidth();b.model.minMax&&(parseInt(c,10)<=b.model.minWidth&&(c=b.model.minWidth),parseInt(c,10)>=b.model.maxWidth&&(c=b.model.maxWidth)),b.model.set("width",c),a.css({width:c,position:"absolute",left:c})},next:function(){var a=this,b=a.model.get("currentPanel"),c=a.model.get("max"),d=a.model.get("width"),e=b+1;c===e&&(e=0),a.model.set({prev:b,next:e,position:2*d,move:"-"+2*d,currentPanel:e}),a.animate()},prev:function(){var a=this,b=a.model.get("currentPanel"),c=a.model.get("max"),d=b-1;-1===d&&(d=c-1),a.model.set({prev:b,next:d,position:0,move:0,currentPanel:d}),a.animate()},animate:function(){var a=this,b=a.model.get("width"),c=a.model.get("next"),d=a.model.get("prev"),e=a.model.get("position"),f=a.model.get("move");$panelSet=a.$panelSet,a.model.set("clickable",!1),$panelSet.children(":eq("+c+")").css({left:e,display:"block"}),$panelSet.animate({left:f},500,function(){$panelSet.css({left:"-"+b+"px"}),$panelSet.children(":eq("+c+")").css({left:b,zIndex:5}),$panelSet.children(":eq("+d+")").css({left:b,display:"none",zIndex:0}),a.model.set("clickable",!0)})},goToPanel:function(){var a=this;a.$allPanels.hide().eq(a.model.get("currentPanel")).fadeIn()},setAllowed:function(){m=!0},pause:function(){var a=this;a.model.playInterval&&(clearInterval(a.model.playInterval),delete a.model.playInterval,a.trigger("pause"))},play:function(){var a=this;!a.model.playInterval&&a.options.autoInterval&&(a.model.autoInterval=a.options.autoInterval,a.model.playInterval=setInterval(function(){a.model.setDirection("next")},a.model.autoInterval),a.trigger("play"))},togglePausePlay:function(a){this["mouseenter"===a.type?"pause":"play"]()},handleKeyStrokes:function(a){var b,c=this,d=a.keyName();if((c.$el.is(".active-section")||c.$el.parents("section").hasClass("active-section"))&&c.model.get("clickable")&&("left"==d||"right"==d)){if(1===c.model.get("max"))return;if(!c.model.get("infinite")){if(0===c.model.get("currentPanel")&&"left"===d&&"prev"===c.model.get("direction"))return;if(c.model.get("currentPanel")+1===c.model.get("max")&&"next"===c.model.get("direction")&&"right"==d&&"next"===c.model.get("direction"))return}c.model.playInterval&&(clearInterval(c.model.playInterval),c.model.playInterval=setInterval(function(){c.model.setDirection("next")},c.model.autoInterval)),b="left"==d?"prev":"next",c.model.setDirection(b),c.model.get("infinite")||(0===c.model.get("currentPanel")?c.$(".page-turn-prev").hide():c.$(".page-turn-prev").show(),c.model.get("currentPanel")+1===c.model.get("max")&&"next"===c.model.get("direction")?c.$(".page-turn-next").hide():c.$(".page-turn-next").show())}if(m){m=!1;var e=f(".active-section"),g=f(".wrapper header").height(),h=e.position().top-g;"j"===d&&e.next().is(".panel-container")?(h>l.scrollTop()?h=e.position().top:h===c.prevScrollPos&&(h=e.next().position().top-g),f("html, body").animate({scrollTop:h},800)):"k"===d&&e.prev().is(".panel-container")&&(h<l.scrollTop()?h=e.position().top:h==c.prevScrollPos&&(h=e.prev().position().top-g),f("html, body").animate({scrollTop:h},800)),c.prevScrollPos=h}},handleScroll:function(){var a,b=this,c=f(".active-section"),d=l.scrollTop(),e=l.height(),g=c.outerHeight(!0),h=c.position().top-d,i=h+g;d>b.currentScrollPos&&i<parseInt(e/2,10)?(a=c.next(),a.hasClass("panel-container")&&(c.removeClass("active-section"),a.addClass("active-section"))):d<b.currentScrollPos&&h>parseInt(e/2,10)&&(a=c.prev(),a.hasClass("panel-container")&&(c.removeClass("active-section"),a.addClass("active-section"))),b.currentScrollPos=d},onResize:function(){var a=this;clearTimeout(a.resizeTimer),a.resizeTimer=setTimeout(function(){a.$allPanels.each(function(b){a.absolutize(f(this))}),a.panelSetAdjust()},100)},panelSetAdjust:function(){var a=this,b=a.model.get("width");a.$panelSet.css({left:"-"+b+"px",width:b}),a.$(".page-turner").css({width:b,"margin-left":"-"+b/2+"px"})},leftSwiper:function(a){console.log("swipe left"),this.swipe("left")},rightSwiper:function(a){console.log("swipe right"),this.swipe("right")},swipe:function(a){var b=this,c=b.model.get("infinite"),d=b.model.get("currentPanel"),e=b.model.get("max"),f=b.model.get("clickable");if(a="left"===a?"next":"prev",1!=e){if(b.model.playInterval&&(clearInterval(b.model.playInterval),b.model.playInterval=setInterval(function(){b.model.setDirection("next")},b.model.autoInterval)),"next"===a&&!c&&d+1===e)return;if("prev"===a&&!c&&0===d)return;f&&j&&b.model.setDirection(a)}},handleTabNavs:function(a){function b(){console.debug("end of the transition"),j.css("background-image","url("+h+")"),n.toggleClass("in")}var c=this,d=c.$(a.currentTarget),e=d.data(),h=e.background,i=f.support.transition,j=d.parents("section.panel"),k=d.parents(".nav-options"),l=j.find(".page-header"),m=d.parents(".page-content"),n=j.children(".panel-background"),o=e.navBackgroundClass?g.contains(e.navBackgroundClass.split(" "),"light"):void 0,p=e.headerBackgroundClass?g.contains(e.headerBackgroundClass.split(" "),"light"):void 0,q=e.textBackgroundClass?g.contains(e.textBackgroundClass.split(" "),"light"):void 0;d.hasClass("current-tab")||(h&&(i?(console.log(f.support.transition.end),n.one(f.support.transition.end,b),console.log(n),console.log("css transition"),n.css({"background-image":"url("+h+")"}),n.toggleClass("in")):(console.log("dom animated"),n.css({"background-image":"url("+h+")",display:"none"}).stop(!0,!0).fadeIn({complete:function(a){end()},duration:333,queue:!0})),c.$(".current-tab").removeClass("current-tab"),d.addClass("current-tab")),void 0!==o&&(o?k.removeClass("dark").addClass("light"):k.removeClass("light").addClass("dark")),void 0!==p&&(p?l.removeClass("dark").addClass("light"):l.removeClass("light").addClass("dark")),void 0!==q&&(q?m.removeClass("dark").addClass("light"):m.removeClass("light").addClass("dark")))},customPanelDisclaimers:function(a){var b=a.html(),c=a.attr("data-custom-disclaimer");g.each(c.split(","),function(a){var c=a.replace(/[\[\]']+/g,""),d=c.split(":")[0],e=c.split(":")[1],f=new RegExp("data-disclaimer=&quot;"+d+"&quot;>(.*?)</a>","g"),g=new RegExp("data-disclaimer=&quot;"+d+"&quot;&gt;(.*?)&lt;/a&gt;","g"),h=new RegExp('data-disclaimer="'+d+'"(.*?)</a>',"g");b=b.replace(f,"data-disclaimer=&quot;"+e+"&quot;><sup>"+e+"</sup></a>"),b=b.replace(g,"data-disclaimer=&quot;"+e+"&quot;><sup>"+e+"</sup></a>"),b=b.replace(h,"data-disclaimer="+e+"><sup>"+e+"</sup></a>")}),a.html(b)}});return p}),define("app/jst/rit/local-specials/apr-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<li><div class="offer apr-offer" data-type="apr" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-rate="'+(null==(__t=rate)?"":__t)+'" data-term="'+(null==(__t=term)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=modelYr)?"":__t)+'"><div class="ribbon"></div><div class="offer-header"><div class="apr-offer-label">Finance a <span class="model-year">'+(null==(__t=modelYr)?"":__t)+'</span></div><div class="apr-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="label-trim-name">'+(null==(__t=trimName)?"":__t)+'</div><div class="apr-rate"><span>'+(null==(__t=rate)?"":__t)+"<sup>%</sup>APR</span>for<span>"+(null==(__t=term)?"":__t)+"</span>months</div>",0!==additionalCash&&(__p+='<div class="cashback-rate"><span>+ <strong><sup>$</sup>'+(null==(__t=additionalCash)?"":__t)+"</strong></span>cash</div>"),__p+='</div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny apr" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#"><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/apr-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj){if(__p+='<div class="offer-details-container apr-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="apr-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional APR Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(a){var b=bltsData[a].text,c=bltsData[a].link;_.isEmpty(b)||(__p+=_.isEmpty(c)?"<li>"+(null==(__t=b)?"":__t)+"</li>":'<li><a href="'+(null==(__t=c)?"":__t)+'" target="_blank">'+(null==(__t=b)?"":__t)+"</a></li>")}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-series="'+(null==(__t=seriesList.series.name)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>';else if(void 0!=region&&_.isEqual(region,"SET10"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/build?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>');else if(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)?__p+="<!-- blank on purpose -->":(__p+='<a class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),!_.isEqual(applicableModelYear,"2012")){if("2014.5"==applicableModelYear){applicableModelYear="2014";var year="2014.5"}__p+='<a class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>',"2014.5"==year&&(applicableModelYear=year)}__p+='<a href="#" class="btn btn-gray large print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-print"></i></a><a class="btn apr-print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="#"><span>Print Offer</span></a><div class="email-offer"><a class="apr-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="apr-email-label">Email Offer</span></a></div>';var expDate=new Date(endDate);Date.UTC(expDate.getFullYear(),expDate.getMonth(),expDate.getDate()),__p+='<div class="tcom-exact-target" data-type="localspecials" data-cta-title="Email Offer" data-title="Email Local Special" data-callout="Send an email with this Local Special" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-trim-name="'+(null==(__t=trimName)?"":__t)+'" data-zip-code="'+(null==(__t=zipCode)?"":__t)+'" data-vin="" data-offer-type="Regional APR Offer" data-incentive-type="'+(null==(__t=incentiveType)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-confirmation="An email with the details of this offer has been sent to:" data-error-details="Email services are down, please Print Offer or try again later." data-tda-code="'+(null==(__t=tdaCode)?"":__t)+'" data-featured="'+(null==(__t=featured)?"":__t)+'" data-tile-pos="'+(null==(__t=tilePos)?"":__t)+'" data-offer-description="'+(null==(__t=offerDescription)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-multivehicle-flag="'+(null==(__t=isMultipleVehicle)?"":__t)+'"></div></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers&&" "!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>"}return __p}}),define("app/jst/rit/local-specials/cashback-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<li><div class="offer cashback-offer" data-type="cash" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-cashback="'+(null==(__t=cashBack)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="offer-header"><div class="cashback-offer-label">Cash back on a<span class="model-year">'+(null==(__t=applicableModelYear)?"":__t)+'</span></div><div class="cashback-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="label-trim-name">'+(null==(__t=trimName)?"":__t)+'</div><div class="cashback-rate"><span><sup>&#36;</sup>'+(null==(__t=cashBack)?"":__t)+'</span>Cash Back</div></div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny cashback" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/cashback-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj){if(__p+='<div class="offer-details-container cashback-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="cashback-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional Cash Back Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(a){var b=bltsData[a].text,c=bltsData[a].link;_.isEmpty(b)||(__p+=_.isEmpty(c)?"<li>"+(null==(__t=b)?"":__t)+"</li>":'<li><a href="'+(null==(__t=c)?"":__t)+'" target="_blank">'+(null==(__t=b)?"":__t)+"</a></li>")}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-series="'+(null==(__t=seriesList.series.name)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>';else if(void 0!=region&&_.isEqual(region,"SET10"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/build?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>');else if(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)||(__p+='<a class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),!_.isEqual(applicableModelYear,"2012")){if("2014.5"==applicableModelYear){applicableModelYear="2014";var year="2014.5"}__p+='<a class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>',"2014.5"==year&&(applicableModelYear=year)}__p+='<a href="#" class="btn btn-gray large print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-print"></i></a><a class="btn cashback-print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="#"><span>Print Offer</span></a><div class="email-offer"><a class="cashback-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="cashback-email-label">Email Offer</span></a></div>';var expDate=new Date(endDate);Date.UTC(expDate.getFullYear(),expDate.getMonth(),expDate.getDate()),__p+='<div class="tcom-exact-target" data-type="localspecials" data-title="Email Local Special" data-cta-title="Email Offer" data-callout="Send an email with this Local Special" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-trim-name="'+(null==(__t=trimName)?"":__t)+'" data-zip-code="'+(null==(__t=zipCode)?"":__t)+'" data-vin="" data-offer-type="Regional Cash Back Offer" data-incentive-type="'+(null==(__t=incentiveType)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-confirmation="An email with the details of this offer has been sent to:" data-error-details="Email services are down, please Print Offer or try again later." data-tda-code="'+(null==(__t=tdaCode)?"":__t)+'" data-featured="'+(null==(__t=featured)?"":__t)+'" data-tile-pos="'+(null==(__t=tilePos)?"":__t)+'" data-offer-description="'+(null==(__t=offerDescription)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-multivehicle-flag="'+(null==(__t=isMultipleVehicle)?"":__t)+'"></div></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers&&" "!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>"}return __p}}),define("app/jst/rit/local-specials/lease-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<li><div class="offer lease-offer" data-type="lease" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-monthly="'+(null==(__t=leaseMonthlyPayment)?"":__t)+'" data-term="'+(null==(__t=leaseTerm)?"":__t)+'" data-due="'+(null==(__t=leaseDueAtSigning)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="ribbon"></div><div class="offer-header"><div class="lease-offer-label">Lease a<span class="model-year">'+(null==(__t=applicableModelYear)?"":__t)+'</span></div><div class="lease-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="label-trim-name">'+(null==(__t=trimName)?"":__t)+'</div><div class="lease-rate"><span><sup>&#36;</sup>'+(null==(__t=leaseMonthlyPayment)?"":__t)+"</span>per month for<span>"+(null==(__t=leaseTerm)?"":__t)+'</span>months</div><div class="lease-due-signing"><span><sup>&#36;</sup>'+(null==(__t=leaseDueAtSigning)?"":__t)+"</span>due at signing</div>",0!==additionalCash&&void 0!==additionalCash&&(__p+='<div class="cashback-rate"><span>+ <strong><sup>$</sup>'+(null==(__t=additionalCash)?"":__t)+"</strong></span>cash</div>"),__p+='</div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny lease" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/lease-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj){if(__p+='<div class="offer-details-container lease-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="lease-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional Lease Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(a){var b=bltsData[a].text,c=bltsData[a].link;_.isEmpty(b)||(__p+=_.isEmpty(c)?"<li>"+(null==(__t=b)?"":__t)+"</li>":'<li><a href="'+(null==(__t=c)?"":__t)+'" target="_blank">'+(null==(__t=b)?"":__t)+"</a></li>")}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-series="'+(null==(__t=seriesList.series.name)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>';else if(void 0!=region&&_.isEqual(region,"SET10"))__p+='<a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/build?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>');else if(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)||(__p+='<a class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),!_.isEqual(applicableModelYear,"2012")){if("2014.5"==applicableModelYear){applicableModelYear="2014";var year="2014.5"}__p+='<a class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>',
"2014.5"==year&&(applicableModelYear=year)}__p+='<a href="#" class="btn btn-gray large print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'"><i class="icon-print"></i></a><a class="btn lease-print" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-type="'+(null==(__t=offerType)?"":__t)+'" href="#."><span>Print Offer</span></a><div class="email-offer"><a id="emailBtn" class="lease-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="lease-email-label">Email Offer</span></a></div>';var expDate=new Date(endDate);Date.UTC(expDate.getFullYear(),expDate.getMonth(),expDate.getDate()),__p+='<div class="tcom-exact-target" data-type="localspecials" data-title="Email Local Special" data-cta-title="Email Offer" data-callout="Send an email with this Local Special" data-series-name="'+(null==(__t=seriesName)?"":__t)+'" data-trim-name="'+(null==(__t=trimName)?"":__t)+'" data-zip-code="'+(null==(__t=zipCode)?"":__t)+'" data-vin="" data-offer-type="Regional Lease Offer" data-incentive-type="'+(null==(__t=incentiveType)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-confirmation="An email with the details of this offer has been sent to:" data-error-details="Email services are down, please Print Offer or try again later." data-tda-code="'+(null==(__t=tdaCode)?"":__t)+'" data-featured="'+(null==(__t=featured)?"":__t)+'" data-tile-pos="'+(null==(__t=tilePos)?"":__t)+'" data-offer-description="'+(null==(__t=offerDescription)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-multivehicle-flag="'+(null==(__t=isMultipleVehicle)?"":__t)+'"></div></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers&&" "!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p> ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>"}return __p}}),define("app/jst/rit/local-specials/espanol/apr-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<li><div class="offer apr-offer" data-type="apr" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-rate="'+(null==(__t=rate)?"":__t)+'" data-term="'+(null==(__t=term)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=modelYr)?"":__t)+'"><div class="ribbon"></div><div class="offer-header"><div class="apr-offer-label">Finance a '+(null==(__t=modelYr)?"":__t)+'</div><div class="apr-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="apr-rate"><span>'+(null==(__t=rate)?"":__t)+"<sup>%</sup>APR</span>for<span>"+(null==(__t=term)?"":__t)+"</span>months</div>",0!==additionalCash&&(__p+='<div class="cashback-rate"><span>+ <strong><sup>$</sup>'+(null==(__t=additionalCash)?"":__t)+"</strong></span>cash</div>"),__p+='</div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny apr" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#"><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/espanol/apr-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<div class="offer-details-container apr-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="apr-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional APR Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(a){var b=bltsData[a].text,c=bltsData[a].link;if(!_.isEmpty(b)){var d=b.match(/\s/);if(!d||!d.length)try{b=unescape(decodeURIComponent(b.replace(/\+/g," ")))}catch(e){}if(_.isEmpty(c))__p+="<li>"+(null==(__t=b)?"":__t)+"</li>";else{try{c=unescape(decodeURIComponent(bltsData[a].link.replace(/\+/g," ")))}catch(e){}__p+='<li><a href="'+(null==(__t=c)?"":__t)+'" target="_blank">'+(null==(__t=b)?"":__t)+"</a></li>"}}}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST")?__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>':void 0!=region&&_.isEqual(region,"SET10")?(__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/construye?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')):(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)||(__p+='<a class="btn btn-pill buildYours" href="/espanol/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),_.isEqual(applicableModelYear,"2012")||(__p+='<a class="btn btn-pill searchInventory" href="/espanol/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')),__p+='<div class="email-offer"><a class="apr-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="apr-email-label">Email Offer</span></a></div><a href="#" class="btn btn-gray large print"><i class="icon-print"></i></a><a class="btn apr-print" href="#"><span>Print Offer</span></a></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>";return __p}}),define("app/jst/rit/local-specials/espanol/cashback-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<li><div class="offer cashback-offer" data-type="cash" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-cashback="'+(null==(__t=cashBack)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'"  data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="offer-header"><div class="cashback-offer-label">Cash Back on a<span class="model-year">'+(null==(__t=applicableModelYear)?"":__t)+'</span></div><div class="cashback-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="cashback-rate"><span><sup>&#36;</sup>'+(null==(__t=cashBack)?"":__t)+'</span>Cash Back</div></div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny cashback" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/espanol/cashback-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<div class="offer-details-container cashback-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="cashback-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional Cash Back Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(a){var b=bltsData[a].text,c=bltsData[a].link;if(!_.isEmpty(b)){var d=b.match(/\s/);if(!d||!d.length)try{b=unescape(decodeURIComponent(b.replace(/\+/g," ")))}catch(e){}if(_.isEmpty(c))__p+="<li>"+(null==(__t=b)?"":__t)+"</li>";else{try{c=unescape(decodeURIComponent(bltsData[a].link.replace(/\+/g," ")))}catch(e){}__p+='<li><a href="'+(null==(__t=c)?"":__t)+'" target="_blank">'+(null==(__t=b)?"":__t)+"</a></li>"}}}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><i class="icon-arrow-right-medium raq" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST")?__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>':void 0!=region&&_.isEqual(region,"SET10")?(__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/construye?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')):(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)||(__p+='<a class="btn btn-pill buildYours" href="/espanol/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),_.isEqual(applicableModelYear,"2012")||(__p+='<a class="btn btn-pill searchInventory" href="/espanol/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')),__p+='<div class="email-offer"><a class="cashback-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="cashback-email-label">Email Offer</span></a></div><a href="#" class="btn btn-gray large print"><i class="icon-print"></i></a><a class="btn cashback-print" href="#"><span>Print Offer</span></a></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>";return __p}}),define("app/jst/rit/local-specials/espanol/lease-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<li><div class="offer lease-offer" data-type="lease" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-monthly="'+(null==(__t=leaseMonthlyPayment)?"":__t)+'" data-term="'+(null==(__t=leaseTerm)?"":__t)+'" data-due="'+(null==(__t=leaseDueAtSigning)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'"  data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="ribbon"></div><div class="offer-header"><div class="lease-offer-label">Lease a<span class="model-year">'+(null==(__t=applicableModelYear)?"":__t)+'</span></div><div class="lease-series-name">'+(null==(__t=seriesName)?"":__t)+'</div><div class="lease-rate"><span><sup>&#36;</sup>'+(null==(__t=leaseMonthlyPayment)?"":__t)+"</span>per month for<span>"+(null==(__t=leaseTerm)?"":__t)+'</span>months</div><div class="lease-due-signing"><span><sup>&#36;</sup>'+(null==(__t=leaseDueAtSigning)?"":__t)+"</span>due at signing</div>",0!==additionalCash&&(__p+='<div class="cashback-rate"><span>+ <strong><sup>$</sup>'+(null==(__t=additionalCash)?"":__t)+"</strong></span>cash</div>"),__p+='</div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny lease" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View Details</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/espanol/lease-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<div class="offer-details-container lease-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="lease-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Regional Lease Offer<sub>Ends '+(null==(__t=endDate)?"":__t)+'</sub></h2></div><div class="details"><div class="text"><p class="heading">'+(null==(__t=description)?"":__t)+'</p></div><div class="bullets"><ul>',_(bltsData.length).times(function(a){var b=bltsData[a].text,c=bltsData[a].link;if(!_.isEmpty(b)){var d=b.match(/\s/);if(!d||!d.length)try{b=unescape(decodeURIComponent(b.replace(/\+/g," ")))}catch(e){}if(_.isEmpty(c))__p+="<li>"+(null==(__t=b)?"":__t)+"</li>";else{try{c=unescape(decodeURIComponent(bltsData[a].link.replace(/\+/g," ")))}catch(e){}__p+='<li><a href="'+(null==(__t=c)?"":__t)+'" target="_blank">'+(null==(__t=b)?"":__t)+"</a></li>"}}}),__p+='</ul></div></div><div class="offer-buttons"><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=modelCode)?"":__t)+'" data-vehicle="'+(null==(__t=vehicleName)?"":__t)+'" data-model-year="'+(null==(__t=applicableModelYear)?"":__t)+'" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Request a Quote</span></a>',void 0!=region&&_.isEqual(region,"GST")?__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=gstMap.style)?"":__t)+"&model="+(null==(__t=gstMap.model)?"":__t)+"&zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>':void 0!=region&&_.isEqual(region,"SET10")?(__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"/construye?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" href="http://comprauntoyota.com/'+(null==(__t=setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')):(/priusplugin/.test(queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" href="'+(null==(__t=configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(queryname)||(__p+='<a class="btn btn-pill buildYours" href="/espanol/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(queryname)?null==(__t=configMapping)?"":__t:null==(__t=modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),_.isEqual(applicableModelYear,"2012")||(__p+='<a class="btn btn-pill searchInventory" href="/espanol/search-inventory/#!/results/'+(null==(__t=applicableModelYear)?"":__t)+"/"+(null==(__t=queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')),__p+='<div class="email-offer"><a id="emailBtn" class="lease-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="lease-email-label">Email Offer</span></a></div><a href="#" class="btn btn-gray large print"><i class="icon-print"></i></a><a class="btn lease-print" href="#."><span>Print Offer</span></a></div><div class="disclaimer-dtls">',__p+="undefined"!=typeof disclaimer[0]||""!==additionalDisclaimers?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=disclaimer)?"":__t)+"</p><p>"+(null==(__t=additionalDisclaimers)?"":__t)+"</p></div></div>";return __p}}),define("app/jst/rit/local-specials/other-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<li><div class="offer newother-offer" data-type="miscellaneous" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="offer-header"><div class="other-offer-label">Other</div><div class="cashback-series-name">Offers</div><div class=\'other-text\'><p>See additional offers</p><p>available in your area</p></div></div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny newother" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View All</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/other-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj){__p+='<div class="offer-details-container newother-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="newother-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Other Regional Offers</h2></div>';var offers=offerObj;_.each(offers,function(a,b,c){if(__p+="<div data-model='"+(null==(__t=a.seriesName)?"":__t)+"' data-year='"+(null==(__t=a.applicableModelYear)?"":__t)+'\' class="offer-details-wrapper"><div class="details"><div class="text"><p class="heading">'+(null==(__t=a.description)?"":__t)+"<sub>Ends "+(null==(__t=a.endDate)?"":__t)+' </sub></p></div><div class="bullets"><ul>',_(a.bltsData.length).times(function(b){var c=a.bltsData[b].text,d=a.bltsData[b].link;if(!_.isEmpty(c))if(_.isEmpty(d))__p+="<li>"+(null==(__t=c)?"":__t)+"</li>";else{var e=d.replace(/.*href=[ "']*([^ "']+)[ "'\/>]+.*/,"$1");__p+='<li><a href="'+(null==(__t=e)?"":__t)+'" target="_blank">'+(null==(__t=c)?"":__t)+"</a></li>"}}),__p+='</ul></div></div><div class="offer-buttons"><!--RAQ button --><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=a.modelCode)?"":__t)+'" data-series-name="'+(null==(__t=a.seriesName)?"":__t)+'" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-model-year="'+(null==(__t=a.applicableModelYear)?"":__t)+'" data-series="'+(null==(__t=a.seriesList.series.name)?"":__t)+'" data-vehicle="'+(null==(__t=a.vehicleName)?"":__t)+'" data-type="'+(null==(__t=a.offerType)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Contact Dealer</span></a>',void 0!=a.region&&_.isEqual(a.region,"GST"))__p+='<!-- Build Button --><a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-type="'+(null==(__t=a.offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=a.gstMap.style)?"":__t)+"&model="+(null==(__t=a.gstMap.model)?"":__t)+"&zip="+(null==(__t=a.zipCodeSET)?"":__t)+'&Siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><!-- Search Inventory --><a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-type="'+(null==(__t=a.offerType)?"":__t)+'" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=a.gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=a.zipCodeSET)?"":__t)+'&Siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>';else if(void 0!=a.region&&_.isEqual(a.region,"SET10"))__p+='<!-- Build Button --><a target="_blank" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-type="'+(null==(__t=a.offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=a.setRegionModelCode)?"":__t)+"/build?originating_zip_code="+(null==(__t=a.zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(a.applicableModelYear,"2012")||(__p+='<!-- Search Inventory --><a target="_blank" class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-type="'+(null==(__t=a.offerType)?"":__t)+'" href="http://southeast.buyatoyota.com/'+(null==(__t=a.setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=a.zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>');else if(/priusplugin/.test(a.queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-type="'+(null==(__t=a.offerType)?"":__t)+'" href="'+(null==(__t=a.configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(a.queryname)?__p+="<!-- blank on purpose -->":(__p+='<a class="btn btn-pill buildYours" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-type="'+(null==(__t=a.offerType)?"":__t)+'" href="/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(a.queryname)?null==(__t=a.configMapping)?"":__t:null==(__t=a.modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),!_.isEqual(a.applicableModelYear,"2012")){if("2014.5"==a.applicableModelYear){a.applicableModelYear="2014";var d="2014.5"}__p+='<a class="btn btn-pill searchInventory" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-type="'+(null==(__t=a.offerType)?"":__t)+'" href="/search-inventory/#!/results/'+(null==(__t=a.applicableModelYear)?"":__t)+"/"+(null==(__t=a.queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>',"2014.5"==d&&(a.applicableModelYear=d)}__p+='<a href="#" class="btn btn-gray large print" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-type="'+(null==(__t=a.offerType)?"":__t)+'"><i class="icon-print"></i></a><a class="btn newother-print" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-type="'+(null==(__t=a.offerType)?"":__t)+'" href="#"><span>Print Offer</span></a><div class="tcom-exact-target" data-type="localspecials" data-title="Email Local Special" data-cta-title="Email Offer" data-callout="Send an email with this Local Special" data-series-name="'+(null==(__t=a.seriesName)?"":__t)+'" data-zip-code="'+(null==(__t=a.zipcode)?"":__t)+'" data-vin="" data-offer-type="Other Regional Offers" data-incentive-type="'+(null==(__t=a.incentiveType)?"":__t)+'" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-confirmation="An email with the details of this offer has been sent to:" data-error-details="Email services are down, please Print Offer or try again later." data-tda-code="'+(null==(__t=tagDetails.tdaCode)?"":__t)+'" data-featured="'+(null==(__t=tagDetails.offerFeatured)?"":__t)+'" data-tile-pos="'+(null==(__t=tagDetails.tilePos)?"":__t)+'" data-offer-description="'+(null==(__t=tagDetails.offerDescription)?"":__t)+'" data-model-year="'+(null==(__t=a.applicableModelYear)?"":__t)+'" data-multivehicle-flag="'+(null==(__t=a.isMultipleVehicle)?"":__t)+'"></div></div><div class="disclaimer-dtls">',__p+=a.disclaimers.disclaimer.length>1||""!==a.additionalDisclaimers&&" "!==a.additionalDisclaimers||""!==a.additionalRestrictions&&" "!==a.additionalRestrictions?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=a.disclaimers.disclaimer)?"":__t)+"</p><p>"+(null==(__t=a.additionalDisclaimers)?"":__t)+"</p><p>"+(null==(__t=a.additionalRestrictions)?"":__t)+"</p></div></div>"}),__p+="</div>"}return __p}}),define("app/jst/rit/local-specials/espanol/other-offer",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<li><div class="offer newother-offer" data-type="miscellaneous" data-incentive-id="'+(null==(__t=incentiveId)?"":__t)+'" data-series="'+(null==(__t=seriesName)?"":__t)+'" data-year="'+(null==(__t=applicableModelYear)?"":__t)+'"><div class="offer-header"><div class="other-offer-label">Other</div><div class="cashback-series-name">Offers</div><div class=\'other-text\'><p>See additional offers</p><p>available in your area</p></div></div><div class="offer-details"><a id="'+(null==(__t=incentiveId)?"":__t)+'" class="btn btn-circle tiny newother" data-vehicle="'+(null==(__t=seriesName)?"":__t)+'" href="#."><i class="icon-arrow-down-tiny"></i><span>View All</span></a></div></div><div class="local-indicator"></div></li>';return __p}}),define("app/jst/rit/local-specials/espanol/other-offer-details",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj){__p+='<div class="offer-details-container newother-offer-details" style="display:none"><span class="logo"><img src="/apps/localspecials/img/logo.png" height="264" width="265" /></span><div class="newother-offer-details-header"><a href="#." class="btn btn-gray large offer-close"><i class="icon-close-large"></i></a><h2 class="offer-title">Other Regional Offers</h2></div>';var offers=offerObj;_.each(offers,function(a,b,c){__p+='<div class="offer-details-wrapper"><div class="details"><div class="text"><p class="heading">'+(null==(__t=a.description)?"":__t)+"<sub>Ends "+(null==(__t=a.endDate)?"":__t)+' </sub></p></div><div class="bullets"><ul>',_(a.bltsData.length).times(function(b){var c=a.bltsData[b].text,d=a.bltsData[b].link;if(!_.isEmpty(c))if(_.isEmpty(d))__p+="<li>"+(null==(__t=c)?"":__t)+"</li>";else{var e=d.replace(/.*href=[ "']*([^ "']+)[ "'\/>]+.*/,"$1");_.isEqual(a.language,"espanol")&&-1!=e.search("toyota-care")&&(e=e.split("toyota-care")[0]+"espanol/toyota-care/"),__p+='<li data-><a href="'+(null==(__t=e)?"":__t)+'" target="_blank">'+(null==(__t=c)?"":__t)+"</a></li>"}}),__p+='</ul></div></div><div class="offer-buttons"><!--RAQ button --><a class="btn btn-pill medium requestQuote" href="#" data-flyout-form="LOCALSPECIALS" data-model-code="'+(null==(__t=a.modelCode)?"":__t)+'" data-incentive-id="'+(null==(__t=a.incentiveId)?"":__t)+'" data-vehicle="'+(null==(__t=a.vehicleName)?"":__t)+'" data-model-year="'+(null==(__t=a.applicableModelYear)?"":__t)+'"><i class="icon-arrow-right-medium raq"></i><span>Contact Dealer</span></a>',void 0!=a.region&&_.isEqual(a.region,"GST")?__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/VehicleLandingPage.aspx?style='+(null==(__t=a.gstMap.style)?"":__t)+"&model="+(null==(__t=a.gstMap.model)?"":__t)+"&zip="+(null==(__t=a.zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_buildyour"><i class="icon-arrow-right"></i><span>Build Yours</span></a><a target="_blank" class="btn btn-pill searchInventory" href="http://www.gulfstates.buyatoyota.com/Advanced/Pages/View/Model/'+(null==(__t=a.gstMap.model)?"":__t)+"/Records/20/SortBy/0/?zip="+(null==(__t=a.zipCodeSET)?"":__t)+'&siteid=Tcom_Local_Specials_Search_Inventory"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>':void 0!=a.region&&_.isEqual(a.region,"SET10")?(__p+='<a target="_blank" class="btn btn-pill buildYours" href="http://comprauntoyota.com/'+(null==(__t=a.setRegionModelCode)?"":__t)+"/construye?originating_zip_code="+(null==(__t=a.zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>',_.isEqual(a.applicableModelYear,"2012")||(__p+='<a target="_blank" class="btn btn-pill searchInventory" href="http://comprauntoyota.com/'+(null==(__t=a.setRegionModelCode)?"":__t)+"?originating_zip_code="+(null==(__t=a.zipCodeSET)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')):(/priusplugin/.test(a.queryname)?__p+='<a target="_new" class="btn btn-pill buildYours" href="'+(null==(__t=a.configMapping)?"":__t)+'"><i class="icon-arrow-right"></i><span>Build Yours</span></a>':/rav4ev/.test(a.queryname)||(__p+='<a class="btn btn-pill buildYours" href="/espanol/configurator/#!/series/',__p+=/camryhybrid|avalonhybrid|highlanderhybrid/.test(a.queryname)?null==(__t=a.configMapping)?"":__t:null==(__t=a.modelCode)?"":__t,__p+='"><i class="icon-arrow-right"></i><span>Build Yours</span></a>'),_.isEqual(a.applicableModelYear,"2012")||(__p+='<a class="btn btn-pill searchInventory" href="/espanol/search-inventory/#!/results/'+(null==(__t=a.applicableModelYear)?"":__t)+"/"+(null==(__t=a.queryname)?"":__t)+'"><i class="icon-arrow-right"></i><span>Search Inventory</span></a>')),__p+='<!-- <div class="email-offer"><a class="newother-email popover-link" data-placement="bottom" data-html="true" data-trigger="click" data-content="<div id=\'emailPop\' class=\'emailbox\'></div>"><span class="newother-email-label">Email Offer</span></a></div> --><a href="#" class="btn btn-gray large print"><i class="icon-print"></i></a><a class="btn newother-print" href="#"><span>Print Offer</span></a></div><div class="disclaimer-dtls">',
__p+=a.disclaimers.disclaimer.length>1||""!==a.additionalDisclaimers||""!==a.additionalRestrictions?'<p class="offer-details-title">Offer Details</p>':'<p class="no-disclaimers"></p>  ',__p+="<p>"+(null==(__t=a.disclaimers.disclaimer)?"":__t)+"</p><p>"+(null==(__t=a.additionalDisclaimers)?"":__t)+"</p><p>"+(null==(__t=a.additionalRestrictions)?"":__t)+"</p></div></div>"}),__p+="</div>"}return __p}}),define("ritLocalSpecialsConfig",["sit"],function(a){var b=(a.$,a._,a.Backbone,{Avalon:"avalon",Camry:"camry",Yaris:"yaris",Corolla:"corolla",Sienna:"sienna",Prius:"prius","Prius c":"priusc","Prius 3rd Gen":"prius","Prius Plug In":"prius-plug-in","Prius Plug-in":"prius-plug-in","Prius v":"priusv","Avalon Hybrid":"avalon","Camry Hybrid":"camry","Highlander Hybrid":"highlander",RAV4:"rav4",Venza:"venza",Highlander:"highlander","4Runner":"4runner",Sequoia:"sequoia","Land Cruiser":"landcruiser",Tacoma:"tacoma",Tundra:"tundra"}),c={avalon:"Avalon",avalonhybrid:"AvalonHybrid",camry:"Camry",camryhybrid:"CamryHybrid",yaris:"Yaris",corolla:"Corolla",sienna:"Sienna",prius:"Prius",priusc:"Priusc",priusplugin:"PriusPlugIn",priusv:"Priusv","4runner":"4Runner",highlander:"Highlander",highlanderhybrid:"HighlanderHybrid",landcruiser:"LandCruiser",rav4:"RAV4",sequoia:"Sequoia",venza:"Venza",tacoma:"Tacoma",tundra:"Tundra"},d={Avalon:"avalon",Camry:"camry",Yaris:"yaris",Corolla:"corolla",Sienna:"sienna",Prius:"prius","Prius c":"prius-c","Prius C":"prius-c","Prius 3rd Gen":"prius","Prius Plug In":"prius-plug-in","Prius Plug-In":"prius-plug-in","Prius v":"prius-v","Prius V":"prius-v","Avalon Hybrid":"avalon-hybrid","Camry Hybrid":"camry-hybrid","Highlander Hybrid":"highlander-hybrid",RAV4:"rav4",Venza:"venza",Highlander:"highlander","4Runner":"4runner",Sequoia:"sequoia","Land Cruiser":"land-cruiser",Tacoma:"tacoma",Tundra:"tundra"},e={en:{"Cars & Minivan":["Avalon","Camry","Corolla","Sienna","Yaris"],"Hybrids & EVs":["Avalon Hybrid","Camry Hybrid","Highlander Hybrid","Prius","Prius c","Prius Plug In","Prius v"],"Crossovers & SUVs":["4Runner","Highlander","Land Cruiser","RAV4","Sequoia","Venza"],Trucks:["Tacoma","Tundra"]},es:{"Autos y Minivan":["Avalon","Camry","Corolla","Sienna","Yaris"],"Híbridos y EVs":["Avalon Hybrid","Camry Hybrid","Highlander Hybrid","Prius","Prius c","Prius Plug In","Prius v"],"Crossovers y SUV":["4Runner","Highlander","Land Cruiser","RAV4","Sequoia","Venza"],Camionetas:["Tacoma","Tundra"]}},f={"4runner":"Crossovers|4Runner",avalon:"Cars|Avalon",camry:"Cars|Camry",corolla:"Cars|Corolla",highlander:"Crossovers|Highlander",landcruiser:"Crossovers|Land Cruiser",prius:"Hybrids-EVs|Prius",rav4:"Crossovers|RAV4",sequoia:"Crossovers|Sequoia",sienna:"Cars|Sienna",tacoma:"Trucks|Tacoma",tundra:"Trucks|Tundra",yaris:"Cars|Yaris",venza:"Crossovers|Venza",priusc:"Hybrids-EVs|Prius <em>c</em>",priusv:"Hybrids-EVs|Prius <em>v</em>",camryhybrid:"Hybrids-EVs|Camry Hybrid",avalonhybrid:"Hybrids-EVs|Avalon Hybrid",highlanderhybrid:"Hybrids-EVs|Highlander Hybrid"};return{getModelCodes:function(){return b},getSeriesCodes:function(){return c},getSetRegionModelCodes:function(){return d},getVehicleCategories:function(){return e},getGstMappings:function(){return f}}}),define("ritLocalSpecialR2",["sit","ritLocalSpecialIncentivesModel","ritPanelSet","ritBootstrapPopover","app/jst/rit/local-specials/apr-offer","app/jst/rit/local-specials/apr-offer-details","app/jst/rit/local-specials/cashback-offer","app/jst/rit/local-specials/cashback-offer-details","app/jst/rit/local-specials/lease-offer","app/jst/rit/local-specials/lease-offer-details","app/jst/rit/local-specials/espanol/apr-offer","app/jst/rit/local-specials/espanol/apr-offer-details","app/jst/rit/local-specials/espanol/cashback-offer","app/jst/rit/local-specials/espanol/cashback-offer-details","app/jst/rit/local-specials/espanol/lease-offer","app/jst/rit/local-specials/espanol/lease-offer-details","app/jst/rit/local-specials/other-offer","app/jst/rit/local-specials/other-offer-details","app/jst/rit/local-specials/espanol/other-offer","app/jst/rit/local-specials/espanol/other-offer-details","ritLocalSpecialsConfig"],function(a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v){var w,x=a.$,y=a._,z=(a.Backbone,a.Events),A=a.touchsite,B=a.i18n,C=a.Geolocation,D={Avalon:"avalon",Camry:"camry",Yaris:"yaris",Matrix:"matrix",Corolla:"corolla",Sienna:"sienna",Prius:"prius","Prius c":"priusc","Prius 3rd Gen":"prius","Prius Plug In":"prius-plug-in","Prius Plug-in":"prius-plug-in","Prius v":"priusv","Avalon Hybrid":"avalon","Camry Hybrid":"camry","Highlander Hybrid":"highlander",RAV4EV:"rav4ev",RAV4:"rav4","FJ Cruiser":"fjcruiser",Venza:"venza",Highlander:"highlander","4Runner":"4runner",Sequoia:"sequoia","Land Cruiser":"landcruiser",Tacoma:"tacoma",Tundra:"tundra"},E={"click .offer":"renderOfferType","click .offer-close":"closeOfferDetailsSection","click .apr-print, .lease-print, .cashback-print, .print, .newother-print":"printOffer","click .offers-nav a":"cleanUp","click .page-indicator2 li":"cleanUp","touchstart .offer":"renderOfferType","touchstart .offer-close":"closeOfferDetailsSection","touchstart .apr-print, .lease-print, .cashback-print, .newother-print, .print":"printOffer","touchstart .page-indicator2 li":"cleanUp"},F=c.extend({events:E,initialize:function(){var a=this;console.log("localspecials common init"),C.getZip().done(function(a){w=a}),defaults={year:null},a.panelEl=a.$(".panel-container"),a.options=y.extend(defaults,a.options),a.model=new b({modelName:a.options.seriesName,modelYear:a.options.year}),a.model.on("change:filteredData",a.build,this),a.cleanUp()},render:function(){},cleanUp:function(){var a=this;a.$(".offer-details-container").slideUp("slow",function(){x(".offer-details-container").remove(),x(".local-indicator").hide(),a.removePrevOfferStyles(a.$(".offer a.show-dtls"))})},printOffer:function(a){a.preventDefault();var b=x(a.currentTarget).closest(".offer-details-wrapper");x("body").addClass("local-specials-print-override"),b&&b.length>0&&(x(".offer-details-wrapper").removeClass("print-wrapper"),b.addClass("print-wrapper")),setTimeout(function(){window.print(),setTimeout(function(){x("body").removeClass("local-specials-print-override")},500)},500)},build:function(){var a,b,d=this,f=""+d.options.year,h="",i=[],k=d.$(".panel-set").first(),l="",m="",n="",o="",p={APR:e,Cash:g,Lease:j,Miscellaneous:r},q={},s=0,t=d.model.get("vehicleIncentives");d.model.get("vehicleIncentives").length<4&&d.$(".panel-set").css("z-index",5),y.each(t,function(c,e){if(a=y.isArray(c.seriesList.series)?c.currentFilterYear:c.seriesList.series.year,!d.options.year||y.isEqual(a,f)||y.isEqual(a,""+Math.floor(f)))if(b=c.offerType,"Miscellaneous"!==b){switch(q={id:c.offerId,seriesName:c.seriesList.series.name,modelYr:c.seriesList.series.year,applicableModelYear:c.seriesList.series.year,"self.collectionIndex":e,description:c.description,incentiveId:c.offerId,trimName:c.trimName,zipcode:""},b){case"APR":l=c.apr.tiers.tier[0].term[0],n={term:l.duration,rate:l.rate,additionalCash:l.extraCashAmount},y.extend(q,n);break;case"Lease":m=c.lease.tiers.tier[0].term[0],n={leaseMonthlyPayment:m.monthlyPayment,leaseTerm:m.duration,due:(""+m.dueAtSigningAmount).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),leaseDueAtSigning:(""+m.dueAtSigningAmount).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),additionalCash:m.extraCashAmount},y.extend(q,n);break;case"Cash":n={cashBack:(""+c.cash.cashAmount).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},y.extend(q,n)}o=p[b](q),i.push(o)}else 1>s&&(o=p[b]({seriesName:c.currentFilterName,applicableModelYear:c.currentFilterYear,incentiveType:b,incentiveId:c.offerId}),i.push(o),s++)}),h+=d.generateSliderMarkup(i),0===i.length&&d.$el.hide(),k.empty().append(h),d.$(".panel-set").eq(0).attr("style",""),i.length>3?(d.panelEl.find(".panel").css("zIndex",0),d.panelEl.find(".panel").eq(0).css("zIndex",5),panel=new c({el:d.panelEl,pageIndicator:!0,pageTurner:!0,buttonSize:"offers-nav",state:this.model,infinite:!1,minWidth:950,maxWidth:950,enableResize:!1}),A?panel.on("panelchange:before",function(){d.cleanUp()}):panel.on("swipe:before",function(){d.cleanUp()}),d.$(".panel-set").eq(0).removeClass("singlePanel")):(d.$(".offers-turn-next").hide(),d.$(".offers-turn-prev").hide(),d.$(".panel-set").eq(0).css("zIndex",5).addClass("singlePanel")),z.trigger("localspecials:ready")},generateSliderMarkup:function(a){var b="";for(i=0;i<a.length;i+=3)b+='<section class="panel">',b+="<ul>",b+=a[i],a.length>i+1&&(b+=a[i+1]),a.length>i+2&&(b+=a[i+2]),b+="</ul>",b+="</section>";return b},renderOfferType:function(a){var b,c,d,e,g,i=this,j=i.$(a.currentTarget).find(".offer-details a"),l=i.$(a.currentTarget).find(".offer-details a").attr("class").split(" ")[3],n={},p="Hide Details",r="View Details",t=[];if(a.preventDefault(),c=i.$(".offer-details-container"),d=i.$el.find(".offer a.show-dtls"),y.isEqual(d.attr("id"),j.attr("id"))||i.removePrevOfferStyles(d),j.toggleClass("show-dtls"),j.find(".icon-arrow-down-tiny").toggleClass("icon-arrow-up-tiny"),j.hasClass("show-dtls")){switch(c.slideUp("slow",function(){c.remove()}),y.each(i.model.get("vehicleIncentives"),function(a){"Miscellaneous"==a.offerType?(g={applicableModelYear:a.currentFilterYear,seriesName:a.currentFilterName,queryname:a.currentFilterId,vehicleName:a.currentFilterName,incentiveType:a.offerType,incentiveId:a.offerId,offertype:a.offerType,disclaimer:a.disclaimers.disclaimer},y.extend(a,g),t.push(i.updateOfferProperties(a))):(b="APR"===l.toUpperCase()?j.attr("id").split("-")[0]:j.attr("id"),a.offerId.toString()===b.toString()&&(g={applicableModelYear:a.seriesList.series.year,seriesName:a.seriesList.series.id,queryname:a.seriesList.series.id,vehicleName:a.seriesList.series.name,incentiveType:a.offerType,incentiveId:a.offerId,offertype:a.offerType,disclaimer:a.disclaimers.disclaimer},y.extend(a,g),n=i.updateOfferProperties(a)))}),j.find("span").html(p),j.closest(".offer").addClass(""+l+"-offer-hover"),j.closest(".panel-container").css({height:182}),j.closest(".offer").next().show(),n.zipCode=w,l.toUpperCase()){case"LEASE":j.closest(".panel").after(("en"==B.lang?k:q)(n));break;case"CASHBACK":j.closest(".panel").after(("en"==B.lang?h:o)(n));break;case"APR":j.closest(".panel").after(("en"==B.lang?f:m)(n));break;case"NEWOTHER":j.closest(".panel").after(("en"==B.lang?s:u)({offerObj:t,tagDetails:{},zipcode:""}))}j.closest(".panel-container").removeAttr("style"),e=i.$(".offer-details-container"),i.$(".panel-set").after(e),e.css({height:"auto","float":"left",position:"relative","margin-top":50}).slideDown("slow",function(){var a=j.closest(".panel");if(z.trigger("pageLayout:changed"),j.closest(".panel-set").find(".panel").length-1==x(a).index()){var b=i.$(".car-model.single:first").find(".offer-details-container");b.css("border-bottom","none"),b.find(".disclaimer").css("margin-bottom",-15)}})}else j.find("span").html(r),j.closest(".offer").removeClass(""+l+"-offer-hover"),j.closest(".offer").next().hide(),c.slideUp("slow",function(){c.remove(),j.closest(".panel-container").removeAttr("style"),z.trigger("pageLayout:changed")})},updateOfferProperties:function(a){var b,c,d=this,e=x.cookie("tda"),f=a.bullets.bullet,g={camryhybrid:"camry/grade/Hybrid LE",avalonhybrid:"avalon/grade/Hybrid XLE Premium",highlanderhybrid:"highlander/grade/Hybrid",priusplugin:"https://auth2.toyota.com/order/prius/#page=Start"};return"Miscellaneous"==a.offerType?(b=a.currentFilterId,c=D[a.currentFilterName].replace(/-/g,"")):(b=a.seriesList.series.id,c=D[a.seriesList.series.name].replace(/-/g,"")),/camryhybrid|avalonhybrid|highlanderhybrid|priusplugin/.test(b)&&(g=g[b]),y.extend(a,{modelCode:c,region:e,endDate:a.endDate,bltsData:f,queryname:b,language:"en"===B.lang?"english":"espanol",gstMap:d.getGstUrl(b),configMapping:g,tdaCode:"",featured:"",tilePos:"",offerDescription:"",zipCode:""}),(y.isEqual(e,"SET10")||y.isEqual(e,"GST"))&&y.extend(a,{setRegionModelCode:v.getSetRegionModelCodes()[a.seriesName],zipCodeSET:d.collection.get("zipcode")}),a},closeOfferDetailsSection:function(a){var b=this,c=b.$(a.currentTarget).closest(".offer-details-container"),d=c.attr("class").split(" ")[1].split("-")[0],e="View Details";a.preventDefault(),c.prev().find(".offer").removeClass(d+"-offer-hover").removeAttr("style"),c.prev().find(".local-indicator").hide(),c.prev().find(".show-dtls span").html(e),c.prev().find(".show-dtls").removeClass("show-dtls"),c.prev().find(".icon-arrow-up-tiny").removeClass("icon-arrow-up-tiny"),c.slideUp("slow",function(){c.prev().find(".panel-container").removeAttr("style"),c.remove(),z.trigger("pageLayout:changed")})},removePrevOfferStyles:function(a){var b=a.closest(".offer"),c="View Details";a.closest(".panel-container").removeAttr("style"),void 0!==b.attr("class")&&b.closest(".offer").removeClass(""+b.attr("class").split(" ")[2]),a.closest(".offer").next().hide(),a.find("span").html(c),a.removeClass("show-dtls"),a.find(".icon-arrow-up-tiny").removeClass("icon-arrow-up-tiny")},getSelectedOffer:function(a,b){var c={};return y.each(b,function(b){b.get("incentiveId").toString()===a.toString()&&(c=b.attributes)}),c},customDateFormat:function(a,b){if(isNaN(a))return a;var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=new Date(a);return d=((c=x.getFullYear())+"").slice(-2),g=(h=x.getMonth()+1)<10?"0"+h:h,f=(e=["January","February","March","April","May","June","July","August","September","October","November","December"][h-1]).substring(0,3),k=(l=x.getDate())<10?"0"+l:l,j=(i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][x.getDay()]).substring(0,3),w=l>=10&&20>=l?"th":1==(v=l%10)?"st":2==v?"nd":3==v?"rd":"th",b=b.replace("#YYYY#",c).replace("#YY#",d).replace("#MMMM#",e).replace("#MMM#",f).replace("#MM#",g).replace("#M#",h).replace("#DDDD#",i).replace("#DDD#",j).replace("#DD#",k).replace("#D#",l).replace("#th#",w),o=m=x.getHours(),0===o&&(o=24),o>12&&(o-=12),n=10>o?"0"+o:o,u=(t=12>m?"am":"pm").toUpperCase(),p=(q=x.getMinutes())<10?"0"+q:q,r=(s=x.getSeconds())<10?"0"+s:s,b.replace("#hhh#",m).replace("#hh#",n).replace("#h#",o).replace("#mm#",p).replace("#m#",q).replace("#ss#",r).replace("#s#",s).replace("#ampm#",t).replace("#AMPM#",u)},destroy:function(){var a=this;a.remove(),a.unbind()},getGstUrl:function(a){var b,c,d="",e={"4runner":"Crossovers|4Runner",avalon:"Cars|Avalon",camry:"Cars|Camry",corolla:"Cars|Corolla",fjcruiser:"Crossovers|FJ Cruiser",highlander:"Crossovers|Highlander",landcruiser:"Crossovers|Land Cruiser",matrix:"Cars|Matrix",prius:"Hybrids-EVs|Prius",rav4:"Crossovers|RAV4",rav4ev:"Crossovers|RAV4EV",sequoia:"Crossovers|Sequoia",sienna:"Cars|Sienna",tacoma:"Trucks|Tacoma",tundra:"Trucks|Tundra",yaris:"Cars|Yaris",venza:"Crossovers|Venza",priusc:"Hybrids-EVs|Prius <em>c</em>",priusv:"Hybrids-EVs|Prius <em>v</em>",priusplugin:"Hybrids-EVs|Prius Plug-In",camryhybrid:"Hybrids-EVs|Camry Hybrid",avalonhybrid:"Hybrids-EVs|Avalon Hybrid",highlanderhybrid:"Hybrids-EVs|Highlander Hybrid"};return b=e[a].split("|")[0],c=e[a].split("|")[1].replace(/ /g,"_"),/prius|priusc|priusv/.test(a)&&(c="priusc"===a?"Prius_c":"priusv"===a?"Prius_v":"3rd_Gen_Prius"),/tacoma|tundra/.test(a)&&(c="tacoma"===a?"Tacoma_Regular_Cab":"Tundra_Regular_Cab"),d={style:b,model:c}}});return F}),define("app/sit/local-specials",["sit","ritLocalSpecialR2"],function(a,b){var c=a.$,d=(a._,a.Backbone),e=a.Events;return d.View.extend({events:{"tap .cta-local-specials":"onLocalSpecialsClick"},initialize:function(a){var b=this;b.options=a,debuggerOn&&console.log("local-specials-initialize:"),b.render()},getLocalSpecials:function(){var c=this,d={el:c.options.$el,zipcode:c.options.inventory.get("zipcode"),series:c.options.inventory.picks.get("series"),seriesName:a.API.getCurrentSeries().code,year:a.API.getCurrentYear().title};/^camry/.test(d.series)&&2014==d.year&&(d.year=2014.5),e.on("localspecials:ready",c.showLocalSpecials,c),c.localSpecials&&c.localSpecials.undelegateEvents(),c.localSpecials=new b(d)},showLocalSpecials:function(){var a=this;e.off("localspecials:ready",a.showLocalSpecials,a)},onLocalSpecialsClick:function(a){c(a.currentTarget)},render:function(){var a=this;a.getLocalSpecials()},destroy:function(){var a=this;a.LocalSpecialsAnalytics.remove()}})}),define("app/jst/rit/details",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<div id="highlightDetails">\n<div class="info-column">\n<div class="page-header">\n<span class="small">Vehicle Details</span>\n</div><span class="series-year">'+(null==(__t=data.year)?"":__t)+'</span><span class="series-name">'+(null==(__t=data.seriesName)?"":__t)+'</span><span class="trim-name">\n',data.seriesName!==data.trimName&&(__p+=null==(__t=data.trimName.replace(new RegExp(data.seriesName,"i"),""))?"":__t),__p+='\n</span><span class="price">'+(null==(__t=data.displayMsrp)?"":__t)+'</span><span class="total-MSRP">'+(null==(__t=SIT.strings.totalmsrp)?"":__t)+(null==(__t=SIT._.linkDisclaimer("[msrp_total]"))?"":__t)+'</span><a class="btn btn-pill contact-dealer" data-flyout-form="INVENTORY_SEARCH" data-model-code="'+(null==(__t=data.seriesCode)?"":__t)+'" data-trim-id="'+(null==(__t=data.modelCode)?"":__t)+'" href="#">\n<i class="icon-arrow-right"></i>\n<span>'+(null==(__t=SIT.strings.contactdealer)?"":__t)+'</span>\n</a><a class="btn btn-circle tiny apply-for-financing" href="https://www.toyotafinancial.com/pub/w/#apply_for_credit/external?referrer=TYT" target="_blank">\n<i class="icon-arrow-right-tiny"></i>\n<span>'+(null==(__t=SIT.strings.applyforfinancing)?"":__t)+'</span>\n</a>\n</div><div class="car-column">\n<div id="threed-wrapper"></div>\n</div><div class="terior-column">\n<div class="nav-options-inverse">\n<h4>View</h4>\n<div class="nav-options" id="view-nav">\n<div class="indicator" style="top: 4px; left: 0px;"><img src="/apps/configurator/img/indicator-nav-options-inverse.png"></div>\n<ul id="teriorNav">\n<li class="is-on"><a href="#">'+(null==(__t=SIT.strings.exterior)?"":__t)+'</a></li>\n<li class=""><a href="#">'+(null==(__t=SIT.strings.interior)?"":__t)+'</a></li>\n</ul>\n</div>\n</div><div class="print-email-container">\n<a class="btn btn-gray large print-details" href="#">\n<i class="icon-print"></i>\n<span>'+(null==(__t=SIT.strings.printdetails)?"":__t)+'</span>\n</a>\n<br>\n<a href="#" class="btn btn-gray large email-details email tcom-exact-target">\n<i class="icon-email-circle"></i>\n<span>'+(null==(__t=SIT.strings.emaildetails)?"":__t)+'</span>\n</a>\n</div>\n<!-- <div class="tcom-exact-target" data-type="searchinventory" data-cta-title="Email Details" data-title="Email Details" data-callout="Send an email with my vehicle specifications" data-series-name="'+(null==(__t=data.seriesName)?"":__t)+'" data-trim="'+(null==(__t=data.trimName)?"":__t)+'" data-zip-code="'+(null==(__t=data.zipCode)?"":__t)+'" data-vin="'+(null==(__t=window.location.hash.replace("#!/details/",""))?"":__t)+'" data-offerType="" data-confirmation="An email with the details of this summary has been sent to:" data-error-details="Email services are down, please Print Offer or try again later." data-model-code="'+(null==(__t=data.seriesCode)?"":__t)+'" data-trim-id="'+(null==(__t=data.modelCode)?"":__t)+'" data-engine="'+(null==(__t=data.engine)?"":__t)+'" data-interior-color-name="'+(null==(__t=data.interiorcolor)?"":__t)+'" data-exterior-color-name="'+(null==(__t=data.exteriorcolor)?"":__t)+'" data-model-year="'+(null==(__t=data.year)?"":__t)+'" data-total-msrp="'+(null==(__t=data.msrp)?"":__t)+'" data-transmission="'+(null==(__t=data.transmission)?"":__t)+'" data-accessory-list="'+(null==(__t=data.accessoryList)?"":__t)+'" data-vehicle-image-url="'+(null==(__t=data.resultModel.jelly)?"":__t)+'" multivehicle-flag="false"></div> --></div>\n</div><div class="clearfix"></div><div id="summaryDetails">\n<table>\n<tbody>\n<tr class="odd-row"><td>'+(null==(__t=SIT.strings.modelyear)?"":__t)+"</td><td>"+(null==(__t=data.year)?"":__t)+"</td></tr>\n<tr><td>"+(null==(__t=SIT.strings.series)?"":__t)+"</td><td>"+(null==(__t=data.seriesName)?"":__t)+'</td></tr>\n<tr class="odd-row"><td>'+(null==(__t=SIT.strings.model)?"":__t)+"</td><td>"+(null==(__t=data.trimName)?"":__t)+"</td></tr>\n<tr><td>"+(null==(__t=SIT.strings.totalmsrp)?"":__t)+(null==(__t=SIT._.linkDisclaimer("[msrp_total]"))?"":__t)+"</td><td>"+(null==(__t=data.displayMsrp)?"":__t)+'</td></tr>\n<tr class="odd-row"><td>'+(null==(__t=SIT.strings.engine)?"":__t)+"</td><td>"+(null==(__t=SIT._.linkDisclaimer(data.engine))?"":__t)+"</td></tr>\n<tr><td>"+(null==(__t=SIT.strings.transmission)?"":__t)+"</td><td>"+(null==(__t=SIT._.linkDisclaimer(data.transmission))?"":__t)+'</td></tr>\n<tr class="odd-row"><td>'+(null==(__t=SIT.strings.color)?"":__t)+'</td><td>\n<div class="summary-color-print">\n<div class="print-color-name">Exterior: '+(null==(__t=data.exteriorcolor)?"":__t)+'</div>\n<div class="print-color-name">Interior: '+(null==(__t=data.interiorcolor)?"":__t)+'</div>\n</div><div id="summary-colors">\n<span>Exterior</span><span>Interior</span>\n<ul class="color-picker unstyled">\n<li>\n<a href="#" data-code="" data-msrp="" data-name="'+(null==(__t=data.exteriorcolor)?"":__t)+'" style="background-color:#'+(null==(__t=data.hex)?"":__t)+'"></a>\n<div data-tooltip="<strong>'+(null==(__t=data.exteriorcolor)?"":__t)+'</strong>" class="ext" data-original-title="'+(null==(__t=data.exteriorcolor)?"":__t)+'"></div>\n</li>\n<li>\n<a href="#" data-code="" data-msrp="" data-name="'+(null==(__t=data.interiorcolor)?"":__t)+'" style="background-image:url('+(null==(__t=data.swatch)?"":__t)+')"></a>\n<div data-tooltip="<strong>'+(null==(__t=data.interiorcolor)?"":__t)+'</strong>" class="ext" data-original-title="'+(null==(__t=data.interiorcolor)?"":__t)+'"></div>\n</li>\n</ul>\n</div>\n</td></tr>\n',_.each(data.packages,function(a,b){__p+=0===b?"\n<tr "+(null==(__t=b%2!==0?'class="odd-row"':"")?"":__t)+"><td>"+(null==(__t=SIT.strings.availableoptions)?"":__t)+"</td>\n":"\n<tr"+(null==(__t=b%2===0?'class="odd-row"':"")?"":__t)+"><td><!-- --></td>\n",__p+="\n<td><strong>"+(null==(__t=SIT._.linkDisclaimer(a.title))?"":__t),a.description&&(__p+=":"),__p+="</strong> "+(null==(__t=SIT._.linkDisclaimer(a.description))?"":__t)+"</td></tr>\n"}),__p+='</tbody>\n</table>\n</div><div id="descriptionDetails">\n',_.each(data.standardFeatures,function(a,b){var c=a[0].group,d=c.replace(/[^\w]/gi,"");__p+='<div class="accordion-group"><div class="accordion-heading chzn-container-single" data-title="'+(null==(__t=c)?"":__t)+'">\n<div class="accordian-header accordion-toggle chzn-single collapsed" data-toggle="collapse" data-target="#'+(null==(__t=d)?"":__t)+'" href="#'+(null==(__t=d)?"":__t)+'">\n<strong>'+(null==(__t=c)?"":__t)+'</strong>\n<div class="btn btn-circle smaller pull-right">\n<i class="icon-arrow-down"></i>\n<i class="icon-arrow-up"></i>\n</div>\n</div>\n</div><div id="'+(null==(__t=d)?"":__t)+'" class="accordion-body collapse">\n<div class="accordion-inner">\n<table>\n',_.each(a,function(a,b){__p+="\n<tr",b%2===0&&(__p+=' class="odd-row"'),__p+=">\n<td>"+(null==(__t=SIT._.linkDisclaimer(a.title))?"":__t)+"</td>\n</tr>\n"}),__p+="\n</table>\n</div>\n</div></div>"}),__p+='</div><div id="localSpecialsDetails">\n<h3>Local Offers</h3>\n<div class="local-specials" id="payments-local-specials">\n<section class="panel-container offers-main-section active-section">\n<div class="container">\n<div class="page-content">\n<div class="panel-set"></div>\n</div>\n</div>\n</section>\n</div>\n</div>';return __p}}),define("ritNavIndicator",["sit"],function(a){var b=a.$,c=a.Events,d=a.has,e=a.$body;b.fn.navIndicator=function(a,f){function g(g,h){function i(a){return u.call(l,b(a).index()),l}function j(){r.show(),setTimeout(function(){var a=m.find(".active").index();l.moveable&&-1!==a&&u(a)},300)}function k(a){if(l.moveable&&a.position()&&"number"==typeof a.position().left){var b=a.width()-42;r.stop().animate({left:a.position().left+"px"},200,function(){r.find("span").width(b+"px")})}}var l=this,m=b(l),n=m.find("li"),o=m.find("ul").parent(),p=o.parent().hasClass("nav-options-gray"),q=o.is(".items-12")||o.is(".items-11")||o.is(".items-10")||o.is(".items-9")||o.is(".items-8"),r=m.find(".indicator"),s=m.find("li.is-on").eq(0),t="click touchstart";l.moveable=!0,l.refreshIt=!0,l.halt=!1,c.on("HALT_NAV_INDICATOR",function(a){a.configurator?l.halt=!0:l.halt=!1}),s.length||(s=b(a));var u=function(a){var c=b("li",l).eq(a),d=c.position(),e=p?187:q?c.width():c.width()-42,f=c.height(),g={width:e+"px",height:f+"px"};c.siblings().removeClass("is-on"),l.moveable=!1,r.stop().css({top:d.top+"px",left:d.left+"px"}),setTimeout(function(){c.siblings().removeClass("is-on"),c.addClass("is-on"),l.moveable=!0,p?r.find("img").css(g):q?(r.find("span").css(g),r.css({width:c.width()-2+"px",height:f+25+"px"})):(r.find("span").width(e+"px"),r.find("span").height(f+"px"))},300)};if(f||0===f)return void u(f);s.length&&"none"!==m.parents(".panel").css("display")&&-1!==s.index()&&u(s.index()),1==n.length&&u(0);var v=m.hasClass("active-hover");return n.on(t,function(a,d){var f=b(this),g=f.index();v||a.preventDefault(),c.trigger("NAV_INDICATOR_CLICK",a),f.trigger("navIndicator:click",g),l.moveable=!1,f.attr("disabled")||f.hasClass("disabled")||(e.off("activate"),l.halt===!1&&-1!==g&&u(g))}),m.hasClass("active-hover")&&(l.moveable&&e.on("activate",j),d.touch||(m.on("mouseover","li",function(){var a=b(this);r.show(),l.moveable&&k(a)}),m.on("mouseout",function(){var a=m.find(".active");a.length?l.moveable&&k(a):(l.moveable&&k(m.find("li.is-on")),0===m.find("li.is-on").length&&r.hide())}))),s.length&&(s.find("a").addClass("current-tab"),r.show()),l.refreshIt&&b.fn.scrollspy&&(b('[data-spy="scroll"]').each(function(){b(this).scrollspy("refresh")}),l.refreshIt=!1),m.setItem=i,m}var h=[];return this.each(function(a,b){h.push(g.call(this,a,b))}),h[1]?h:h[0]?h[0]:this}}),define("app/jst/rit/email-your-toyota",[],function(){return function(obj){obj||(obj={});var __p="";with(_.escape,obj)__p+='<div class="email-your-toyota default">\n<button class="btn-close">X</button><div class="email-input-form">\n<h3>Email Summary</h3>\n<div class="sub-title">Send an email with this Summary</div><div class="input-container">\n<span class="input-label">Your Name</span>\n<input type="text" id="your-name" name="your-name" placeholder="Your Name" />\n</div><div class="input-container">\n<span class="input-label">Your Email</span>\n<input type="text" id="your-email" name="your-email" placeholder="Your Email" />\n</div><div class="input-container checkboxed">\n<label for="send-to-self">\n<input type="checkbox" id="send-to-self" name="send-to-self" />\n<span class="input-label">Sending to myself</span>\n</label>\n</div><div class="input-container">\n<span class="input-label">Recipient\'s Email</span>\n<input type="text" id="recip-email" name="recip-email" placeholder="Recipient\'s Email" />\n</div><div class="input-container">\n<span class="input-label">Comments <span class="optional">(Optional)</span></span>\n<textarea type="text" id="comments" name="comments" placeholder="Comments"></textarea>\n</div><div class="small-notice">\n<span>Toyota will not use your email for any other purposes or share it with third parties. To view our full privacy policy, <a href="http://www.toyota.com/support/privacy.html">click here</a>.</span>\n</div><button class="send-email" title="Send Message"><span class="text">Send Message</span></button>\n</div>\n<div class="email-success-form">\n<h4>Confirmation</h4>\n<p>An email with the details of this summary has been sent to: <span class="send-to-email"></span></p>\n</div>\n</div>';return __p}}),define("app/views/rit/details",["sit","app/views/threed/threed","ritBootstrapPopover","app/sit/local-specials","app/jst/rit/details","app/views/rit/raq","ritNavIndicator","app/jst/rit/email-your-toyota"],function(a,b,c,d,e,f,g,h){var i,j,k,l=a.$,m=a._,n=a.Backbone,o=a.Events,p="",q={trim_engine:p},r=!0,s=Modernizr.touch?{"click .back-to-inventory":"onBackToInventoryClick","click #highlightDetails .print-details":"onDetailPrintClick","click .accordion-heading":"onAccordionClick","touchstart .nav-options a":"onTeriorClick","click .nav-options a":"onTeriorClick","click .print-details":"onPrintClick","click .email-details":"onEmailClick","click .contact-dealer":"onContactADealerClick","click .apply-for-financing":"onApplyForFinancingClick","click .local-specials .left-arrow":"onArrowClick","click .local-specials .right-arrow":"onArrowClick","click .offer-details a":"onViewDetailsClick","click .requestQuote":"onRAQClick","click .buildYours":"onBYTClick","click .searchInventory":"onSITClick","click .offer-details-container a.print":"onLocalOfferPrintClick","click .offer-buttons .apr-print":"onLocalOfferPrintClick","click .offer-buttons .lease-print":"onLocalOfferPrintClick","click .offer-buttons .cashback-print":"onLocalOfferPrintClick","click .offer-buttons .newother-print":"onLocalOfferPrintClick"}:{"click .back-to-inventory":"onBackToInventoryClick","click #highlightDetails .print-details":"onDetailPrintClick","click .accordion-heading":"onAccordionClick","click .nav-options a":"onTeriorClick","click .print-details":"onPrintClick","click .email-details":"onEmailClick","click .contact-dealer":"onContactADealerClick","click .apply-for-financing":"onApplyForFinancingClick","click .local-specials .left-arrow":"onArrowClick","click .local-specials .right-arrow":"onArrowClick","click .offer-details a":"onViewDetailsClick","click .requestQuote":"onRAQClick","click .buildYours":"onBYTClick","click .searchInventory":"onSITClick","click .offer-details-container a.print":"onLocalOfferPrintClick","click .offer-buttons .apr-print":"onLocalOfferPrintClick","click .offer-buttons .lease-print":"onLocalOfferPrintClick","click .offer-buttons .cashback-print":"onLocalOfferPrintClick","click .offer-buttons .newother-print":"onLocalOfferPrintClick"},t=n.View.extend({events:s,initialize:function(){var a=this;k=a,a.appView=a.options.appView,a.inventory=a.model,i=a.$("#details-content"),j=a.$(".car-column"),a.$email=l(".email-your-toyota"),a.$recip=l("#recip-email"),o.on("SIT:details:success",l.proxy(a.render,a)),o.on("SIT:details:fail",l.proxy(a.onApiError,a))},onApiError:function(){o.trigger("SIT:service:error")},onClick:function(a){},onBackToInventoryClick:function(a){console.log("onBackToInventoryClick:",a),this.appView.fireIS("117.22",{trim_engine:this.options.model.details.get("details").modelName}),r=!0},onDetailPrintClick:function(a){return a.preventDefault(),l("#inventoryHeader, #highlightDetails, #summaryDetails, #totalMSRPDisclaimer, #descriptionDetails").removeClass("not-printable").addClass("printable"),l(".offer-details-container").removeClass("printable").addClass("not-printable"),window.print(),!1},onLocalOfferPrintClick:function(a){a.preventDefault();var b=this,c=l(a.currentTarget),d={offer_description:c.data("incentiveId"),offer_type:c.data("type"),trim_engine:b.options.model.details.get("details").modelName.trim()};l("#inventoryHeader, #highlightDetails, #summaryDetails, #totalMSRPDisclaimer, #descriptionDetails").removeClass("printable").addClass("not-printable"),l(".offer-details-container").removeClass("not-printable").addClass("printable"),l("body").removeClass("local-specials-print-override"),this.appView.fireIS("117.41",d)},onArrowClick:function(a){this.appView.fireIS("117."+(l(a.target).hasClass("next")?34:35),{trim_engine:this.options.model.details.get("details").modelName.trim()})},onRAQClick:function(a){var b=this,c=l(a.currentTarget),d={offer_description:c.data("incentiveId"),offer_type:c.data("type"),trim_engine:b.options.model.details.get("details").modelName.trim()};b.appView.fireIS("117.38",d)},onBYTClick:function(a){var b=this,c=l(a.currentTarget),d={offer_description:c.data("incentiveId"),offer_type:c.data("type"),trim_engine:b.options.model.details.get("details").modelName.trim()};b.appView.fireIS("117.39",d)},onSITClick:function(a){var b=this,c=l(a.currentTarget),d={offer_description:c.data("incentiveId"),offer_type:c.data("type"),trim_engine:b.options.model.details.get("details").modelName.trim()
};this.appView.fireIS("117.40",d)},onViewDetailsClick:function(a){var b=this,c=l(a.target).parents(".offer"),d={offer_description:c.find(".offer-header").text().replace(/  +?/g,"").trim().replace(/(\r\n|\n|\r)/gm,"_").replace(/_+/g," "),offer_type:c.data("type"),trim_engine:b.options.model.details.get("details").modelName.trim()};b.appView.fireIS("117.37",d)},onAccordionClick:function(a){var b=this,c=l(a.currentTarget),d=q;d.trim_engine=d.trim_engine.trim(),d.label_title=l(c,"strong").text().trim(),d.Label_Title=d.label_title,b.appView.fireIS("117.33",d)},onApplyForFinancingClick:function(a){this.appView.fireIS("117.27",q)},onContactADealerClick:function(b){var c=this,d=c.inventory.details.attributes.details.resultModel;m.each(d.packages,function(a){a.title.length>0&&(a.title=" "+a.title.replace(/\[.*?\]/g,"").replace(/[ \t]+$/,""))}),m.each(d.accessoriesList,function(a){a.description.length>0&&(a.description=" "+a.description.replace(/\[.*?\]/g,"").replace(/[ \t]+$/,""))}),d=m.cloneDeep(session.apiWrapper.getDataForContactDealer(d),d),f.setConfigCookie(d),a.Events.once("modal:close",function(){m.defer(function(){o.trigger("inventory:loaded","details")})}),c.appView.fireIS("117.25",q),b.preventDefault()},onPrintClick:function(a){this.appView.fireIS("117.31",q)},onEmailClick:function(b){var c=this,d=a.API.getCurrentModelObj().attributes.description.value;c.appView.fireIS("117.32",q),console.log("details:onEmailClick",b),l(".email-input-form").css({display:"block"}),l(".email-success-form").css({display:"none"}),b.preventDefault(),c.$email.remove(),console.log("summary:onEmailClick",b),d=a.API.getCurrentYear().title+" "+d+" Configuration",d=d.replace(/(<([^>]+)>)/gi,"");var e=h({title:d});l("body").append(e),c.setEmailPosition(),l(window).on("resizing:complete.summary",c.setEmailPosition),l(".send-email",".email-your-toyota").click(c.onEmailSendClick),l(".btn-close",".email-your-toyota").click(c.onEmailCloseClick),l("#send-to-self").click(function(){l("#send-to-self").is(":checked")&&l("#recip-email").val(l("#your-email").val())}),setTimeout(function(){l(".summary-content").one("click",function(){console.log("summary: closing email-your-toyota"),l(".email-your-toyota").remove()})},500)},onEmailSendClick:function(){var b,c=this,d=a.API.getCurrentModelObj(),e=d.attributes.description.value,f=l("<span />",{html:e}).text(),g=a.API.getCurrentYear().title,h=l("<span />",{html:a.API.getCurrentSeries().title}).text(),i=TCOM.cookie("zipcode"),j=l("#your-email").val(),k=l("#recip-email").val(),m=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,n=!1;if(m.test(j)||(l("#your-email").addClass("invalid"),n=!0),m.test(k)||(l("#recip-email").addClass("invalid"),n=!0),!n){b=d.grade[0].images.images.url,console.groupEnd();var o={zipCode:i,senderName:l("#your-name").val(),senderEmail:j,recipientEmail:k,toMyself:l("#send-to-self").is(":checked")?1:0,senderComments:l("#comments").val(),model:h,trim:" "+d.grade[0].code,description:f,year:g,vehicleImageUrl:b,packageName:d.packages[0].title,exteriorColorName:session.getTrueFeaturesByType("exteriorcolor")[0].title,interiorColorName:session.getTrueFeaturesByType("interiorcolor")[0].title,engine:d.engine.title,disclaimerDetails:"\n			Manufacturer's Suggested Retail Price, excludes the Delivery, Processing and Handling Fee of $825 for Cars, $885 for Small/Light Trucks (Sienna, RAV4, Highlander Gas, Highlander HV, 4Runner, Tacoma and Venza), $1100 for Large Trucks (Tundra), and $925 for Large SUVs (Sequoia and Land Cruiser). (Historically, vehicle manufacturers and distributors have charged a separate fee for processing, handling and delivering vehicles to dealerships. Toyota's charge for these services is called the \"Delivery, Processing and Handling Fee\" and is based on the value of the processing, handling and delivery services Toyota provides as well as Toyota's overall pricing structure. Toyota may make a profit on the Delivery, Processing and Handling Fee.) Excludes taxes, license, title and available or regionally required equipment. The Delivery, Processing and Handling Fee in AL, AR, FL, GA, LA, MS, NC, OK, SC and TX will be higher. Actual dealer price will vary.\n		"};l.ajax({type:"POST",url:"/ToyotaSite/rest/sendConfigEmail",data:JSON.stringify(o),dataType:"json",success:c.onEmailSuccess,error:c.onEmailFailure,contentType:"application/json;charset=UTF-8"})}},onEmailSuccess:function(){l(".email-input-form").css({display:"none"}),l(".email-success-form").css({display:"block"}),l(".send-to-email").text(l("#recip-email").val())},onEmailFailure:function(){l(".email-input-form").css({display:"none"}),l(".email-success-form").css({display:"block"}),l(".send-to-email").text(l("#recip-email").val())},onEmailCloseClick:function(a){a.preventDefault(),l(".email-your-toyota").remove()},setEmailPosition:function(){console.log("summary:setEmailPosition");var a=k,b=l(".email-details").offset(),c=25,d=l(window).width(),e=a.$email.width(),f=b.left-.5*e-c,g=b.top+c,h=d-e-c;f=c>f?c:f,f=f>h?h:f,console.log("left"+f+", top"+g),l(".email-your-toyota").css({left:f+"px",top:g+"px"})},onTeriorClick:function(a){var b=this;a.preventDefault();var c=l(a.currentTarget).text().toLowerCase().replace(/^\s+|\s+$/i,"");return b.appView.fireIS("117."+("interior"===c?"29":"30"),q),b.threed.changeView(c),!1},applyColorChipToolTip:function(a){var b=this;m.each(b.$(".color-picker div"),function(a){l(a).popover({trigger:"hover",placement:"bottom",content:l(a).attr("data-tooltip")})})},updateDisclaimers:function(b){var c=a.$disclaimers,d=m.template("<li><%= disclaimer %></li>"),e=m.map(c.find("li").splice(0,6),function(a){return l(a).text()}),f=m.union(e,m.map(b,function(a){return a.description})),g=m.map(f,function(a){return d({disclaimer:a})}).join("");c.html(g)},show:function(){var a=this;a.$el.addClass("is-on")},hide:function(){var a=this;a.$el.removeClass("is-on"),i.find("#highlightDetails, #summaryDetails, #descriptionDetails, #localSpecialsDetails .panel-set").empty()},updateBackToInventoryHref:function(b){var c=this,b="#!/results/"+a.API.getCurrentQueryParams();c.$(".back-to-inventory").attr("href",b)},render:function(){var b=this,c=b.model.details.get("details"),f=[];c.resultModel.accessoriesList.length&&(m.each(c.resultModel.accessoriesList,function(a){a.description&&f.push(a.description)}),c.accessoryList=f.join(", ")),p=c.modelName,q={trim_engine:p},b.updateBackToInventoryHref(c.resultsUrl),i.html(e({data:c,SIT:a})),l("#view-nav").navIndicator(),b.applyColorChipToolTip(),i.show(),l.when(b.inventory.sessionReady).then(function(){a.API.initializeThreedSession()}),l.when(a.API.getThreedDeferred()).then(function(){a.API.setDetailPicks(b.inventory.details.get("picks")),b.initThreed(),b.detailsLocalSpecials=new d({inventory:b.inventory,$el:l("#localSpecialsDetails")})}),o.trigger("inventory:loaded","details"),r&&(b.appView.fireIS("117.4",{model_name:c.seriesName,model_trim:c.trimName}),r=!1),window.tconnect&&window.tconnect.rescan(function(){console.log("plugins ready")})},initThreed:function(){var a=this;return"rav4ev"===a.inventory.picks.get("series")?(j.html(l("<div />").css({height:"100%",width:"100%","background-position":"-165px 0","background-repeat":"no-repeat","background-image":"url(/content/gallery/360/"+data.modelYear+"/rav4ev/rav4_ev/"+data.exteriorKey+"/34.jpg)"})),void l(".nav-options-inverse").addClass("disabled")):(a.threed&&(a.threed.destroy(),a.threed=null),a.threed=new b(window.threedsession,a.options),void(debuggerOn&&console.log("self.threed: ",a.threed)))}});return t}),define("app/jst/rit/error-states/zip",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<div id="error-zip" class="error-state"><div class="title">\n<div class="btn btn-circle red"><i class="icon-bang"></i></div><h2>'+(null==(__t=SIT.strings.errors.oneMore)?"":__t)+'</h2>\n</div><div class="body">\n<div class="description">\n<span>\n'+(null==(__t=SIT.strings.errors.allWeNeed)?"":__t)+"<br>\n"+(null==(__t=SIT.strings.errors.itWillHelp)?"":__t)+"<br />\n"+(null==(__t=SIT.strings.errors.itWillHelpBr)?"":__t)+'\n</span>\n</div>\n<div class="zip-code-changer"></div>\n</div></div>';return __p}}),define("app/jst/rit/error-states/fail",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<div id="error-fail" class="error-state">\n<div class="title">\n<div class="btn btn-circle red"><i class="icon-bang"></i></div><h2>'+(null==(__t=SIT.strings.errors.apologies)?"":__t)+'</h2>\n</div>\n<div class="body">\n<div class="description">\n'+(null==(__t=SIT.strings.errors.technicalDifficulties)?"":__t)+"<br />\n"+(null==(__t=SIT.strings.errors.meantime)?"":__t)+'\n</div>\n<div id="options-row">\n<div class="option">\n<h3>'+(null==(__t=SIT.strings.errors.findDealer)?"":__t)+'</h3>\n<a class="btn btn-pill" href="/dealers/"><i class="icon-arrow-right"></i><span>'+(null==(__t=SIT.strings.errors.dealerLocator)?"":__t)+'</span></a>\n</div>\n<img class="stretched-options-divider" src="/common/img/indicators/options-divider-stretched.png" /><div class="option">\n<h3>'+(null==(__t=SIT.strings.errors.findDeals)?"":__t)+'</h3>\n<a class="btn btn-pill" href="/local-specials/"><i class="icon-arrow-right"></i><span>'+(null==(__t=SIT.strings.errors.localSpecials)?"":__t)+'</span></a>\n</div>\n<img class="stretched-options-divider" src="/common/img/indicators/options-divider-stretched.png" /><div class="option">\n<h3>'+(null==(__t=SIT.strings.errors.returnToHome)?"":__t)+'</h3>\n<a class="btn btn-pill" href="/"><i class="icon-arrow-right"></i><span>'+(null==(__t=SIT.strings.errors.home)?"":__t)+"</span></a>\n</div>\n</div>\n</div>\n</div>";return __p}}),define("app/jst/rit/error-states/oos",[],function(){return function(obj){obj||(obj={});var __p="";with(_.escape,obj)__p+='<div id="error-OOS" class="error-state"><div class="title">\n<div class="btn btn-circle red"><i class="icon-bang"></i></div><h2>Vehicle Out of Stock</h2>\n</div>\n<div class="body">\n<div class="description">\n<span>\nWe could not find this vehicle in our inventory.<br />\nIt was either sold or leased to another happy<br />\nToyota Customer.\n</span></div><a class="btn btn-pill back-to-inventory" href="#!/landing"><i class="icon-arrow-right"></i><span>Back to Inventory</span></a></div>\n</div>';return __p}}),define("app/jst/rit/rit-errors/errorsEnglish",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj){if("dealers:interstitial"===type&&(__p+='<div class="error-state error-zipcode error-dealers-interstitial"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="interstitial-open-search-box row"></div><a class="btn btn-pill continue" href="#"><i class="icon-arrow-right"></i><span>Show Dealers</span></a></span></a></div></div></div>'),"zipcode"===type){__p+='<div class="error-state error-zipcode"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="zip-code-changer row"></div><a class="btn btn-pill continue" href="#"><i class="icon-arrow-right"></i><span>';try{__p+=null==(__t=buttonCaption)?"":__t}catch(error){__p+="Continue"}__p+="</span></a></span></a></div></div></div>"}if("region"===type){__p+='<div class="error-state error-region"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="zip-code-changer row"></div>';try{__p+='<a target="_new" class="btn btn-pill" href="'+(null==(__t=redirect_url)?"":__t)+'"><i class="icon-arrow-right"></i><span>';try{__p+=null==(__t=redirect_caption)?"":__t}catch(error){__p+="Continue"}__p+="</span></a>"}catch(error){}__p+="</div></div></div>"}if("general"===type){__p+='<div class="error-state error-general">';try{__p+='<div class="title"><div class="btn btn-circle red"><i class="icon-bang"></i></div><h2>'+(null==(__t=title)?"":__t)+"</h2></div>"}catch(error){}__p+='<div class="body"><div class="description">';try{__p+='<span class="row row1">'+(null==(__t=message)?"":__t)+"</span>"}catch(error){}__p+="</div></div></div>"}}return __p}}),define("app/jst/rit/rit-errors/errorsEspanol",[],function(){return function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj){if("dealers:interstitial"===type&&(__p+='<div class="error-state error-zipcode error-dealers-interstitial"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="interstitial-open-search-box row"></div><a class="btn btn-pill continue" href="#"><i class="icon-arrow-right"></i><span>Mostrar Dealers</span></a></span></a></div></div></div>'),"zipcode"===type){__p+='<div class="error-state error-zipcode"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="zip-code-changer row"></div><a class="btn btn-pill continue" href="#"><i class="icon-arrow-right"></i><span>';try{__p+=null==(__t=buttonCaption)?"":__t}catch(error){__p+="Continuar"}__p+="</span></a></span></a></div></div></div>"}if("region"===type){__p+='<div class="error-state error-region"><div class="body"><div class="icon"></div><div class="description"><span class="row row1">'+(null==(__t=message)?"":__t)+'</span><div class="zip-code-changer row"></div>';try{__p+='<a target="_new" class="btn btn-pill" href="'+(null==(__t=redirect_url)?"":__t)+'"><i class="icon-arrow-right"></i><span>';try{__p+=null==(__t=redirect_caption)?"":__t}catch(error){__p+="Continuar"}__p+="</span></a>"}catch(error){}__p+="</div></div></div>"}if("general"===type){__p+='<div class="error-state error-general">';try{__p+='<div class="title"><div class="btn btn-circle red"><i class="icon-bang"></i></div><h2>'+(null==(__t=title)?"":__t)+"</h2></div>"}catch(error){}__p+='<div class="body"><div class="description">';try{__p+='<span class="row row1">'+(null==(__t=message)?"":__t)+"</span>"}catch(error){}__p+="</div></div></div>"}}return __p}}),define("ritErrorView",["sit","ritZipcodeChanger","app/jst/rit/rit-errors/errorsEnglish","app/jst/rit/rit-errors/errorsEspanol","ritLoading"],function(a,b,c,d,e){var f=(a.$,a._,a.Events),g=a.Util,h=a.Backbone,i=g.i18n,j=h.View.extend({events:{"click .error-zipcode .btn":"onZipcodeContinueClick","click .error-state .btn, .error-region .btn":"captureContinueClick"},initialize:function(){console.log("Error:initialize");var a=this;a.hookLoad(),a.render()},hookLoad:function(){var a=this;a.unhookLoad(),f.on("region:loading",a.onRegionLoading,a),f.on("region:loaded",a.onRegionLoaded,a)},unhookLoad:function(){var a=this;f.off("region:loading",a.onRegionLoading,a),f.off("region:loaded",a.onRegionLoaded,a)},onRegionLoading:function(){console.log("error:onRegionLoading");var a=this;a.$(".error-state").mask()},onRegionLoaded:function(){console.log("error:onRegionLoaded");var a=this;a.unhookLoad(),a.$(".error-state").unmask()},onZipcodeContinueClick:function(a){var b=this;a.preventDefault(),f.trigger("error:zipcode:continue:click"),b.zipcodeChanger.calculate(!0)},captureContinueClick:function(a){this.zipcodeChanger.locked!==!1&&a.preventDefault()},render:function(){var a=this,e=a.options;a.zipcodeChanger=new b({noBlur:e.noBlur,intercept:"zipcode"===e.type,triggerDealerSearch:e.triggerDealerSearch}),"en"===i.lang?a.$el.html(c(e)):a.$el.html(d(e)),"dealers:interstitial"===e.type||a.$(".zip-code-changer").html(a.zipcodeChanger.el)}});return j}),define("app/views/rit/errors",["sit","ritZipcodeChanger","app/jst/rit/error-states/zip","app/jst/rit/error-states/fail","app/jst/rit/error-states/oos","ritErrorView"],function(a,b,c,d,e,f){var g,h=(a.RIT,a.$),i=a._,j=a.Backbone,k=a.Events,l=(a.Config,a.Analytics),m=null,n={SET:-1!==i.indexOf(window.location.toString().split("/"),"espanol")?"http://www.comprauntoyota.com/":"http://southeast.buyatoyota.com/",SETBuild:"www.toyota.com"===window.location.hostname||"origin.www.toyota.com"===window.location.hostname?"http://southeast.buyatoyota.com/":"http://uat.setbuyatoyota.com/",PR:"http://www.toyotapr.com/",HI:"http://www.toyotahawaii.com/"},o=j.View.extend({events:{"tap .error-state .description a.btn":"onGstContinueBtnClicked","click .back-to-inventory":"onBackToInventoryClick"},initialize:function(){var b=this;m=b,b.appView=b.options.appView,b.router=b.options.router,k.on("zipcode:edit",b.onZipEdit,b),k.on("SIT:api:fail",function(){debuggerOn&&console.error("api:fail"),b.showServiceError()}),k.on("SIT:zipcode:fail",function(a){debuggerOn&&console.error("zipcode:fail"),b.showZipCodeError(a)}),k.on("SIT:region:fail",function(a){debuggerOn&&console.error("region:fail"),b.showRegionError(a)}),k.on("SIT:service:fail",function(a){debuggerOn&&console.error("service:fail"),b.showServiceError()}),k.on("SIT:error:oos",function(a){debuggerOn&&console.error("error:oos"),b.showOOSError()}),a.$window.on("SIT:api:fail",h.proxy(b.showServiceError,b)),k.on("SERVICE_ERROR",function(){debuggerOn&&console.error("service:error"),b.showServiceError()}),k.on("ZIPCODE_ERROR",function(){debuggerOn&&console.error("zipcode:error"),b.showZipCodeError()}),k.on("REGION_ERROR",function(a){debuggerOn&&console.error("region:error"),b.showRegionError(a)}),k.on("REGION_SUCCESS",function(){})},onBackToInventoryClick:function(b){console.log("onBackToInventoryClick:",b),this.appView.fireIS("117.131",{cta_name:"Back_To_Inventory",model_name:a.API.getCurrentSeries().title}),firstLoad=!0},onZipEdit:i.debounce(function(b){var c=this,d=c.model.get("currentView");switch(d){case"landing":c.appView.fireIS("117.8");break;case"results":c.appView.fireIS("OOS"===g?"117.132":"117.106",{model_name:a.API.getCurrentSeries().title});break;case"details":c.appView.fireIS("117.23")}},500,!0),onZipBlur:function(b){var c=m,d=c.model.get("currentView");switch(d){case"results":c.appView.fireIS("OOS"===g?"117.133":"117.107",{model_name:a.API.getCurrentSeries().title})}},onZipChange:function(){var b=m,c=b.model.get("currentView");switch(c){case"landing":l.setPageName(b.isVisible()?"T:Inventory:Error":"T:Inventory:Landing"),b.appView.fireIS("117."+(b.isVisible()?"52":"9"));break;case"results":b.appView.fireIS("OOS"===g?"117.133":"117.107",{model_name:a.API.getCurrentSeries().title});break;case"details":b.appView.fireIS("117.24")}window.location.reload(),b.hide()},showErrorMessage:function(a){var b=this;new f({el:b.$el,type:a.type,message:a.message,redirect_url:a.redirect_url}),b.show(),k.trigger("inventory:loaded","error")},showOOSError:function(b){g="OOS";var c=this;c.render(e()),c.show(),k.trigger("inventory:loaded","error"),c.appView.fireIS("117.130",{model_name:a.API.getCurrentSeries().title})},showServiceError:function(a){var b=this;b.render(d()),b.show(),k.trigger("inventory:loaded","error")},showZipCodeError:i.debounce(function(a){console.debug("showZipCodeError:",a);var d=this;d.render(c()),d.$el.find(".zip-code-changer").html((new b).el),d.show(),k.trigger("inventory:loaded","error")},500,!0),showRegionError:function(a){debuggerOn&&console.log("Landing:showRegionError:",a);var b=this,c="",d=b.model.get("currentView");if(a&&a.redirectUrl&&(a.redirect_url=a.redirectUrl),a&&a.redirectURL&&(a.redirect_url=a.redirectURL),50===a.regionCode?c=n.SET+b.getSetUrl():a&&a.redirect_url?(c+=a.redirect_url,c+=60===a.region_code?"Advanced/Pages/View/":"",c+="?zip="+h.cookie("zipcode")+"&siteid=Tcom_Search_Inventory:BAT_Home"):c+="?",new f({el:b.$el,type:"region",message:"View local inventory for",redirect_url:c}),b.show(),"results"===d){var e=h.cookie("zipcode");b.appView.analytics.setPageName("T:Inventory:TDA_Redirect"),b.appView.fireIS("117.110",{device_type:b.appView.analytics.deviceType,tda_code:e,zip_code:e})}k.trigger("inventory:loaded","error")},getSetUrl:function(){var a={avalonhybrid:"avalon-hybrid",camryhybrid:"camry-hybrid",highlanderhybrid:"highlander-hybrid",priusc:"prius-c",priusv:"prius-v",fjcruiser:"fj-cruiser",landcruiser:"land-cruiser","prius-plug-in":"prius"},b=window.location.toString().split("#!"),c=b[1]||"",d=c.split("/"),e=d[3]&&d[3].toLowerCase()||"",f=a[e]||e;return f+"?originating_zip_code="+h.cookie("zipcode")},getGstUrl:function(){var a,b={"4runner":"Crossovers|4Runner",avalon:"Cars|Avalon",camry:"Cars|Camry",corolla:"Cars|Corolla",fjcruiser:"Crossovers|FJ Cruiser",highlander:"Crossovers|Highlander",landcruiser:"Crossovers|Land Cruiser",matrix:"Cars|Matrix",prius:"Hybrids-EVs|Prius",rav4:"Crossovers|RAV4",sequoia:"Crossovers|Sequoia",sienna:"Cars|Sienna",tacoma:"Trucks|Tacoma",tundra:"Trucks|Tundra",yaris:"Cars|Yaris",venza:"Crossovers|Venza",priusc:"Hybrids-EVs|Prius c",priusv:"Hybrids-EVs|Prius v",camryhybrid:"Hybrids-EVs|Camry Hybrid",avalonhybrid:"Hybrids-EVs|Avalon Hybrid",highlanderhybrid:"Hybrids-EVs|Highlander Hybrid","prius-plug-in":"Prius-Plug-in|Prius Plug-in",rav4ev:"RAV4-EV|RAV4 EV"},c=window.location.toString(),d=c.split("/")[i.indexOf(c.split("/"),"results")+2],e="Advanced/Pages/",f=b[d]&&b[d].split("|")[1];return f?(a=encodeURIComponent(b[d].split("|")[1]),e+=/prius-plug-in|rav4ev/.test(d)?"VehicleLandingPage.aspx?style=Hybrids-EVs&model=3rd_Gen_Prius&":"View/Model/"+a+"/Records/20/SortBy/0/?",e+="zip="+h.cookie("zipcode")):void 0},onGstContinueBtnClicked:function(){var a=this;a.appView.analytics.setPageName("T:Inventory:TDA_Redirect"),a.appView.fireIS("117.112",{device_type:a.appView.analytics.deviceType,tda_code:h.cookie("zipcode"),zip_code:h.cookie("zipcode")})},isVisible:function(){return this.$el.hasClass("is-on")},show:function(){var a=this;a.appView.landing.hide(),a.appView.results.hide(),a.appView.details.hide(),a.$el.addClass("is-on"),k.trigger("inventory:loaded","error"),k.on("zipcode:changed",a.onZipChange,a),k.on("zipcode:blur",a.onZipBlur,a)},hide:function(){var a=this;a.$el.removeClass("is-on"),k.off("zipcode:changed",a.onZipChange,a),k.off("zipcode:blur",a.onZipBlur,a)},render:function(a){var b=this;b.$el.html(a)}});return o}),define("sitAppView",["sit","ritZipcodeChanger","app/views/rit/landing","app/views/rit/results","app/views/rit/details","app/views/rit/errors","ritLoading"],function(a,b,c,d,e,f,g){var h=a.$,i=a._,j=a.Backbone,k=a.Events,l=a.$document,m=a.$body,n=m.children(".load-layer"),o=a.Analytics,p=j.View.extend({debugging:{timeToInteract:timetoInteract},initialize:function(a){var g=this;window.TCOM.getGlobal(),k.on("inventory:loading",g.onInventoryLoading,g),k.on("inventory:loaded",g.onInventoryLoaded,g),g.inventory=a.inventory,g.inventory.on("change:currentView",h.proxy(g.switchPage,g)),g.inventory.on("change:disclaimers",h.proxy(g.updateDisclaimers,g)),g.inventory.on("change:zipcode",function(){i.delay(g.updateRegionDisclaimer,800)}),g.analytics=o,g.analytics.getTags("inventorysearch"),h("#header-zip-code").html((new b).el),g.initializeDisclaimers(),g.landing=new c({el:h("#landing"),appView:g,router:a.router}),g.results=new d({el:h("#results"),model:a.inventory,appView:g,router:a.router}),g.details=new e({el:h("#details"),model:a.inventory,appView:g,router:a.router}),g.errors=new f({el:h("#sit-errors"),model:a.inventory,appView:g,router:a.router}),g.hookAppErrorTags()},onInventoryLoading:function(){n.show().mask(),m.removeClass("load-relative").addClass("modal-open")},onInventoryLoaded:function(){var a=this;if(i.defer(function(){n.hide().unmask(),m.removeClass("modal-open")}),debuggerOn&&!i.isEmpty(a.debugging)){var b=(new Date).valueOf();i.each(a.debugging,function(a,c){console.timeEnd(c),h("#debuggerBox").append("<p>"+c+": "+(b-a)+"ms</p>")}),a.debugging={}}},hookAppErrorTags:function(){var a=this;k.on("SIT:service:fail",function(){a.fireIS("117.6",{inventory_error_type:"SERVICE_ERROR"})}),k.on("SIT:zipcode:fail",function(){a.fireIS("117.6",{inventory_error_type:"ZIPCODE_ERROR"})})},fireIS:function(){var b=this,c=arguments[0]||"117.X",d=arguments[1]||{},e=b.analytics,f=(b.inventory.filters,h.cookie("zipcode"));d=i.extend({current_pagename:e.currentPageName(),tda_code:a.tdaCode,device_type:e.deviceType,zip_code:f},d),e.fire("inventorysearch",c,d)},switchPage:function(a){var b=this;h("#sit-errors #error-zip").is(":visible")===!1?(b.errors.hide(),b.landing.hide(),b.results.hide(),b.details.hide(),k.trigger("inventory:loading"),b[b.inventory.get("currentView")].show(),l.scrollTop(0),"landing"===b.inventory.get("currentView")&&n.hide()):k.trigger("inventory:loaded","error")},updateHeader:function(a){var b=h(".page-header.header");a.title&&b.find("h1").text(a.title),a.subTitle&&b.find(".page-header-sub").text(a.subTitle)},initializeDisclaimers:function(){var b=this;a.$disclaimers.find("li").addClass("default"),require(["organisms/disclaimers/js/disclaimers"],function(a){b.disclaimers=new a({el:"#tcom-disclaimers"})})},resetDisclaimers:function(){a.$disclaimers.find("li").not(".default").remove(),a.appDisclaimers={}},updateDisclaimers:function(){var b=this,c=b.inventory.get("disclaimers"),d=a.$disclaimers.find("li:lt(8)").length,e="";b.resetDisclaimers(),i.each(c,function(b,c){var f=b.code?b.code.toLowerCase():"*",g=b.attributes.description.value,h=c+d+1;g=g.replace(/(\w)\s*®/gi,"$1<sup>®</sup>"),a.appDisclaimers[f]=h,a.API.isGST()&&"msrp"===f&&(g=a.strings[a.i18n.lang].gstMSRP),e+='<li class="tcom-disclaimers-item" data-code="'+f+'">'+h+". "+g+"</li>"}),a.$disclaimers.append(e),b.updateRegionDisclaimer()},updateRegionDisclaimer:function(){var b=a.$disclaimers.find("li:eq(0)");a.API.isGST()?b.text(a.strings.gstMSRP):b.text(a.strings.nationalMSRP)}});return p}),define("app/models/picks",["sit"],function(a){var b=(a.RIT,a._),c=a.$,d=(a.Config,a.Backbone),e=a.Events,f="grade",g={year:"",series:"",grade:"",model:"",bed:"",cab:"",engine:"",drive:"",transmission:"",exteriorcolor:[],interiorcolor:[],accessory:[],priceMin:-1,priceMax:-1,featurePicks:[],colorPicks:[],routerPicks:{}},h=d.Model.extend({validPicks:["model","bed","cab","engine","drive","transmission","exteriorcolor","interiorcolor","accessory"],defaults:b.clone(g),initialize:function(a){var d=this;d.inventory=a.inventory,b.bindAll(d,"setPick"),d.on("change:series",c.proxy(d.updateGradeType,d))},setPick:function(c){var d=this,g=a.API.getFeatureByCodePrefix(c);return g?g.type===f?(d.resetPicks(),a.API.getGradeByCode(g.code),"grade-subgrade"===f?(d.set(f,g.code),e.trigger("SIT:change:grade"),!0):"grade-subgrade"!==f?(d.set(f,g.code),e.trigger("SIT:change:grade"),!0):!1):b.contains(["model","exteriorcolor","interiorcolor","accessory"],g.type)?(d.set(g.type,d.get(g.type)?d.get(g.type).concat([g.code]):[g.code]),!0):(d.set(g.type,g.code),!0):void 0},removePick:function(c){var d=this,f=a.API.getFeatureByCodePrefix(c),g=d.get("featurePicks"),h=d.get("colorPicks"),i=[];return"exteriorcolor"===f.type||"interiorcolor"===f.type?(g.length&&(i=i.filter("."+g.join(",."))),h=b.without(h,c),i=h.length?i.filter("."+h.join(",.")):i,i=d.filterResultsByMsrp(i),i.length>0?(d.set("colorPicks",h),d.set(f.type,b.without(d.get(f.type),f.code)),e.trigger("SIT:change:picks"),!0):!1):(g=b.without(g,c),i=g.length?i.filter("."+g.join(",.")):i,h.length&&(i=i.filter("."+h.join(",."))),i=d.filterResultsByMsrp(i),i.length>0?(d.set("featurePicks",g),d.set(f.type,"accessory"===f.type?b.without(d.get("accessory"),f.code):""),e.trigger("SIT:change:picks"),!0):!1)},parsePicks:function(d){var g=this;return d?g.set("routerPicks",d):d=g.get("routerPicks"),b.isObject(d)&&d.year&&d.series?((g.get("series")!==d.series||g.get("year")!==d.year)&&(g.resetPicks(),g.set("year",d.year),g.set("series",d.series),g.unset("grade"),g.unset("grade-subgrade"),e.trigger("SIT:change:series")),void c.when(g.inventory.sessionReady).then(function(){g.updateGradeType();var h=!1;if(d.grade&&"undefined"!==d.grade&&g.get(f)!==d.grade){g.resetPicks();var i=a.API.getGradeByCode(d.grade);"grade-subgrade"===f?(i&&a.API.setPick(i.id,null,!0),g.set(f,d.grade),h=!0):"grade-subgrade"!==f&&(a.API.setPick(d.grade,f,!0),g.set(f,d.grade),h=!0)}if(!g.get(f)){g.resetPicks();var j=a.API.getDefaultGrade();if(!j||!j.code)return void e.trigger("SIT:error:oos");if("grade-subgrade"===f)j&&a.API.setPick(j.id,null,!0),g.set(f,j.code),h=!0;else{if("grade-subgrade"===f)return;a.API.setPick(j.code,f,!0),g.set(f,j.code),h=!0}}var k=g.allPicks(),l=[];b.each(g.validPicks,function(c){var e=d[c];b.isArray(e)?b.each(e,function(b){b&&(a.API.setPick(b,c,!0),l.push(a.API.getCodePrefix(b,c)))}):e&&(a.API.setPick(e,c,!0),l.push(a.API.getCodePrefix(e,c)))});var m=b.filter(k,function(a){return b.indexOf(l,a)});m.length&&b.each(m,function(a){g.removePick(a)});var n=b.filter(l,function(a){return b.indexOf(k,a)});if(n.length&&b.each(n,function(a){g.setPick(a)}),e.trigger("SIT:change:picks"),d.sort&&a.API.setSortOrder(d.sort),d.page&&a.API.setPageNumber(d.page),d.msrp){var o=d.msrp.split("-");a.API.setRangeConstraint(o[0],o[1],!0)}d.msrp?c.when(a.API.getFiltersDeferred(),a.API.getSetRangeDeferred()).then(function(b,c){a.API.triggerResults(!0)}):c.when(a.API.getFiltersDeferred()).then(function(b){a.API.triggerResults(!0)})})):(e.trigger("SIT:show:landing"),!1)},resetPicks:function(c){var d=this,e=["series","year","routerPicks"];c&&b.isArray(c)?e=b.union(e,c):c&&(e=b.union(e,[c]));var f=b.omit(b.clone(g),e);d.set(f,{silent:!0}),a.API.setCurrentPicks(d.attributes)},resetAllPicks:function(c){var d=this,e=[],f=b.omit(b.clone(g),e);d.set(f,{silent:!0}),a.API.setCurrentPicks(d.attributes)},allPicks:function(){var a=this;return a.get("featurePicks").concat(a.get("colorPicks"))},setPriceMin:function(a){var b=this,c=b.get("priceMin");if(a=parseInt(a,10),c===a)return!1;a||0===a?a>=b.inventory.filters.get("minMsrp")&&a<=b.inventory.filters.get("maxMsrp")&&a<=b.get("priceMax")&&b.set("priceMin",a):b.set("priceMin",-1);var d=b.filterResultsByMsrp();return d&&0!==d.length?!0:(b.set("priceMin",c),!1)},setPriceMax:function(a){var b=this,c=b.get("priceMax");if(a=parseInt(a,10),c===a)return!1;a||0===a?a<=b.inventory.filters.get("maxMsrp")&&a>=b.inventory.filters.get("minMsrp")&&a>=b.get("priceMin")&&b.set("priceMax",a):b.set("priceMax",-1);var d=b.filterResultsByMsrp();return d&&0!==d.length?!0:(b.set("priceMax",c),!1)},filterResultsByMsrp:function(a){var b=this,d=b.get("priceMax"),e=b.get("priceMin"),f=b.get("featurePicks"),g=b.get("colorPicks");return a||(a=[],f.length&&(a=a.filter("."+f.join(",."))),g.length&&(a=a.filter("."+g.join(",.")))),d>=0&&e>=0&&(a=a.filter(function(){var a=c(this).data("msrp");return a&&d>=a&&a>=e?!0:!1})),a},updateGradeType:function(){var a=this,b=a.get("series");f="tacoma"===b?"cab":"corolla"===b||"sienna"===b?"grade-subgrade":"grade"},unsetNonSeriesPicks:function(){var a=this;b.each(["model","cab","bed","engine","drive","transmission","exteriorcolor","interiorcolor","accessory","price","page","sort"],function(b){a.unset(b)})}});return h}),define("app/models/grades",["sit"],function(a){var b=(a.RIT,a._),c=(a.$,a.Config,a.Backbone),d=a.Events,e=c.Model.extend({defaults:{grades:[]},initialize:function(a){var b=this;b.inventory=a.inventory},reset:function(){},load:function(){var c=this;d.trigger("SIT:grades:load");var e=a.API.getGrades();e=b.map(e,function(a){return"rav4ev"===a.code&&(a.series="RAV4 EV",a.title="FWD"),a}),c.set("grades",e),d.trigger("SIT:grades:success")}});return e}),define("app/models/filters",["sit"],function(a){var b=(a.RIT,a._),c=a.$,d=(a.Config,a.Backbone),e=a.Events,f=d.Model.extend({defaults:{filters:[]},initialize:function(a){var b=this;b.inventory=a.inventory,e.on("SIT:filters:changed",c.proxy(b.onFiltersChanged,b)),e.on("SIT:grade:picked",b.onGradePicked,b)},onGradePicked:function(d){debuggerOn&&console.log("onGradePicked:",d);var f=this;f.inventory.picks.resetPicks(),f.reset(),f.load(),f.inventory.picks.set("sort","asc"),c("#results-sort-vehicles").val("asc").trigger("liszt:updated").trigger("chosen:updated"),c.when(a.API.getFiltersDeferred(),a.API.getResultsDeferred(),a.API.getFacetCountsDeferred()).then(function(){b.defer(function(){e.trigger("inventory:loaded","results")})})},onFiltersChanged:function(){},
getActiveFilters:function(){var a={};return c("#filters .accordion-body").each(function(){var d=c("input:checked",this);a[c(this).data("type")]=b.map(d,function(a){return c(a).val().split("_")[1]}).join("")}),a},getFilterPath:function(){var a=[];return c("#filters .accordion-group").each(function(){var d=c("input:checked",this);a.push(b.map(d,function(a){return c(a).val().split("_")[1]}).join(""))}),a.join("/")},reset:function(){a.API.resetFilters()},load:function(){var b=this;e.trigger("SIT:filters:load"),c.when(a.API.getFilters()).then(function(a){b.onSuccess(a)})},onSuccess:function(a){var b=this;b.set("filters",a,{silent:!1}),e.trigger("SIT:filters:success")},onFail:function(){e.trigger("SIT:filters:fail")}});return f}),define("app/models/results",["sit"],function(a){var b=(a._,a.$,a.Backbone),c=a.Events,d=(a.RIT,b.Model.extend({defaults:{results:[],sort:"asc",page:1},initialize:function(a){var b=this;b.inventory=a.inventory},load:function(b){var d=this;c.trigger("SIT:results:load");var e=a.API.getResults();return e&&e.success===!0?d.onSuccess(e):d.onFail(e),e},onSuccess:function(a){var b=this;b.set("results",a.results),b.set("sort","asc"),c.trigger("SIT:results:success")},onFail:function(){c.trigger("SIT:results:fail")},setSort:function(a){}}));return d}),define("app/models/details",["sit"],function(a){var b=a._,c=a.$,d=a.Backbone,e=a.Events,f=(a.RIT,d.Model.extend({defaults:{details:{},picks:{},resultsUrl:""},initialize:function(a){var b=this;b.inventory=a.inventory},load:function(d){var f=this;return e.trigger("SIT:details:load"),b.isObject(d)&&d.year&&d.series?((f.inventory.picks.get("series")!==d.series||f.inventory.picks.get("year")!==d.year)&&(f.inventory.picks.resetPicks(),f.inventory.picks.set("year",d.year),f.inventory.picks.set("series",d.series),e.trigger("SIT:change:series")),f.set("picks",d),void c.when(f.inventory.sessionReady).then(function(){c.when(a.API.getDetails(d)).then(function(a){f.onSuccess(a,d)})})):(e.trigger("SIT:show:landing"),!1)},onSuccess:function(a,b){var c=this;c.set("details",a),e.trigger("SIT:details:success")},onFail:function(){e.trigger("SIT:details:fail")}}));return f}),define("app/models/inventory",["sit","app/promises","app/models/picks","app/models/grades","app/models/filters","app/models/results","app/models/details"],function(a,b,c,d,e,f,g){var h=(a.RIT,a._),i=a.$,j=(a.Config,a.Backbone),k=a.Events,l=!0,m=0,n=j.Model.extend({sessionReady:i.Deferred(),threedReady:i.Deferred(),defaults:{zipcode:"",region:"",dealers:null,currentView:""},initialize:function(){var b=this;b.set(b.defaults,{silent:!0}),b.picks=new c({inventory:b}),b.grades=new d({inventory:b}),b.filters=new e({inventory:b}),b.results=new f({inventory:b}),b.details=new g({inventory:b}),b.on("change:currentView",function(a){l="results"===a.changed.currentView}),b.once("change:region",function(){"pending"!==b.sessionReady.state()&&(b.sessionReady=i.Deferred()),b.picks.get("year")&&b.picks.get("series")&&b.get("region")&&h.isArray(b.get("dealers"))&&a.API.initializeSession(h.extend({},b.picks.attributes,{region:b.get("region"),dealers:b.get("dealers")}))}),b.on("change:dealers",function(){console.log("change dealers"),"pending"!==b.sessionReady.state()&&(b.sessionReady=i.Deferred()),b.picks.get("year")&&b.picks.get("series")&&b.get("region")&&h.isArray(b.get("dealers"))&&(debuggerOn&&console.log("dealers:",b.get("dealers")),a.API.initializeSession(h.extend({},b.picks.attributes,{region:b.get("region"),dealers:b.get("dealers")})))}),k.on("SIT:change:series",function(){"pending"!==b.sessionReady.state()&&(b.sessionReady=i.Deferred()),b.picks.get("year")&&b.picks.get("series")&&b.get("region")&&h.isArray(b.get("dealers"))&&a.API.initializeSession(h.extend({},b.picks.attributes,{region:b.get("region"),dealers:b.get("dealers")}))}),k.on("SIT:api:session:ready",function(){debuggerOn&&console.debug("new session ready"),b.picks.set("year",a.API.getCurrentYear().code),b.picks.set("series",a.API.getCurrentSeries().code),m>0&&"details"===b.get("currentView")&&j.history.loadUrl(j.history.fragment),b.set("disclaimers",a.API.getDisclaimers()),b.sessionReady.resolve(),b.grades.reset(),console.warn("_sessionCount:",m),m>0&&"results"===b.get("currentView")&&(a.API.setDefaultGrade(),b.picks.parsePicks(),a.API.removeRangeConstraint(),b.results.load(),a.API.triggerResults(),b.filters.reset(),b.filters.load(),k.trigger("SIT:pick:changed"),console.warn("doing it:",m),i.when(a.API.getResultsDeferred()).then(function(){h.defer(function(){k.trigger("inventory:loaded","results")})})),k.trigger("SIT:session:picks:ready"),l=!1,m++}),k.on("SIT:threed:session:ready",function(){b.threedReady.resolve()}),k.on("SIT:change:grade",function(){k.trigger("inventory:loading"),h.defer(function(){b.grades.load(),b.results.load(),b.picks.resetPicks([a.API.getGradeType()]),b.filters.reset(),b.filters.load()})}),k.on("SIT:change:picks",function(){b.filters.load(),b.grades.load()}),k.on("SIT:filter:changed",function(c){debuggerOn&&console.log("SIT:filter:changed:",c);var d;c.id&&(debuggerOn&&console.time("pick:time:"+c.id),k.trigger("inventory:loading"),d=a.API.getFeatureByID(c.id),c.isChecked?a.API.setPick(c.id):a.API.removePick(c.id),b.picks.unsetNonSeriesPicks(),h.each(a.API.getCurrentUserPicks(),function(a,c){/model|cab|bed|engine|drive|transmission|exteriorcolor|interiorcolor|accessory/.test(c)?b.picks.set(c,h.pluck(a,"code"),{silent:!0}):b.picks.set(c,h.first(a).code,{silent:!0})}),a.API.isAGrade(d)||(i.when(a.API.getFiltersDeferred()).then(function(){debuggerOn&&console.time("Update Facets"),k.trigger("SIT:update:filters"),debuggerOn&&console.timeEnd("Update Facets")}),b.whenResultsAndCountDeferred()),k.trigger("SIT:pick:changed"),debuggerOn&&console.timeEnd("pick:time:"+c.id))}),k.on("SIT:sort:changed",function(b){a.API.setSortOrder(b.sort),a.API.triggerResults()})},whenResultsAndCountDeferred:function(){i.when(a.API.getResultsDeferred()).then(function(){console.warn("results")}),i.when(a.API.getFacetCountsDeferred()).then(function(){console.warn("counts")}),i.when(a.API.getRangeDeferred()).then(function(){console.warn("range")}),i.when(a.API.getResultsDeferred(),a.API.getFacetCountsDeferred(),a.API.getRangeDeferred()).then(function(){h.defer(function(){console.warn("should be done"),k.trigger("inventory:loaded","results")})})}});return n}),require(["sit","app/api/api-wrapper","app/promises","app/router","sitAppView","app/models/inventory"],function(a,b,c,d,e,f){var g=a.$,h=a._,i=a.Backbone,j=a.Events;window.SIT=a;var k=(new Date).valueOf(),l=new b;a.API=l;var m=new f,n=new d({inventory:m}),o=new e({inventory:m,router:n});a.appView=o,j.on("SIT:region:ready",function(b){j.trigger("inventory:loading"),debuggerOn&&console.log("region:ready",b.regionCode);var d=b.success&&b.regionCode?b.regionCode+"0":"NATIONAL";g.when(c.dealers()).then(function(b){var c=b&&b.tdaCode||"N/A",e=b&&b.dealerCodes||[];a.tdaCode=c,m.set("region",d),m.set({dealers:e},{silent:!1})})}),j.on("SIT:dealers:ready",function(a){if(debuggerOn&&console.log("dealers:ready",a),a&&h.isArray(a.dealerCodes)){var b=m.get("dealers");h.isArray(b)&&(b=b.join("")),b!==a.dealerCodes.join("")}}),j.on("SIT:dealers:fail",function(){debuggerOn&&console.log("dealers:fail"),m.set("dealers",[]),c.dealers().resolve()}),j.on("router:navigate",function(a,b){b=b||{},n.navigate(a,b)}),window.TCOM?c.initialize({inventory:m}):g(document).on("TCOM:ready",function(){c.initialize({inventory:m})}),a.API.isEspanol()&&c.initialize({inventory:m}),isAPIReady===!0?i.history.start():j.on("SIT:api:ready",function(){i.history.start()}),j.on("SIT:api:session:ready",function(){"landing"!==m.get("currentView")&&o.results.updateSeriesHeaders();var a,b;debuggerOn&&(g("#debuggerBox").show(),a=(new Date).valueOf()-timetoInteract,b=(new Date).valueOf()-k,g("#debuggerBox").html(g("#debuggerBox").html()+"<br> Time to interact: "+a))}),window.tcom.pubsub.subscribe("tcom.geolocation.zipcode.change",function(a,b){j.trigger("zipcode:changed",b.zipcode)}),l.initAPI({apiWrapper:l,router:n,inventory:m,appView:o})}),define("js/main",function(){});